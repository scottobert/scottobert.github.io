<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Scott Obert</title><meta name=description content="Threat modeling for cloud applications requires a fundamental rethinking of traditional security assessment approaches because cloud-native architectures …"><link rel=canonical href=https://scottobert.com/posts/threat-modeling-cloud-applications/><meta property="og:title" content="Threat Modeling for Cloud Applications: A Comprehensive Approach to Security Design"><meta property="og:description" content="Threat modeling for cloud applications requires a fundamental rethinking of traditional security assessment approaches because cloud-native architectures …"><meta property="og:type" content="article"><meta property="og:url" content="https://scottobert.com/posts/threat-modeling-cloud-applications/"><meta property="og:site_name" content="Scott Obert"><meta name=twitter:card content="summary"><meta name=twitter:title content="Threat Modeling for Cloud Applications: A Comprehensive Approach to Security Design"><meta name=twitter:description content="Threat modeling for cloud applications requires a fundamental rethinking of traditional security assessment approaches because cloud-native architectures …"><link rel=stylesheet href=/css/style.css><script src=/js/npm-packages.js defer></script><script src=/js/search.js defer></script><script defer src=https://cloud.umami.is/script.js data-website-id=e2461896-021d-422a-b83f-624a8819309b></script></head><body><header class=site-header><div class=container><div class=header-content><div class=header-left><h1><a href=/>Scott Obert</a></h1><nav><a href=/posts/>Blog</a>
<a href=/album/>Photo Album</a>
<button type=button class=search-toggle id=search-toggle-btn aria-label="Open search" title=Search>
<svg viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61.0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
<span>Search</span></button></nav></div><div class=social-links><a href=https://www.linkedin.com/in/scott-obert-3a7338b/ target=_blank rel="noopener noreferrer" title="LinkedIn Profile"><svg viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
<span>LinkedIn</span>
</a><a href=https://github.com/scottobert target=_blank rel="noopener noreferrer" title="GitHub Profile"><svg viewBox="0 0 24 24"><path d="M12 0C5.37.0.0 5.37.0 12c0 5.3 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61-.546-1.385-1.335-1.755-1.335-1.755-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.605-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 21.795 24 17.295 24 12c0-6.63-5.37-12-12-12"/></svg>
<span>GitHub</span></a></div></div></div></header><div class=container><nav class=breadcrumbs aria-label="Breadcrumb navigation"><ol class=breadcrumb-list><li class=breadcrumb-item><a href=https://scottobert.com/ title=Home><svg class="breadcrumb-home-icon" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
<span>Home</span></a></li><li class=breadcrumb-item><span class=breadcrumb-separator aria-hidden=true>/</span>
<a href=https://scottobert.com/posts/ title=Posts>Posts</a></li><li class=breadcrumb-item><span class=breadcrumb-separator aria-hidden=true>/</span>
<a href=https://scottobert.com/series/security-in-cloud-native-applications/ title="Series: Security in Cloud-Native Applications"><svg class="breadcrumb-series-icon" viewBox="0 0 24 24"><path d="M9 4v1.38c-.83-.33-1.72-.5-2.61-.5-1.79.0-3.58.68-4.95 2.05l3.33 3.33h1.11v1.11c.86.86 1.98 1.31 3.11 1.31 1.13.0 2.25-.45 3.11-1.31V9.26h1.11l3.33-3.33c-1.37-1.37-3.16-2.05-4.95-2.05-.89.0-1.78.17-2.61.5V4H9z"/></svg>
<span>Security in Cloud-Native Applications</span></a></li><li class=breadcrumb-item><span class=breadcrumb-separator aria-hidden=true>/</span>
<a href=https://scottobert.com/categories/security title="Category: Security"><svg class="breadcrumb-category-icon" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
<span>Security</span></a></li><li class="breadcrumb-item breadcrumb-current"><span class=breadcrumb-separator aria-hidden=true>/</span>
<span class=breadcrumb-current-page aria-current=page>Threat Modeling for Cloud Applications: A Comprehensive Approach to Security Design</span></li></ol></nav><div class=content-layout><main class=main-content><article class=post><h1>Threat Modeling for Cloud Applications: A Comprehensive Approach to Security Design</h1><div class=post-meta><div class=post-meta-left><span>Oct 19, 2019</span>
<span>| Tags: ThreatModeling, Security, CloudNative, Architecture, RiskAssessment, SecurityDesign, STRIDE, PASTA, OCTAVE</span></div><div class=post-meta-right><div class=quick-social-share><button type=button class=quick-share-toggle id=quick-share-toggle title="Share this post">
<svg viewBox="0 0 24 24"><path d="M18 16.08c-.76.0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66.0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66.0-3 1.34-3 3s1.34 3 3 3c.79.0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65.0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"/></svg>
<span>Share</span></button><div class=quick-share-buttons id=quick-share-buttons><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F&text=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design" target=_blank rel="noopener noreferrer" class="quick-share-button twitter" title="Share on Twitter"><svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
</a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F" target=_blank rel="noopener noreferrer" class="quick-share-button linkedin" title="Share on LinkedIn"><svg viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
</a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F" target=_blank rel="noopener noreferrer" class="quick-share-button facebook" title="Share on Facebook"><svg viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312.0 2.686.235 2.686.235v2.953H15.83c-1.491.0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
</a><a href="https://reddit.com/submit?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F&title=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design" target=_blank rel="noopener noreferrer" class="quick-share-button reddit" title="Share on Reddit"><svg viewBox="0 0 24 24"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg>
</a><a href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F&t=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design" target=_blank rel="noopener noreferrer" class="quick-share-button hackernews" title="Share on Hacker News"><svg viewBox="0 0 24 24"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
</a><a href="https://wa.me/?text=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design+https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F" target=_blank rel="noopener noreferrer" class="quick-share-button whatsapp" title="Share on WhatsApp"><svg viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893A11.821 11.821.0 0020.465 3.488"/></svg>
</a><a href="mailto:?subject=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design&body=Check+out+this+article%3A+Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design+-+https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F" class="quick-share-button email" title="Share via Email"><svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1.0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"/></svg>
</a><button type=button class="quick-share-button copy-link" data-url=https://scottobert.com/posts/threat-modeling-cloud-applications/ title="Copy link to clipboard">
<svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1.0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1.0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1.0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg></button></div></div><script>(function(){const i=document.querySelector(".quick-social-share"),e=document.getElementById("quick-share-toggle"),t=document.getElementById("quick-share-buttons");if(!i||!e||!t)return;let n=!1;e.addEventListener("click",function(){n=!n,n?(t.classList.add("visible"),e.classList.add("active")):(t.classList.remove("visible"),e.classList.remove("active"))});const a=document.querySelectorAll(".quick-share-button.copy-link");a.forEach(e=>{e.addEventListener("click",function(){const e=this.getAttribute("data-url");navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(e).then(()=>{o(this)}).catch(()=>{s(e,this)}):s(e,this)})});function s(e,t){const n=document.createElement("textarea");n.value=e,n.style.position="fixed",n.style.left="-999999px",n.style.top="-999999px",document.body.appendChild(n),n.focus(),n.select();try{document.execCommand("copy"),o(t)}catch(e){console.error("Fallback: Unable to copy",e),r(t)}document.body.removeChild(n)}function o(e){const n=e.getAttribute("title");e.setAttribute("title","Copied!"),e.classList.add("copied");const t=document.createElement("div");t.textContent="Copied!",t.style.position="absolute",t.style.bottom="100%",t.style.left="50%",t.style.transform="translateX(-50%)",t.style.background="#28a745",t.style.color="white",t.style.padding="4px 8px",t.style.borderRadius="4px",t.style.fontSize="0.75rem",t.style.whiteSpace="nowrap",t.style.zIndex="1000",t.style.marginBottom="5px",e.style.position="relative",e.appendChild(t),setTimeout(()=>{e.setAttribute("title",n),e.classList.remove("copied"),t.parentNode&&e.removeChild(t)},2e3)}function r(e){const t=e.getAttribute("title");e.setAttribute("title","Copy failed"),e.classList.add("error"),setTimeout(()=>{e.setAttribute("title",t),e.classList.remove("error")},2e3)}})()</script></div></div><div class=post-content><p>Threat modeling for cloud applications requires a fundamental rethinking of traditional security assessment approaches because cloud-native architectures introduce unique attack vectors, shared responsibility models, and dynamic infrastructure patterns that weren&rsquo;t present in legacy systems. The distributed nature of cloud applications, combined with their rapid deployment cycles and ephemeral infrastructure components, creates a complex threat landscape that must be analyzed systematically to identify potential security vulnerabilities before they can be exploited by malicious actors.</p><p>The traditional approach to threat modeling, often conducted as a one-time exercise during the design phase, is insufficient for cloud-native applications that evolve continuously through automated deployment pipelines. Modern threat modeling must be integrated into the development lifecycle as a continuous process that can adapt to changing application architectures, new feature deployments, and evolving threat landscapes. This integration requires automated tooling and processes that can scale with development velocity while maintaining the rigor necessary for effective security analysis.</p><p>Cloud applications operate in shared infrastructure environments where the security boundaries between different tenants, services, and data classifications are defined by configuration rather than physical separation. This abstraction creates opportunities for misconfiguration-based vulnerabilities that can expose sensitive data or provide unauthorized access to system resources. Effective threat modeling for cloud applications must account for these configuration-dependent security boundaries and the potential for human error in their implementation and maintenance.</p><h2 id=comprehensive-threat-modeling-methodologies>Comprehensive Threat Modeling Methodologies</h2><p>The selection and application of threat modeling methodologies for cloud applications requires careful consideration of the unique characteristics of distributed systems, microservices architectures, and cloud service dependencies. Traditional methodologies like STRIDE (Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, Elevation of Privilege) provide a solid foundation but must be adapted to address cloud-specific concerns such as multi-tenancy, API security, and infrastructure-as-code vulnerabilities.</p><p>Modern threat modeling approaches incorporate multiple methodologies to provide comprehensive coverage of different threat perspectives. Process-focused methodologies like PASTA (Process for Attack Simulation and Threat Analysis) help identify business-context threats, while asset-focused approaches like OCTAVE (Operationally Critical Threat, Asset, and Vulnerability Evaluation) ensure that high-value data and systems receive appropriate protection. The integration of these methodologies provides a holistic view of the threat landscape that accounts for both technical and business risks.</p><p>The complexity of cloud-native architectures requires threat modeling approaches that can handle the interdependencies between multiple services, data flows, and trust boundaries. Traditional approaches that focus on individual applications or systems are insufficient for analyzing the security implications of service meshes, API gateways, and event-driven architectures. Modern threat modeling must adopt a systems-thinking approach that considers the emergent security properties of complex distributed systems.</p><p>Here&rsquo;s a comprehensive implementation of automated threat modeling for cloud applications:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// cloud-threat-modeling-engine.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CloudFormationClient</span>, <span style=color:#a6e22e>DescribeStackResourcesCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-cloudformation&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>EC2Client</span>, <span style=color:#a6e22e>DescribeVpcsCommand</span>, <span style=color:#a6e22e>DescribeSubnetsCommand</span>, <span style=color:#a6e22e>DescribeSecurityGroupsCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-ec2&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>LambdaClient</span>, <span style=color:#a6e22e>ListFunctionsCommand</span>, <span style=color:#a6e22e>GetFunctionCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-lambda&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>APIGatewayClient</span>, <span style=color:#a6e22e>GetRestApisCommand</span>, <span style=color:#a6e22e>GetResourcesCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-api-gateway&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>RDSClient</span>, <span style=color:#a6e22e>DescribeDBInstancesCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-rds&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ThreatModel</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>modelId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>applicationName</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>version</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createdDate</span>: <span style=color:#66d9ef>Date</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lastUpdated</span>: <span style=color:#66d9ef>Date</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>ThreatModelScope</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>architecture</span>: <span style=color:#66d9ef>SystemArchitecture</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dataFlows</span>: <span style=color:#66d9ef>DataFlow</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>trustBoundaries</span>: <span style=color:#66d9ef>TrustBoundary</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>assets</span>: <span style=color:#66d9ef>Asset</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>threats</span>: <span style=color:#66d9ef>IdentifiedThreat</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mitigations</span>: <span style=color:#66d9ef>Mitigation</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>riskAssessment</span>: <span style=color:#66d9ef>RiskAssessment</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SystemArchitecture</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>components</span>: <span style=color:#66d9ef>ArchitectureComponent</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>connections</span>: <span style=color:#66d9ef>ComponentConnection</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>externalDependencies</span>: <span style=color:#66d9ef>ExternalDependency</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>deploymentModel</span>: <span style=color:#66d9ef>DeploymentModel</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ArchitectureComponent</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>componentId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ComponentType</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>technologies</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>securityProperties</span>: <span style=color:#66d9ef>SecurityProperties</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>trustLevel</span>: <span style=color:#66d9ef>TrustLevel</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>exposureLevel</span>: <span style=color:#66d9ef>ExposureLevel</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dataHandling</span>: <span style=color:#66d9ef>DataHandlingProperties</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>DataFlow</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>flowId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>source</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>destination</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dataClassification</span>: <span style=color:#66d9ef>DataClassification</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>protocol</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>authentication</span>: <span style=color:#66d9ef>AuthenticationMethod</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>encryption</span>: <span style=color:#66d9ef>EncryptionProperties</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>volume</span>: <span style=color:#66d9ef>DataVolume</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>criticality</span>: <span style=color:#66d9ef>Criticality</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>IdentifiedThreat</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>threatId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>title</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>category</span>: <span style=color:#66d9ef>ThreatCategory</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>strideClassification</span>: <span style=color:#66d9ef>STRIDECategory</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>attackVectors</span>: <span style=color:#66d9ef>AttackVector</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>impactAssessment</span>: <span style=color:#66d9ef>ImpactAssessment</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>likelihood</span>: <span style=color:#66d9ef>Likelihood</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>riskRating</span>: <span style=color:#66d9ef>RiskRating</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>affectedComponents</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>affectedDataFlows</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Mitigation</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mitigationId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>threatId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>title</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mitigationType</span>: <span style=color:#66d9ef>MitigationType</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>implementation</span>: <span style=color:#66d9ef>MitigationImplementation</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>effectiveness</span>: <span style=color:#66d9ef>Effectiveness</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cost</span>: <span style=color:#66d9ef>ImplementationCost</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>timeToImplement</span>: <span style=color:#66d9ef>number</span>; <span style=color:#75715e>// days
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>status</span>: <span style=color:#66d9ef>MitigationStatus</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>ComponentType</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>WEB_APPLICATION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;WEB_APPLICATION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>API_GATEWAY</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;API_GATEWAY&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MICROSERVICE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MICROSERVICE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>DATABASE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;DATABASE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MESSAGE_QUEUE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MESSAGE_QUEUE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>STORAGE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;STORAGE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LOAD_BALANCER</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LOAD_BALANCER&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CDN</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CDN&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>IDENTITY_PROVIDER</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;IDENTITY_PROVIDER&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MONITORING_SERVICE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MONITORING_SERVICE&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>ThreatCategory</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>SPOOFING</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;SPOOFING&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>TAMPERING</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;TAMPERING&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>REPUDIATION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;REPUDIATION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>INFORMATION_DISCLOSURE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;INFORMATION_DISCLOSURE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>DENIAL_OF_SERVICE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;DENIAL_OF_SERVICE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ELEVATION_OF_PRIVILEGE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ELEVATION_OF_PRIVILEGE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MISCONFIGURATION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MISCONFIGURATION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>SUPPLY_CHAIN</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;SUPPLY_CHAIN&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>INSIDER_THREAT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;INSIDER_THREAT&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>STRIDECategory</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>SPOOFING</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;SPOOFING&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>TAMPERING</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;TAMPERING&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>REPUDIATION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;REPUDIATION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>INFORMATION_DISCLOSURE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;INFORMATION_DISCLOSURE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>DENIAL_OF_SERVICE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;DENIAL_OF_SERVICE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ELEVATION_OF_PRIVILEGE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ELEVATION_OF_PRIVILEGE&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CloudThreatModelingEngine</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>cloudFormationClient</span>: <span style=color:#66d9ef>CloudFormationClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>ec2Client</span>: <span style=color:#66d9ef>EC2Client</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>lambdaClient</span>: <span style=color:#66d9ef>LambdaClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>apiGatewayClient</span>: <span style=color:#66d9ef>APIGatewayClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>rdsClient</span>: <span style=color:#66d9ef>RDSClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>threatDatabase</span>: <span style=color:#66d9ef>ThreatKnowledgeBase</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cloudFormationClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CloudFormationClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>ec2Client</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>EC2Client</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lambdaClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>LambdaClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>apiGatewayClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>APIGatewayClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rdsClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>RDSClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>threatDatabase</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ThreatKnowledgeBase</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>generateThreatModel</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>applicationName</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>stackName</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>ThreatModelScope</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>ThreatModel</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>modelId</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateModelId</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Discover and analyze application architecture
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>architecture</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>discoverArchitecture</span>(<span style=color:#a6e22e>stackName</span>, <span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Identify data flows
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>dataFlows</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>identifyDataFlows</span>(<span style=color:#a6e22e>architecture</span>, <span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Define trust boundaries
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>trustBoundaries</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>defineTrustBoundaries</span>(<span style=color:#a6e22e>architecture</span>, <span style=color:#a6e22e>dataFlows</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Identify assets
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>assets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>identifyAssets</span>(<span style=color:#a6e22e>architecture</span>, <span style=color:#a6e22e>dataFlows</span>, <span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Generate threat scenarios
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>threats</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateThreatScenarios</span>(<span style=color:#a6e22e>architecture</span>, <span style=color:#a6e22e>dataFlows</span>, <span style=color:#a6e22e>assets</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Recommend mitigations
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mitigations</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>recommendMitigations</span>(<span style=color:#a6e22e>threats</span>, <span style=color:#a6e22e>architecture</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Assess overall risk
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>riskAssessment</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>performRiskAssessment</span>(<span style=color:#a6e22e>threats</span>, <span style=color:#a6e22e>mitigations</span>, <span style=color:#a6e22e>assets</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>threatModel</span>: <span style=color:#66d9ef>ThreatModel</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>modelId</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>applicationName</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>version</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;1.0&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>createdDate</span>: <span style=color:#66d9ef>new</span> Date(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>lastUpdated</span>: <span style=color:#66d9ef>new</span> Date(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>scope</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>architecture</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>dataFlows</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>trustBoundaries</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>assets</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>threats</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>mitigations</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>riskAssessment</span>
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Store threat model
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>storeThreatModel</span>(<span style=color:#a6e22e>threatModel</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Generate reports
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateThreatModelReports</span>(<span style=color:#a6e22e>threatModel</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>threatModel</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>`Failed to generate threat model for </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>applicationName</span><span style=color:#e6db74>}</span><span style=color:#e6db74>:`</span>, <span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>discoverArchitecture</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>stackName</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>ThreatModelScope</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>SystemArchitecture</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>components</span>: <span style=color:#66d9ef>ArchitectureComponent</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>connections</span>: <span style=color:#66d9ef>ComponentConnection</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>externalDependencies</span>: <span style=color:#66d9ef>ExternalDependency</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Discover CloudFormation resources
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>stackResources</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getStackResources</span>(<span style=color:#a6e22e>stackName</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>resource</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>stackResources</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>component</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeResource</span>(<span style=color:#a6e22e>resource</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>component</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>components</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>component</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Discover connections between components
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>discoveredConnections</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>discoverConnections</span>(<span style=color:#a6e22e>components</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>connections</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>discoveredConnections</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Identify external dependencies
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>discoveredDependencies</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>identifyExternalDependencies</span>(<span style=color:#a6e22e>components</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>externalDependencies</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>discoveredDependencies</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>components</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>connections</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>externalDependencies</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>deploymentModel</span>: <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeDeploymentModel</span>(<span style=color:#a6e22e>stackName</span>)
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>analyzeResource</span>(<span style=color:#a6e22e>resource</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>ArchitectureComponent</span> <span style=color:#960050;background-color:#1e0010>|</span> <span style=color:#a6e22e>null</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> (<span style=color:#a6e22e>resource</span>.<span style=color:#a6e22e>ResourceType</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;AWS::Lambda::Function&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeLambdaFunction</span>(<span style=color:#a6e22e>resource</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;AWS::RDS::DBInstance&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeRDSInstance</span>(<span style=color:#a6e22e>resource</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;AWS::ApiGateway::RestApi&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeApiGateway</span>(<span style=color:#a6e22e>resource</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;AWS::S3::Bucket&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeS3Bucket</span>(<span style=color:#a6e22e>resource</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;AWS::EC2::SecurityGroup&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeSecurityGroup</span>(<span style=color:#a6e22e>resource</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>analyzeLambdaFunction</span>(<span style=color:#a6e22e>resource</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>ArchitectureComponent</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>functionDetails</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lambdaClient</span>.<span style=color:#a6e22e>send</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GetFunctionCommand</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>FunctionName</span>: <span style=color:#66d9ef>resource.PhysicalResourceId</span>
</span></span><span style=display:flex><span>    }));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>componentId</span>: <span style=color:#66d9ef>resource.PhysicalResourceId</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>functionDetails.Configuration?.FunctionName</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;Unknown Lambda&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ComponentType</span>.<span style=color:#a6e22e>MICROSERVICE</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>functionDetails.Configuration?.Description</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;Lambda function&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>technologies</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;AWS Lambda&#39;</span>, <span style=color:#a6e22e>functionDetails</span>.<span style=color:#a6e22e>Configuration</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>Runtime</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;unknown&#39;</span>],
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>securityProperties</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>authentication</span>: <span style=color:#66d9ef>this.analyzeLambdaAuthentication</span>(<span style=color:#a6e22e>functionDetails</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>authorization</span>: <span style=color:#66d9ef>this.analyzeLambdaAuthorization</span>(<span style=color:#a6e22e>functionDetails</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>encryption</span>: <span style=color:#66d9ef>this.analyzeLambdaEncryption</span>(<span style=color:#a6e22e>functionDetails</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>logging</span>: <span style=color:#66d9ef>this.analyzeLambdaLogging</span>(<span style=color:#a6e22e>functionDetails</span>)
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>trustLevel</span>: <span style=color:#66d9ef>this.determineTrustLevel</span>(<span style=color:#a6e22e>functionDetails</span>),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>exposureLevel</span>: <span style=color:#66d9ef>this.determineExposureLevel</span>(<span style=color:#a6e22e>functionDetails</span>),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>dataHandling</span>: <span style=color:#66d9ef>this.analyzeLambdaDataHandling</span>(<span style=color:#a6e22e>functionDetails</span>)
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>generateThreatScenarios</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>architecture</span>: <span style=color:#66d9ef>SystemArchitecture</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dataFlows</span>: <span style=color:#66d9ef>DataFlow</span>[],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>assets</span>: <span style=color:#66d9ef>Asset</span>[]
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>IdentifiedThreat</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>threats</span>: <span style=color:#66d9ef>IdentifiedThreat</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Generate STRIDE-based threats for each component
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>component</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>architecture</span>.<span style=color:#a6e22e>components</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>componentThreats</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateComponentThreats</span>(<span style=color:#a6e22e>component</span>, <span style=color:#a6e22e>architecture</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>threats</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>componentThreats</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Generate data flow threats
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>dataFlow</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>dataFlows</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>dataFlowThreats</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateDataFlowThreats</span>(<span style=color:#a6e22e>dataFlow</span>, <span style=color:#a6e22e>architecture</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>threats</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>dataFlowThreats</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Generate cross-component threats
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>systemThreats</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateSystemLevelThreats</span>(<span style=color:#a6e22e>architecture</span>, <span style=color:#a6e22e>dataFlows</span>, <span style=color:#a6e22e>assets</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>threats</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>systemThreats</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Analyze cloud-specific threats
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>cloudThreats</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateCloudSpecificThreats</span>(<span style=color:#a6e22e>architecture</span>, <span style=color:#a6e22e>dataFlows</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>threats</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>cloudThreats</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>threats</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>generateComponentThreats</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>ArchitectureComponent</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>architecture</span>: <span style=color:#66d9ef>SystemArchitecture</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>IdentifiedThreat</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>threats</span>: <span style=color:#66d9ef>IdentifiedThreat</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Apply STRIDE analysis based on component type
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>switch</span> (<span style=color:#a6e22e>component</span>.<span style=color:#66d9ef>type</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>ComponentType.MICROSERVICE</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>threats.push</span>(...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateMicroserviceThreats</span>(<span style=color:#a6e22e>component</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>ComponentType.DATABASE</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>threats.push</span>(...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateDatabaseThreats</span>(<span style=color:#a6e22e>component</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>ComponentType.API_GATEWAY</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>threats.push</span>(...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateApiGatewayThreats</span>(<span style=color:#a6e22e>component</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>ComponentType.STORAGE</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>threats.push</span>(...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateStorageThreats</span>(<span style=color:#a6e22e>component</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>threats</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>generateMicroserviceThreats</span>(<span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>ArchitectureComponent</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>IdentifiedThreat</span>[] {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>threats</span>: <span style=color:#66d9ef>IdentifiedThreat</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Spoofing threats
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>component</span>.<span style=color:#a6e22e>securityProperties</span>.<span style=color:#a6e22e>authentication</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>enabled</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>threats</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>threatId</span>: <span style=color:#66d9ef>this.generateThreatId</span>(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Service Identity Spoofing&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Attacker could impersonate the microservice by spoofing its identity&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>category</span>: <span style=color:#66d9ef>ThreatCategory.SPOOFING</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>strideClassification</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>STRIDECategory</span>.<span style=color:#a6e22e>SPOOFING</span>],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>attackVectors</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>vectorId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AV001&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Network-based identity spoofing&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>difficulty</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>prerequisites</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;Network access to service&#39;</span>],
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>techniques</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;IP spoofing&#39;</span>, <span style=color:#e6db74>&#39;DNS poisoning&#39;</span>]
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>impactAssessment</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>confidentialityImpact</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>integrityImpact</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>availabilityImpact</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>businessImpact</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>likelihood</span>: <span style=color:#66d9ef>Likelihood.MEDIUM</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>riskRating</span>: <span style=color:#66d9ef>RiskRating.HIGH</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>affectedComponents</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>component</span>.<span style=color:#a6e22e>componentId</span>],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>affectedDataFlows</span><span style=color:#f92672>:</span> []
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Tampering threats
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>component</span>.<span style=color:#a6e22e>securityProperties</span>.<span style=color:#a6e22e>encryption</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>inTransit</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>threats</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>threatId</span>: <span style=color:#66d9ef>this.generateThreatId</span>(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Data Tampering in Transit&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Attacker could modify data in transit to/from the microservice&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>category</span>: <span style=color:#66d9ef>ThreatCategory.TAMPERING</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>strideClassification</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>STRIDECategory</span>.<span style=color:#a6e22e>TAMPERING</span>],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>attackVectors</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>vectorId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AV002&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Man-in-the-middle attack&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>difficulty</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>prerequisites</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;Network access&#39;</span>, <span style=color:#e6db74>&#39;Unencrypted communication&#39;</span>],
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>techniques</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;Packet interception&#39;</span>, <span style=color:#e6db74>&#39;SSL stripping&#39;</span>]
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>impactAssessment</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>confidentialityImpact</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>integrityImpact</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>availabilityImpact</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;LOW&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>businessImpact</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>likelihood</span>: <span style=color:#66d9ef>Likelihood.MEDIUM</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>riskRating</span>: <span style=color:#66d9ef>RiskRating.HIGH</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>affectedComponents</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>component</span>.<span style=color:#a6e22e>componentId</span>],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>affectedDataFlows</span><span style=color:#f92672>:</span> []
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Elevation of privilege threats
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>component</span>.<span style=color:#a6e22e>securityProperties</span>.<span style=color:#a6e22e>authorization</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>model</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;NONE&#39;</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>threats</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>threatId</span>: <span style=color:#66d9ef>this.generateThreatId</span>(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Privilege Escalation&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Attacker could gain elevated privileges within the microservice&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>category</span>: <span style=color:#66d9ef>ThreatCategory.ELEVATION_OF_PRIVILEGE</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>strideClassification</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>STRIDECategory</span>.<span style=color:#a6e22e>ELEVATION_OF_PRIVILEGE</span>],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>attackVectors</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>vectorId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AV003&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Exploit application vulnerabilities&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>difficulty</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>prerequisites</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;Application access&#39;</span>, <span style=color:#e6db74>&#39;Vulnerable code&#39;</span>],
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>techniques</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;Buffer overflow&#39;</span>, <span style=color:#e6db74>&#39;Injection attacks&#39;</span>]
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>impactAssessment</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>confidentialityImpact</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>integrityImpact</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>availabilityImpact</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>businessImpact</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;CRITICAL&#39;</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>likelihood</span>: <span style=color:#66d9ef>Likelihood.LOW</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>riskRating</span>: <span style=color:#66d9ef>RiskRating.MEDIUM</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>affectedComponents</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>component</span>.<span style=color:#a6e22e>componentId</span>],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>affectedDataFlows</span><span style=color:#f92672>:</span> []
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>threats</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>recommendMitigations</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>threats</span>: <span style=color:#66d9ef>IdentifiedThreat</span>[],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>architecture</span>: <span style=color:#66d9ef>SystemArchitecture</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>Mitigation</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mitigations</span>: <span style=color:#66d9ef>Mitigation</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>threat</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>threats</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>threatMitigations</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateMitigationsForThreat</span>(<span style=color:#a6e22e>threat</span>, <span style=color:#a6e22e>architecture</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>mitigations</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>threatMitigations</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Prioritize mitigations based on risk reduction and implementation cost
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>prioritizeMitigations</span>(<span style=color:#a6e22e>mitigations</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>generateMitigationsForThreat</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>threat</span>: <span style=color:#66d9ef>IdentifiedThreat</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>architecture</span>: <span style=color:#66d9ef>SystemArchitecture</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>Mitigation</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mitigations</span>: <span style=color:#66d9ef>Mitigation</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> (<span style=color:#a6e22e>threat</span>.<span style=color:#a6e22e>category</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>ThreatCategory.SPOOFING</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>mitigations.push</span>(...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateSpoofingMitigations</span>(<span style=color:#a6e22e>threat</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>ThreatCategory.TAMPERING</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>mitigations.push</span>(...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateTamperingMitigations</span>(<span style=color:#a6e22e>threat</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>ThreatCategory.INFORMATION_DISCLOSURE</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>mitigations.push</span>(...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateInformationDisclosureMitigations</span>(<span style=color:#a6e22e>threat</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>ThreatCategory.DENIAL_OF_SERVICE</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>mitigations.push</span>(...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateDoSMitigations</span>(<span style=color:#a6e22e>threat</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>ThreatCategory.ELEVATION_OF_PRIVILEGE</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>mitigations.push</span>(...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generatePrivilegeEscalationMitigations</span>(<span style=color:#a6e22e>threat</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>mitigations</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>generateSpoofingMitigations</span>(<span style=color:#a6e22e>threat</span>: <span style=color:#66d9ef>IdentifiedThreat</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Mitigation</span>[] {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>mitigationId</span>: <span style=color:#66d9ef>this.generateMitigationId</span>(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>threatId</span>: <span style=color:#66d9ef>threat.threatId</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Implement Mutual TLS Authentication&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Deploy mutual TLS to verify the identity of both client and server&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>mitigationType</span>: <span style=color:#66d9ef>MitigationType.PREVENTIVE</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>implementation</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;CONFIGURATION_CHANGE&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Configure API Gateway and services to require client certificates&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>automationLevel</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;PARTIALLY_AUTOMATED&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>requiredResources</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;Certificate Authority&#39;</span>, <span style=color:#e6db74>&#39;Configuration Management&#39;</span>]
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>effectiveness</span>: <span style=color:#66d9ef>Effectiveness.HIGH</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>cost</span>: <span style=color:#66d9ef>ImplementationCost.MEDIUM</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>timeToImplement</span>: <span style=color:#66d9ef>14</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>status</span>: <span style=color:#66d9ef>MitigationStatus.RECOMMENDED</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>mitigationId</span>: <span style=color:#66d9ef>this.generateMitigationId</span>(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>threatId</span>: <span style=color:#66d9ef>threat.threatId</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Deploy Service Mesh with Identity Verification&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Implement service mesh (e.g., Istio) with automatic service identity verification&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>mitigationType</span>: <span style=color:#66d9ef>MitigationType.PREVENTIVE</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>implementation</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;INFRASTRUCTURE_CHANGE&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Deploy and configure service mesh with automatic mTLS&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>automationLevel</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;FULLY_AUTOMATED&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>requiredResources</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;Service Mesh Platform&#39;</span>, <span style=color:#e6db74>&#39;Identity Management&#39;</span>]
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>effectiveness</span>: <span style=color:#66d9ef>Effectiveness.HIGH</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>cost</span>: <span style=color:#66d9ef>ImplementationCost.HIGH</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>timeToImplement</span>: <span style=color:#66d9ef>30</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>status</span>: <span style=color:#66d9ef>MitigationStatus.RECOMMENDED</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>performRiskAssessment</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>threats</span>: <span style=color:#66d9ef>IdentifiedThreat</span>[],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mitigations</span>: <span style=color:#66d9ef>Mitigation</span>[],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>assets</span>: <span style=color:#66d9ef>Asset</span>[]
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>RiskAssessment</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>riskMetrics</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateRiskMetrics</span>(<span style=color:#a6e22e>threats</span>, <span style=color:#a6e22e>mitigations</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>residualRisk</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateResidualRisk</span>(<span style=color:#a6e22e>threats</span>, <span style=color:#a6e22e>mitigations</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>prioritizedThreats</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>prioritizeThreats</span>(<span style=color:#a6e22e>threats</span>, <span style=color:#a6e22e>assets</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>overallRiskScore</span>: <span style=color:#66d9ef>riskMetrics.overallScore</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>riskDistribution</span>: <span style=color:#66d9ef>riskMetrics.distribution</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>residualRisk</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>prioritizedThreats</span>: <span style=color:#66d9ef>prioritizedThreats.slice</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>10</span>), <span style=color:#75715e>// Top 10 threats
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>mitigationCoverage</span>: <span style=color:#66d9ef>this.calculateMitigationCoverage</span>(<span style=color:#a6e22e>threats</span>, <span style=color:#a6e22e>mitigations</span>),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>recommendations</span>: <span style=color:#66d9ef>this.generateRiskRecommendations</span>(<span style=color:#a6e22e>threats</span>, <span style=color:#a6e22e>mitigations</span>, <span style=color:#a6e22e>assets</span>)
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Helper methods and utilities
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>generateModelId</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>`TM-</span><span style=color:#e6db74>${</span>Date.<span style=color:#a6e22e>now</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span>Math.<span style=color:#a6e22e>random</span>().<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>36</span>).<span style=color:#a6e22e>substr</span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>9</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>generateThreatId</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>`THR-</span><span style=color:#e6db74>${</span>Date.<span style=color:#a6e22e>now</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span>Math.<span style=color:#a6e22e>random</span>().<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>36</span>).<span style=color:#a6e22e>substr</span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>9</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>generateMitigationId</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>`MIT-</span><span style=color:#e6db74>${</span>Date.<span style=color:#a6e22e>now</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span>Math.<span style=color:#a6e22e>random</span>().<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>36</span>).<span style=color:#a6e22e>substr</span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>9</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>getStackResources</span>(<span style=color:#a6e22e>stackName</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>any</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>command</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>DescribeStackResourcesCommand</span>({ <span style=color:#a6e22e>StackName</span>: <span style=color:#66d9ef>stackName</span> });
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cloudFormationClient</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>command</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>StackResources</span> <span style=color:#f92672>||</span> [];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Additional helper methods would be implemented here...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeLambdaAuthentication</span>(<span style=color:#a6e22e>functionDetails</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>any</span> { <span style=color:#66d9ef>return</span> {}; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeLambdaAuthorization</span>(<span style=color:#a6e22e>functionDetails</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>any</span> { <span style=color:#66d9ef>return</span> {}; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeLambdaEncryption</span>(<span style=color:#a6e22e>functionDetails</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>any</span> { <span style=color:#66d9ef>return</span> {}; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeLambdaLogging</span>(<span style=color:#a6e22e>functionDetails</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>any</span> { <span style=color:#66d9ef>return</span> {}; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>determineTrustLevel</span>(<span style=color:#a6e22e>functionDetails</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>TrustLevel</span> { <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>TrustLevel</span>.<span style=color:#a6e22e>MEDIUM</span>; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>determineExposureLevel</span>(<span style=color:#a6e22e>functionDetails</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>ExposureLevel</span> { <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ExposureLevel</span>.<span style=color:#a6e22e>INTERNAL</span>; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeLambdaDataHandling</span>(<span style=color:#a6e22e>functionDetails</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>DataHandlingProperties</span> { <span style=color:#66d9ef>return</span> {} <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>DataHandlingProperties</span>; }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Supporting classes and types
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ThreatKnowledgeBase</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>getThreatsByCategory</span>(<span style=color:#a6e22e>category</span>: <span style=color:#66d9ef>ThreatCategory</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>IdentifiedThreat</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Implementation would query threat intelligence database
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> [];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>getAttackPatterns</span>(<span style=color:#a6e22e>componentType</span>: <span style=color:#66d9ef>ComponentType</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>AttackVector</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Implementation would return known attack patterns for component type
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> [];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Enums and interfaces
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>Likelihood</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>VERY_LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;VERY_LOW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LOW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MEDIUM</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>VERY_HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;VERY_HIGH&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>RiskRating</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>VERY_LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;VERY_LOW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LOW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MEDIUM</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CRITICAL</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CRITICAL&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>MitigationType</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PREVENTIVE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;PREVENTIVE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>DETECTIVE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;DETECTIVE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CORRECTIVE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CORRECTIVE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>COMPENSATING</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;COMPENSATING&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>Effectiveness</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LOW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MEDIUM</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>VERY_HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;VERY_HIGH&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>ImplementationCost</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LOW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MEDIUM</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>VERY_HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;VERY_HIGH&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>MitigationStatus</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>RECOMMENDED</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;RECOMMENDED&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PLANNED</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;PLANNED&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>IN_PROGRESS</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;IN_PROGRESS&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>IMPLEMENTED</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;IMPLEMENTED&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>REJECTED</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;REJECTED&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>TrustLevel</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>UNTRUSTED</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;UNTRUSTED&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LOW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MEDIUM</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CRITICAL</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CRITICAL&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>ExposureLevel</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>INTERNAL</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;INTERNAL&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PARTNER</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;PARTNER&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PUBLIC</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;PUBLIC&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>INTERNET</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;INTERNET&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Additional supporting interfaces
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ThreatModelScope</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>applicationComponents</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dataClassifications</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>trustBoundaries</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>threatActors</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>complianceRequirements</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SecurityProperties</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>authentication?</span>: <span style=color:#66d9ef>AuthenticationProperties</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>authorization?</span>: <span style=color:#66d9ef>AuthorizationProperties</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>encryption?</span>: <span style=color:#66d9ef>EncryptionProperties</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>logging?</span>: <span style=color:#66d9ef>LoggingProperties</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AuthenticationProperties</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>enabled</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>method</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>strength</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AuthorizationProperties</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>model</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>granularity</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>enforcement</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>EncryptionProperties</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>atRest</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>inTransit</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>keyManagement</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>LoggingProperties</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>enabled</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>level</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>retention</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>DataHandlingProperties</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dataTypes</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>classification</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>retention</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geography</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ComponentConnection</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>connectionId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>source</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>destination</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>protocol</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>authentication</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>encryption</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ExternalDependency</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dependencyId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>trustLevel</span>: <span style=color:#66d9ef>TrustLevel</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dataExchange</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>DeploymentModel</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pattern</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>environment</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>scalability</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>availability</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>TrustBoundary</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>boundaryId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>components</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>securityLevel</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Asset</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>assetId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>classification</span>: <span style=color:#66d9ef>DataClassification</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>businessValue</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>components</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>DataClassification</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>level</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>regulations</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>handlingRequirements</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AuthenticationMethod</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>strength</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>multiFactor</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>DataVolume</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>size</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>frequency</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>peak</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Criticality</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>level</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>businessImpact</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dependencies</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AttackVector</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vectorId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>difficulty</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>prerequisites</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>techniques</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ImpactAssessment</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>confidentialityImpact</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>integrityImpact</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>availabilityImpact</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>businessImpact</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>MitigationImplementation</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>automationLevel</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>requiredResources</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>RiskAssessment</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>overallRiskScore</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>riskDistribution</span>: <span style=color:#66d9ef>any</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>residualRisk</span>: <span style=color:#66d9ef>any</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>prioritizedThreats</span>: <span style=color:#66d9ef>IdentifiedThreat</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mitigationCoverage</span>: <span style=color:#66d9ef>any</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>recommendations</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=plantuml-container><img id=plantuml- class=plantuml-diagram>
<a id=plantuml-link- href=# target=_blank class=plantuml-link title="Open diagram in new window"><span class=plantuml-link-icon>🔍</span></a></div><script src=/js/rawdeflate.js></script><script>function encode64(e){r="";for(i=0;i<e.length;i+=3)i+2==e.length?r+=append3bytes(e.charCodeAt(i),e.charCodeAt(i+1),0):i+1==e.length?r+=append3bytes(e.charCodeAt(i),0,0):r+=append3bytes(e.charCodeAt(i),e.charCodeAt(i+1),e.charCodeAt(i+2));return r}function append3bytes(e,t,n){return c1=e>>2,c2=(e&3)<<4|t>>4,c3=(t&15)<<2|n>>6,c4=n&63,r="",r+=encode6bit(c1&63),r+=encode6bit(c2&63),r+=encode6bit(c3&63),r+=encode6bit(c4&63),r}function encode6bit(e){return e<10?String.fromCharCode(48+e):(e-=10,e<26?String.fromCharCode(65+e):(e-=26,e<26?String.fromCharCode(97+e):(e-=26,e==0?"-":e==1?"_":"?")))}var deflater=window.SharedWorker&&new SharedWorker("/js/rawdeflate.js");deflater?(deflater.port.addEventListener("message",done_deflating,!1),deflater.port.start()):window.Worker&&(deflater=new Worker("/js/rawdeflate.js"),deflater.onmessage=done_deflating);function done_deflating(e){const s=document.getElementById("plantuml-"),t="https://www.plantuml.com/plantuml/img/"+encode64(e.data);s.src=t;const n=document.getElementById("plantuml-link-");n&&(n.href=t)}function compress(e){e=unescape(encodeURIComponent(e)),deflater?deflater.port&&deflater.port.postMessage?deflater.port.postMessage(e):deflater.postMessage(e):setTimeout(function(){done_deflating({data:deflate(e)})},100)}compress(`
@startuml
!define ICONURL https://raw.githubusercontent.com/tupadr3/plantuml-icon-font-sprites/v2.4.0
!includeurl ICONURL/common.puml
!includeurl ICONURL/font-awesome-5/shield-alt.puml
!includeurl ICONURL/font-awesome-5/exclamation-triangle.puml

title Comprehensive Threat Modeling Process

participant "Security Architect" as architect
participant "Threat Modeling Engine" as engine
participant "Architecture Discovery" as discovery
participant "Threat Database" as threatdb
participant "Risk Calculator" as risk
participant "Mitigation Recommender" as mitigation

architect -> engine: Initiate Threat Model
activate engine

engine -> discovery: Discover Architecture
activate discovery
discovery -> discovery: Analyze Components
discovery -> discovery: Identify Data Flows
discovery -> discovery: Map Trust Boundaries
discovery -> engine: Architecture Model
deactivate discovery

engine -> threatdb: Query Threat Patterns
activate threatdb
threatdb -> threatdb: STRIDE Analysis
threatdb -> threatdb: Cloud-Specific Threats
threatdb -> threatdb: Attack Vector Mapping
threatdb -> engine: Threat Scenarios
deactivate threatdb

engine -> risk: Calculate Risk Scores
activate risk
risk -> risk: Impact Assessment
risk -> risk: Likelihood Analysis
risk -> risk: Business Context
risk -> engine: Risk Ratings
deactivate risk

engine -> mitigation: Generate Mitigations
activate mitigation
mitigation -> mitigation: Control Mapping
mitigation -> mitigation: Cost-Benefit Analysis
mitigation -> mitigation: Implementation Planning
mitigation -> engine: Mitigation Strategies
deactivate mitigation

engine -> architect: Complete Threat Model
deactivate engine

@enduml
`)</script><h2 id=attack-surface-analysis>Attack Surface Analysis</h2><p>Cloud applications present a significantly different attack surface compared to traditional monolithic applications because they expose multiple entry points through APIs, service interfaces, and cloud service integrations. The distributed nature of these applications means that the attack surface extends beyond the application code to include configuration settings, infrastructure components, and third-party service dependencies. Effective attack surface analysis must catalog all potential entry points while understanding how attackers might chain together multiple vulnerabilities to achieve their objectives.</p><p>The dynamic nature of cloud infrastructure introduces unique challenges for attack surface management because new services, endpoints, and configurations can be deployed rapidly through automated processes. Traditional approaches that rely on periodic scans or manual assessments cannot keep pace with the velocity of change in cloud-native environments. Modern attack surface analysis must be continuous and automated, providing real-time visibility into changes that might introduce new vulnerabilities or attack vectors.</p><p>The shared responsibility model of cloud computing creates complexity in attack surface analysis because some components are managed by cloud service providers while others are under direct organizational control. Understanding these boundaries is crucial for comprehensive attack surface analysis because it determines which security controls are the organization&rsquo;s responsibility and which are provided by the cloud platform. This analysis must account for potential vulnerabilities in both organizational components and the interfaces to cloud-managed services.</p><p>Here&rsquo;s an implementation of comprehensive attack surface analysis for cloud applications:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// attack-surface-analyzer.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Route53Client</span>, <span style=color:#a6e22e>ListHostedZonesCommand</span>, <span style=color:#a6e22e>ListResourceRecordSetsCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-route-53&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ElasticLoadBalancingV2Client</span>, <span style=color:#a6e22e>DescribeLoadBalancersCommand</span>, <span style=color:#a6e22e>DescribeTargetGroupsCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-elastic-load-balancing-v2&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CloudFrontClient</span>, <span style=color:#a6e22e>ListDistributionsCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-cloudfront&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CertificateManagerClient</span>, <span style=color:#a6e22e>ListCertificatesCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-acm&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AttackSurfaceAnalysis</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>analysisId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>Date</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AnalysisScope</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>discoveredAssets</span>: <span style=color:#66d9ef>DiscoveredAsset</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>exposedServices</span>: <span style=color:#66d9ef>ExposedService</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>attackVectors</span>: <span style=color:#66d9ef>AttackSurfaceVector</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vulnerabilities</span>: <span style=color:#66d9ef>SurfaceVulnerability</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>recommendations</span>: <span style=color:#66d9ef>SurfaceRecommendation</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>riskScore</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>DiscoveredAsset</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>assetId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>assetType</span>: <span style=color:#66d9ef>AssetType</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>location</span>: <span style=color:#66d9ef>AssetLocation</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>exposureLevel</span>: <span style=color:#66d9ef>ExposureLevel</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>accessMethods</span>: <span style=color:#66d9ef>AccessMethod</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dataHandled</span>: <span style=color:#66d9ef>DataClassification</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>securityControls</span>: <span style=color:#66d9ef>SecurityControl</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dependencies</span>: <span style=color:#66d9ef>AssetDependency</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ExposedService</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>serviceId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>serviceName</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>serviceType</span>: <span style=color:#66d9ef>ServiceType</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>endpoints</span>: <span style=color:#66d9ef>ServiceEndpoint</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>protocols</span>: <span style=color:#66d9ef>Protocol</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>authentication</span>: <span style=color:#66d9ef>AuthenticationRequirement</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>authorization</span>: <span style=color:#66d9ef>AuthorizationRequirement</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>encryption</span>: <span style=color:#66d9ef>EncryptionStatus</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>accessPatterns</span>: <span style=color:#66d9ef>AccessPattern</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rateLimiting</span>: <span style=color:#66d9ef>RateLimitingStatus</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AttackSurfaceVector</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vectorId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>entryPoints</span>: <span style=color:#66d9ef>EntryPoint</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>attackPath</span>: <span style=color:#66d9ef>AttackPathStep</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>exploitability</span>: <span style=color:#66d9ef>ExploitabilityRating</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>impact</span>: <span style=color:#66d9ef>ImpactRating</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mitigationComplexity</span>: <span style=color:#66d9ef>MitigationComplexity</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>affectedAssets</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SurfaceVulnerability</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vulnerabilityId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>title</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>category</span>: <span style=color:#66d9ef>VulnerabilityCategory</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>VulnerabilitySeverity</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cvssScore?</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>affectedAssets</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>exploitConditions</span>: <span style=color:#66d9ef>ExploitCondition</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>remediationSteps</span>: <span style=color:#66d9ef>RemediationStep</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>detectionMethods</span>: <span style=color:#66d9ef>DetectionMethod</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>AssetType</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>WEB_APPLICATION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;WEB_APPLICATION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>API_ENDPOINT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;API_ENDPOINT&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>DATABASE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;DATABASE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>STORAGE_BUCKET</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;STORAGE_BUCKET&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MESSAGE_QUEUE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MESSAGE_QUEUE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LOAD_BALANCER</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LOAD_BALANCER&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CDN_ENDPOINT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CDN_ENDPOINT&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>DNS_RECORD</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;DNS_RECORD&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CERTIFICATE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CERTIFICATE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>NETWORK_INTERFACE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;NETWORK_INTERFACE&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>ServiceType</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>REST_API</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;REST_API&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>GRAPHQL_API</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;GRAPHQL_API&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>WEBSOCKET</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;WEBSOCKET&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>DATABASE_SERVICE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;DATABASE_SERVICE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>FILE_TRANSFER</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;FILE_TRANSFER&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MESSAGE_BROKER</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MESSAGE_BROKER&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>AUTHENTICATION_SERVICE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AUTHENTICATION_SERVICE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MONITORING_SERVICE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MONITORING_SERVICE&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AttackSurfaceAnalyzer</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>route53Client</span>: <span style=color:#66d9ef>Route53Client</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>elbClient</span>: <span style=color:#66d9ef>ElasticLoadBalancingV2Client</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>cloudFrontClient</span>: <span style=color:#66d9ef>CloudFrontClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>acmClient</span>: <span style=color:#66d9ef>CertificateManagerClient</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>route53Client</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Route53Client</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>elbClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ElasticLoadBalancingV2Client</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cloudFrontClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CloudFrontClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>acmClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CertificateManagerClient</span>({});
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>analyzeAttackSurface</span>(<span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AnalysisScope</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>AttackSurfaceAnalysis</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>analysisId</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateAnalysisId</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Discover all assets within scope
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>discoveredAssets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>discoverAssets</span>(<span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Identify exposed services
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>exposedServices</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>identifyExposedServices</span>(<span style=color:#a6e22e>discoveredAssets</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Analyze attack vectors
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>attackVectors</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeAttackVectors</span>(<span style=color:#a6e22e>discoveredAssets</span>, <span style=color:#a6e22e>exposedServices</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Identify vulnerabilities
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>vulnerabilities</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>identifyVulnerabilities</span>(<span style=color:#a6e22e>discoveredAssets</span>, <span style=color:#a6e22e>exposedServices</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Generate recommendations
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>recommendations</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateRecommendations</span>(<span style=color:#a6e22e>attackVectors</span>, <span style=color:#a6e22e>vulnerabilities</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Calculate risk score
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>riskScore</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateAttackSurfaceRisk</span>(<span style=color:#a6e22e>attackVectors</span>, <span style=color:#a6e22e>vulnerabilities</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>analysis</span>: <span style=color:#66d9ef>AttackSurfaceAnalysis</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>analysisId</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>new</span> Date(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>scope</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>discoveredAssets</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>exposedServices</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>attackVectors</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>vulnerabilities</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>recommendations</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>riskScore</span>
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Store analysis results
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>storeAnalysisResults</span>(<span style=color:#a6e22e>analysis</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>analysis</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;Attack surface analysis failed:&#39;</span>, <span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>discoverAssets</span>(<span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AnalysisScope</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>DiscoveredAsset</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>assets</span>: <span style=color:#66d9ef>DiscoveredAsset</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Discover DNS assets
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>dnsAssets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>discoverDNSAssets</span>(<span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>assets</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>dnsAssets</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Discover load balancer assets
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>loadBalancerAssets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>discoverLoadBalancerAssets</span>(<span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>assets</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>loadBalancerAssets</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Discover CDN assets
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>cdnAssets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>discoverCDNAssets</span>(<span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>assets</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>cdnAssets</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Discover certificate assets
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>certificateAssets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>discoverCertificateAssets</span>(<span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>assets</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>certificateAssets</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Discover API assets
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>apiAssets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>discoverAPIAssets</span>(<span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>assets</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>apiAssets</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>assets</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>discoverDNSAssets</span>(<span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AnalysisScope</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>DiscoveredAsset</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>assets</span>: <span style=color:#66d9ef>DiscoveredAsset</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>hostedZones</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>route53Client</span>.<span style=color:#a6e22e>send</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ListHostedZonesCommand</span>({}));
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>zone</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>hostedZones</span>.<span style=color:#a6e22e>HostedZones</span> <span style=color:#f92672>||</span> []) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>zone</span>.<span style=color:#a6e22e>Id</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isInScope</span>(<span style=color:#a6e22e>zone</span>.<span style=color:#a6e22e>Name</span>, <span style=color:#a6e22e>scope</span>)) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>recordSets</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>route53Client</span>.<span style=color:#a6e22e>send</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ListResourceRecordSetsCommand</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>HostedZoneId</span>: <span style=color:#66d9ef>zone.Id</span>
</span></span><span style=display:flex><span>          }));
</span></span><span style=display:flex><span>          
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>record</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>recordSets</span>.<span style=color:#a6e22e>ResourceRecordSets</span> <span style=color:#f92672>||</span> []) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>record</span>.<span style=color:#a6e22e>Name</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>record</span>.<span style=color:#a6e22e>Type</span>) {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>assets</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>assetId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`dns-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>zone</span>.<span style=color:#a6e22e>Id</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>record</span>.<span style=color:#a6e22e>Name</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>assetType</span>: <span style=color:#66d9ef>AssetType.DNS_RECORD</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>record.Name</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`DNS </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>record</span>.<span style=color:#a6e22e>Type</span><span style=color:#e6db74>}</span><span style=color:#e6db74> record in zone </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>zone</span>.<span style=color:#a6e22e>Name</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>location</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>region</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;global&#39;</span>,
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>availability</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;multi-region&#39;</span>,
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>provider</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AWS Route53&#39;</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>exposureLevel</span>: <span style=color:#66d9ef>this.determineDNSExposureLevel</span>(<span style=color:#a6e22e>record</span>),
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>accessMethods</span>: <span style=color:#66d9ef>this.analyzeDNSAccessMethods</span>(<span style=color:#a6e22e>record</span>),
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>dataHandled</span>: <span style=color:#66d9ef>this.analyzeDNSDataHandling</span>(<span style=color:#a6e22e>record</span>),
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>securityControls</span>: <span style=color:#66d9ef>this.analyzeDNSSecurityControls</span>(<span style=color:#a6e22e>record</span>),
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>dependencies</span>: <span style=color:#66d9ef>this.analyzeDNSDependencies</span>(<span style=color:#a6e22e>record</span>)
</span></span><span style=display:flex><span>              });
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>warn</span>(<span style=color:#e6db74>&#39;Failed to discover DNS assets:&#39;</span>, <span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>assets</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>discoverLoadBalancerAssets</span>(<span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AnalysisScope</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>DiscoveredAsset</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>assets</span>: <span style=color:#66d9ef>DiscoveredAsset</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>loadBalancers</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>elbClient</span>.<span style=color:#a6e22e>send</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>DescribeLoadBalancersCommand</span>({}));
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>lb</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>loadBalancers</span>.<span style=color:#a6e22e>LoadBalancers</span> <span style=color:#f92672>||</span> []) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>lb</span>.<span style=color:#a6e22e>LoadBalancerArn</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isInScope</span>(<span style=color:#a6e22e>lb</span>.<span style=color:#a6e22e>DNSName</span>, <span style=color:#a6e22e>scope</span>)) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>assets</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>assetId</span>: <span style=color:#66d9ef>lb.LoadBalancerArn</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>assetType</span>: <span style=color:#66d9ef>AssetType.LOAD_BALANCER</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>lb.LoadBalancerName</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;Unknown Load Balancer&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>lb</span>.<span style=color:#a6e22e>Type</span><span style=color:#e6db74>}</span><span style=color:#e6db74> load balancer`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>location</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>region</span>: <span style=color:#66d9ef>this.extractRegionFromArn</span>(<span style=color:#a6e22e>lb</span>.<span style=color:#a6e22e>LoadBalancerArn</span>),
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>availability</span>: <span style=color:#66d9ef>lb.AvailabilityZones?.map</span>(<span style=color:#a6e22e>az</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>az</span>.<span style=color:#a6e22e>ZoneName</span>).<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;,&#39;</span>) <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;unknown&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>provider</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AWS ELB&#39;</span>
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>exposureLevel</span>: <span style=color:#66d9ef>this.determineLoadBalancerExposureLevel</span>(<span style=color:#a6e22e>lb</span>),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>accessMethods</span>: <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeLoadBalancerAccessMethods</span>(<span style=color:#a6e22e>lb</span>),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>dataHandled</span>: <span style=color:#66d9ef>this.analyzeLoadBalancerDataHandling</span>(<span style=color:#a6e22e>lb</span>),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>securityControls</span>: <span style=color:#66d9ef>this.analyzeLoadBalancerSecurityControls</span>(<span style=color:#a6e22e>lb</span>),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>dependencies</span>: <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeLoadBalancerDependencies</span>(<span style=color:#a6e22e>lb</span>)
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>warn</span>(<span style=color:#e6db74>&#39;Failed to discover load balancer assets:&#39;</span>, <span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>assets</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>identifyExposedServices</span>(<span style=color:#a6e22e>assets</span>: <span style=color:#66d9ef>DiscoveredAsset</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>ExposedService</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>services</span>: <span style=color:#66d9ef>ExposedService</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>asset</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>assets</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>assetServices</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeAssetServices</span>(<span style=color:#a6e22e>asset</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>services</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>assetServices</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>services</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>analyzeAssetServices</span>(<span style=color:#a6e22e>asset</span>: <span style=color:#66d9ef>DiscoveredAsset</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>ExposedService</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>services</span>: <span style=color:#66d9ef>ExposedService</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> (<span style=color:#a6e22e>asset</span>.<span style=color:#a6e22e>assetType</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>AssetType.LOAD_BALANCER</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>services.push</span>(...<span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeLoadBalancerServices</span>(<span style=color:#a6e22e>asset</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>AssetType.API_ENDPOINT</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>services.push</span>(...<span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeAPIServices</span>(<span style=color:#a6e22e>asset</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>AssetType.CDN_ENDPOINT</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>services.push</span>(...<span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeCDNServices</span>(<span style=color:#a6e22e>asset</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>services</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>analyzeAttackVectors</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>assets</span>: <span style=color:#66d9ef>DiscoveredAsset</span>[],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>services</span>: <span style=color:#66d9ef>ExposedService</span>[]
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>AttackSurfaceVector</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>vectors</span>: <span style=color:#66d9ef>AttackSurfaceVector</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Analyze direct access vectors
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>vectors</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeDirectAccessVectors</span>(<span style=color:#a6e22e>services</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Analyze lateral movement vectors
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>vectors</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeLateralMovementVectors</span>(<span style=color:#a6e22e>assets</span>, <span style=color:#a6e22e>services</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Analyze supply chain vectors
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>vectors</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeSupplyChainVectors</span>(<span style=color:#a6e22e>assets</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Analyze configuration vectors
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>vectors</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>analyzeConfigurationVectors</span>(<span style=color:#a6e22e>assets</span>, <span style=color:#a6e22e>services</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>vectors</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeDirectAccessVectors</span>(<span style=color:#a6e22e>services</span>: <span style=color:#66d9ef>ExposedService</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>AttackSurfaceVector</span>[] {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>vectors</span>: <span style=color:#66d9ef>AttackSurfaceVector</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>service</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>services</span>) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Check for unauthenticated endpoints
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>service</span>.<span style=color:#a6e22e>authentication</span>.<span style=color:#a6e22e>required</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>vectors</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>vectorId</span>: <span style=color:#66d9ef>this.generateVectorId</span>(),
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Unauthenticated Access&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`Service </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>service</span>.<span style=color:#a6e22e>serviceName</span><span style=color:#e6db74>}</span><span style=color:#e6db74> allows unauthenticated access`</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>entryPoints</span>: <span style=color:#66d9ef>service.endpoints.map</span>(<span style=color:#a6e22e>ep</span> <span style=color:#f92672>=&gt;</span> ({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>entryPointId</span>: <span style=color:#66d9ef>ep.endpointId</span>,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;NETWORK&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`Unauthenticated access to </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>ep</span>.<span style=color:#a6e22e>url</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>accessMethod</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;DIRECT&#39;</span>
</span></span><span style=display:flex><span>          })),
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>attackPath</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>stepId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;1&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Direct network access to exposed endpoint&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>techniques</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;Direct HTTP/HTTPS requests&#39;</span>],
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>prerequisites</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;Network connectivity&#39;</span>],
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>difficulty</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;LOW&#39;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          ],
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>exploitability</span>: <span style=color:#66d9ef>ExploitabilityRating.HIGH</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>impact</span>: <span style=color:#66d9ef>this.assessServiceImpact</span>(<span style=color:#a6e22e>service</span>),
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>mitigationComplexity</span>: <span style=color:#66d9ef>MitigationComplexity.LOW</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>affectedAssets</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>service</span>.<span style=color:#a6e22e>serviceId</span>]
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Check for weak authentication
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>service</span>.<span style=color:#a6e22e>authentication</span>.<span style=color:#a6e22e>required</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>service</span>.<span style=color:#a6e22e>authentication</span>.<span style=color:#a6e22e>strength</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;WEAK&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>vectors</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>vectorId</span>: <span style=color:#66d9ef>this.generateVectorId</span>(),
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Weak Authentication Bypass&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`Service </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>service</span>.<span style=color:#a6e22e>serviceName</span><span style=color:#e6db74>}</span><span style=color:#e6db74> uses weak authentication that could be bypassed`</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>entryPoints</span>: <span style=color:#66d9ef>service.endpoints.map</span>(<span style=color:#a6e22e>ep</span> <span style=color:#f92672>=&gt;</span> ({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>entryPointId</span>: <span style=color:#66d9ef>ep.endpointId</span>,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AUTHENTICATION&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`Weak authentication bypass on </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>ep</span>.<span style=color:#a6e22e>url</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>accessMethod</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;CREDENTIAL_ATTACK&#39;</span>
</span></span><span style=display:flex><span>          })),
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>attackPath</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>stepId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;1&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Credential brute force or bypass&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>techniques</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;Brute force attack&#39;</span>, <span style=color:#e6db74>&#39;Credential stuffing&#39;</span>, <span style=color:#e6db74>&#39;Default credentials&#39;</span>],
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>prerequisites</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;Service endpoint access&#39;</span>],
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>difficulty</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          ],
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>exploitability</span>: <span style=color:#66d9ef>ExploitabilityRating.MEDIUM</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>impact</span>: <span style=color:#66d9ef>this.assessServiceImpact</span>(<span style=color:#a6e22e>service</span>),
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>mitigationComplexity</span>: <span style=color:#66d9ef>MitigationComplexity.MEDIUM</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>affectedAssets</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>service</span>.<span style=color:#a6e22e>serviceId</span>]
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>vectors</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>calculateAttackSurfaceRisk</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vectors</span>: <span style=color:#66d9ef>AttackSurfaceVector</span>[],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vulnerabilities</span>: <span style=color:#66d9ef>SurfaceVulnerability</span>[]
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>totalRisk</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Calculate risk from attack vectors
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>vector</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>vectors</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>vectorRisk</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateVectorRisk</span>(<span style=color:#a6e22e>vector</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>totalRisk</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>vectorRisk</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Calculate risk from vulnerabilities
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>vulnerability</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>vulnerabilities</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>vulnRisk</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateVulnerabilityRisk</span>(<span style=color:#a6e22e>vulnerability</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>totalRisk</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>vulnRisk</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Normalize to 0-100 scale
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> Math.<span style=color:#a6e22e>min</span>(<span style=color:#ae81ff>100</span>, <span style=color:#a6e22e>totalRisk</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>calculateVectorRisk</span>(<span style=color:#a6e22e>vector</span>: <span style=color:#66d9ef>AttackSurfaceVector</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>exploitabilityWeight</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ExploitabilityRating</span>.<span style=color:#a6e22e>VERY_LOW</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ExploitabilityRating</span>.<span style=color:#a6e22e>LOW</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ExploitabilityRating</span>.<span style=color:#a6e22e>MEDIUM</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ExploitabilityRating</span>.<span style=color:#a6e22e>HIGH</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>7</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ExploitabilityRating</span>.<span style=color:#a6e22e>VERY_HIGH</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>impactWeight</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ImpactRating</span>.<span style=color:#a6e22e>VERY_LOW</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ImpactRating</span>.<span style=color:#a6e22e>LOW</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ImpactRating</span>.<span style=color:#a6e22e>MEDIUM</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ImpactRating</span>.<span style=color:#a6e22e>HIGH</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>7</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ImpactRating</span>.<span style=color:#a6e22e>CRITICAL</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>exploitabilityWeight</span>[<span style=color:#a6e22e>vector</span>.<span style=color:#a6e22e>exploitability</span>] <span style=color:#f92672>*</span> <span style=color:#a6e22e>impactWeight</span>[<span style=color:#a6e22e>vector</span>.<span style=color:#a6e22e>impact</span>];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Helper methods
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>generateAnalysisId</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>`ASA-</span><span style=color:#e6db74>${</span>Date.<span style=color:#a6e22e>now</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span>Math.<span style=color:#a6e22e>random</span>().<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>36</span>).<span style=color:#a6e22e>substr</span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>9</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>generateVectorId</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>`AV-</span><span style=color:#e6db74>${</span>Date.<span style=color:#a6e22e>now</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span>Math.<span style=color:#a6e22e>random</span>().<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>36</span>).<span style=color:#a6e22e>substr</span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>9</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>isInScope</span>(<span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>undefined</span>, <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AnalysisScope</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>name</span>) <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>scope</span>.<span style=color:#a6e22e>domains</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>some</span>(<span style=color:#a6e22e>domain</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>name</span>.<span style=color:#a6e22e>includes</span>(<span style=color:#a6e22e>domain</span>)) <span style=color:#f92672>||</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>extractRegionFromArn</span>(<span style=color:#a6e22e>arn</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>arnParts</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>arn</span>.<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#39;:&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>arnParts</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>arnParts</span>[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;unknown&#39;</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>determineDNSExposureLevel</span>(<span style=color:#a6e22e>record</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>ExposureLevel</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Logic to determine exposure level based on record type and configuration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ExposureLevel</span>.<span style=color:#a6e22e>PUBLIC</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>assessServiceImpact</span>(<span style=color:#a6e22e>service</span>: <span style=color:#66d9ef>ExposedService</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>ImpactRating</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Logic to assess the impact of compromising this service
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ImpactRating</span>.<span style=color:#a6e22e>MEDIUM</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Additional helper methods would be implemented here...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeDNSAccessMethods</span>(<span style=color:#a6e22e>record</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>AccessMethod</span>[] { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeDNSDataHandling</span>(<span style=color:#a6e22e>record</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>DataClassification</span>[] { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeDNSSecurityControls</span>(<span style=color:#a6e22e>record</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>SecurityControl</span>[] { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeDNSDependencies</span>(<span style=color:#a6e22e>record</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>AssetDependency</span>[] { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>determineLoadBalancerExposureLevel</span>(<span style=color:#a6e22e>lb</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>ExposureLevel</span> { <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ExposureLevel</span>.<span style=color:#a6e22e>PUBLIC</span>; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>analyzeLoadBalancerAccessMethods</span>(<span style=color:#a6e22e>lb</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>AccessMethod</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeLoadBalancerDataHandling</span>(<span style=color:#a6e22e>lb</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>DataClassification</span>[] { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeLoadBalancerSecurityControls</span>(<span style=color:#a6e22e>lb</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>SecurityControl</span>[] { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>analyzeLoadBalancerDependencies</span>(<span style=color:#a6e22e>lb</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>AssetDependency</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>discoverCDNAssets</span>(<span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AnalysisScope</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>DiscoveredAsset</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>discoverCertificateAssets</span>(<span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AnalysisScope</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>DiscoveredAsset</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>discoverAPIAssets</span>(<span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AnalysisScope</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>DiscoveredAsset</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>analyzeLoadBalancerServices</span>(<span style=color:#a6e22e>asset</span>: <span style=color:#66d9ef>DiscoveredAsset</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>ExposedService</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>analyzeAPIServices</span>(<span style=color:#a6e22e>asset</span>: <span style=color:#66d9ef>DiscoveredAsset</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>ExposedService</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>analyzeCDNServices</span>(<span style=color:#a6e22e>asset</span>: <span style=color:#66d9ef>DiscoveredAsset</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>ExposedService</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeLateralMovementVectors</span>(<span style=color:#a6e22e>assets</span>: <span style=color:#66d9ef>DiscoveredAsset</span>[], <span style=color:#a6e22e>services</span>: <span style=color:#66d9ef>ExposedService</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>AttackSurfaceVector</span>[] { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeSupplyChainVectors</span>(<span style=color:#a6e22e>assets</span>: <span style=color:#66d9ef>DiscoveredAsset</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>AttackSurfaceVector</span>[] { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>analyzeConfigurationVectors</span>(<span style=color:#a6e22e>assets</span>: <span style=color:#66d9ef>DiscoveredAsset</span>[], <span style=color:#a6e22e>services</span>: <span style=color:#66d9ef>ExposedService</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>AttackSurfaceVector</span>[] { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>identifyVulnerabilities</span>(<span style=color:#a6e22e>assets</span>: <span style=color:#66d9ef>DiscoveredAsset</span>[], <span style=color:#a6e22e>services</span>: <span style=color:#66d9ef>ExposedService</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>SurfaceVulnerability</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>generateRecommendations</span>(<span style=color:#a6e22e>vectors</span>: <span style=color:#66d9ef>AttackSurfaceVector</span>[], <span style=color:#a6e22e>vulnerabilities</span>: <span style=color:#66d9ef>SurfaceVulnerability</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>SurfaceRecommendation</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>storeAnalysisResults</span>(<span style=color:#a6e22e>analysis</span>: <span style=color:#66d9ef>AttackSurfaceAnalysis</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {}
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>calculateVulnerabilityRisk</span>(<span style=color:#a6e22e>vulnerability</span>: <span style=color:#66d9ef>SurfaceVulnerability</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span> { <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>; }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Supporting interfaces and enums
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AnalysisScope</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>domains?</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ipRanges?</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>services?</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>regions?</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>excludedAssets?</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AssetLocation</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>region</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>availability</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>provider</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AccessMethod</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>method</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>protocol</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>port?</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>authentication</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SecurityControl</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>controlType</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>implementation</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>effectiveness</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AssetDependency</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dependencyId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dependencyType</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>relationship</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ServiceEndpoint</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>endpointId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>url</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>method</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>authentication</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Protocol</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>version</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>security</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AuthenticationRequirement</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>required</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>method</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>strength</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AuthorizationRequirement</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>required</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>model</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>granularity</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>EncryptionStatus</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>inTransit</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>atRest</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>keyManagement</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AccessPattern</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pattern</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>frequency</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>source</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>RateLimitingStatus</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>enabled</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>limits</span>: <span style=color:#66d9ef>any</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>enforcement</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>EntryPoint</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>entryPointId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>accessMethod</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AttackPathStep</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stepId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>techniques</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>prerequisites</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>difficulty</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>ExploitabilityRating</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>VERY_LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;VERY_LOW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LOW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MEDIUM</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>VERY_HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;VERY_HIGH&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>ImpactRating</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>VERY_LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;VERY_LOW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LOW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MEDIUM</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CRITICAL</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CRITICAL&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>MitigationComplexity</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LOW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MEDIUM</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>VERY_HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;VERY_HIGH&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>VulnerabilityCategory</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>AUTHENTICATION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AUTHENTICATION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>AUTHORIZATION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AUTHORIZATION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>INPUT_VALIDATION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;INPUT_VALIDATION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ENCRYPTION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ENCRYPTION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CONFIGURATION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CONFIGURATION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>DEPENDENCY</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;DEPENDENCY&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>VulnerabilitySeverity</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CRITICAL</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CRITICAL&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MEDIUM</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LOW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>INFO</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;INFO&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ExploitCondition</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>condition</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>likelihood</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>complexity</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>RemediationStep</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>step</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>priority</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>effort</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>DetectionMethod</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>method</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>tool</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>effectiveness</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SurfaceRecommendation</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>recommendationId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>title</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>priority</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>effort</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>impact</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Threat modeling for cloud applications represents a sophisticated evolution of traditional security assessment practices, requiring comprehensive understanding of distributed architectures, cloud service dependencies, and dynamic infrastructure patterns. The success of cloud threat modeling initiatives depends on automated discovery capabilities, sophisticated analysis engines, and integration with development workflows that can keep pace with the velocity of modern software delivery while maintaining the rigor necessary for effective security analysis.</p><p>The investment in comprehensive threat modeling capabilities pays dividends beyond security risk identification by creating organizational understanding of system architectures, data flows, and security dependencies that inform better design decisions and operational practices. Organizations that successfully implement automated threat modeling for cloud applications are better positioned to scale their security practices with their development velocity while maintaining robust protection against evolving threats in complex distributed environments.</p><p>The future of cloud threat modeling will likely see increased integration with artificial intelligence and machine learning capabilities that can provide more sophisticated threat pattern recognition, automated mitigation recommendation, and predictive threat modeling based on emerging attack trends. Organizations that establish strong foundations in cloud threat modeling today will be well-positioned to take advantage of these advances while maintaining comprehensive security coverage in increasingly complex cloud-native architectures.</p><p>This concludes our comprehensive seven-part series on Security in Cloud-Native Applications. Throughout this series, we&rsquo;ve explored the fundamental security challenges and solutions for modern cloud environments, from zero-trust architecture implementation through comprehensive threat modeling. Each post has provided detailed technical implementations and practical guidance for building secure, scalable, and maintainable cloud-native security capabilities that can evolve with the rapidly changing threat landscape.</p></div><div class=social-share><h3 class=social-share-title>Share this post</h3><div class=social-share-buttons><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F&text=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design+-+%3Cp%3EThreat+modeling+for+cloud+applications+requires+a+fundamental+rethinking+of+traditional+security+assessment+approaches+because+cloud-native+architectures+%E2%80%A6%3C%2Fp%3E" target=_blank rel="noopener noreferrer" class="social-share-button twitter" title="Share on Twitter"><svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
<span>Twitter</span>
</a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F" target=_blank rel="noopener noreferrer" class="social-share-button linkedin" title="Share on LinkedIn"><svg viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
<span>LinkedIn</span>
</a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F" target=_blank rel="noopener noreferrer" class="social-share-button facebook" title="Share on Facebook"><svg viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312.0 2.686.235 2.686.235v2.953H15.83c-1.491.0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
<span>Facebook</span>
</a><a href="https://reddit.com/submit?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F&title=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design" target=_blank rel="noopener noreferrer" class="social-share-button reddit" title="Share on Reddit"><svg viewBox="0 0 24 24"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg>
<span>Reddit</span>
</a><a href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F&t=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design" target=_blank rel="noopener noreferrer" class="social-share-button hackernews" title="Share on Hacker News"><svg viewBox="0 0 24 24"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
<span>Hacker News</span>
</a><a href="https://wa.me/?text=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design+https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F" target=_blank rel="noopener noreferrer" class="social-share-button whatsapp" title="Share on WhatsApp"><svg viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893A11.821 11.821.0 0020.465 3.488"/></svg>
<span>WhatsApp</span>
</a><a href="mailto:?subject=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design&body=Check+out+this+article%3A+Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design+-+https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F" class="social-share-button email" title="Share via Email"><svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1.0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"/></svg>
<span>Email</span>
</a><button type=button class="social-share-button copy-link" data-url=https://scottobert.com/posts/threat-modeling-cloud-applications/ title="Copy link to clipboard">
<svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1.0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1.0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1.0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
<span>Copy Link</span></button></div></div><script>(function(){const n=document.querySelectorAll(".copy-link");n.forEach(n=>{n.addEventListener("click",function(){const n=this.getAttribute("data-url");navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(n).then(()=>{t(this)}).catch(()=>{e(n,this)}):e(n,this)})});function e(e,n){const o=document.createElement("textarea");o.value=e,o.style.position="fixed",o.style.left="-999999px",o.style.top="-999999px",document.body.appendChild(o),o.focus(),o.select();try{document.execCommand("copy"),t(n)}catch(e){console.error("Fallback: Unable to copy",e),s(n)}document.body.removeChild(o)}function t(e){const t=e.querySelector("span").textContent;e.querySelector("span").textContent="Copied!",e.classList.add("copied"),setTimeout(()=>{e.querySelector("span").textContent=t,e.classList.remove("copied")},2e3)}function s(e){const t=e.querySelector("span").textContent;e.querySelector("span").textContent="Error",e.classList.add("error"),setTimeout(()=>{e.querySelector("span").textContent=t,e.classList.remove("error")},2e3)}})()</script><div id=comments-section style="margin-top:2rem;padding-top:2rem;border-top:1px solid #e1e5e9"><h3 style=margin-bottom:1rem;color:#586069>Comments</h3><script src=https://giscus.app/client.js data-repo=scottobert/scottobert.github.io data-repo-id=R_kgDOHRSG6A data-category=General data-category-id=DIC_kwDOHRSG6M4CrQaA data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=light data-lang=en data-loading=lazy crossorigin=anonymous async></script></div></article><div class=floating-social-share id=floating-share><div class=floating-share-toggle id=share-toggle title="Share this post"><svg viewBox="0 0 24 24"><path d="M18 16.08c-.76.0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66.0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66.0-3 1.34-3 3s1.34 3 3 3c.79.0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65.0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"/></svg></div><div class=floating-share-buttons id=share-buttons><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F&text=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design" target=_blank rel="noopener noreferrer" class="floating-share-button twitter" title="Share on Twitter"><svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
</a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F" target=_blank rel="noopener noreferrer" class="floating-share-button linkedin" title="Share on LinkedIn"><svg viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
</a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F" target=_blank rel="noopener noreferrer" class="floating-share-button facebook" title="Share on Facebook"><svg viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312.0 2.686.235 2.686.235v2.953H15.83c-1.491.0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
</a><a href="https://reddit.com/submit?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F&title=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design" target=_blank rel="noopener noreferrer" class="floating-share-button reddit" title="Share on Reddit"><svg viewBox="0 0 24 24"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg>
</a><a href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F&t=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design" target=_blank rel="noopener noreferrer" class="floating-share-button hackernews" title="Share on Hacker News"><svg viewBox="0 0 24 24"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
</a><a href="https://wa.me/?text=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design+https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F" target=_blank rel="noopener noreferrer" class="floating-share-button whatsapp" title="Share on WhatsApp"><svg viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893A11.821 11.821.0 0020.465 3.488"/></svg>
</a><a href="mailto:?subject=Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design&body=Check+out+this+article%3A+Threat+Modeling+for+Cloud+Applications%3A+A+Comprehensive+Approach+to+Security+Design+-+https%3A%2F%2Fscottobert.com%2Fposts%2Fthreat-modeling-cloud-applications%2F" class="floating-share-button email" title="Share via Email"><svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1.0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"/></svg>
</a><button type=button class="floating-share-button copy-link" data-url=https://scottobert.com/posts/threat-modeling-cloud-applications/ title="Copy link">
<svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1.0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1.0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1.0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg></button></div></div><script>(function(){const s=document.getElementById("floating-share"),t=document.getElementById("share-toggle"),n=document.getElementById("share-buttons");if(!s||!t||!n)return;let e=!1,o;t.addEventListener("click",function(){e=!e,e?(n.classList.add("visible"),t.classList.add("active"),clearTimeout(o)):(n.classList.remove("visible"),t.classList.remove("active"))});function i(){clearTimeout(o),o=setTimeout(()=>{e&&(n.classList.remove("visible"),t.classList.remove("active"),e=!1)},5e3)}s.addEventListener("mouseenter",()=>{clearTimeout(o)}),s.addEventListener("mouseleave",()=>{e&&i()}),t.addEventListener("click",()=>{e&&i()});let l=0;const d=300;window.addEventListener("scroll",function(){const o=window.pageYOffset||document.documentElement.scrollTop;o>d?s.classList.add("visible"):(s.classList.remove("visible"),e&&(n.classList.remove("visible"),t.classList.remove("active"),e=!1)),l=o});const a=n.querySelector(".copy-link");a&&a.addEventListener("click",function(){const e=this.getAttribute("data-url");navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(e).then(()=>{c(this)}).catch(()=>{r(e,this)}):r(e,this)});function r(e,t){const n=document.createElement("textarea");n.value=e,n.style.position="fixed",n.style.left="-999999px",n.style.top="-999999px",document.body.appendChild(n),n.focus(),n.select();try{document.execCommand("copy"),c(t)}catch(e){console.error("Fallback: Unable to copy",e)}document.body.removeChild(n)}function c(e){e.classList.add("copied"),setTimeout(()=>{e.classList.remove("copied")},2e3)}})()</script></main><aside class=blog-sidebar><div class=sidebar-widget><h3>Recent Posts</h3><ul class=recent-posts><li><a href=/posts/reverting-git-commits-safely/>Reverting Git Commits Safely: Undoing Changes Without Losing History</a>
<span class=post-date>Jun 11, 2025</span></li><li><a href=/posts/dynamodb-streams-opensearch-sync/>Real-time Data Synchronization: Using DynamoDB Streams and Lambda to Keep OpenSearch Indexes Current</a>
<span class=post-date>Jun 6, 2025</span></li><li><a href=/posts/using-ai-in-software-engineering/>Harnessing AI in Software Engineering: Opportunities and Challenges</a>
<span class=post-date>May 29, 2025</span></li><li><a href=/posts/aws-serverless-cost-optimization/>Cost Optimization Strategies for AWS Serverless Applications</a>
<span class=post-date>Jun 17, 2023</span></li><li><a href=/posts/aws-sns-sqs-typescript/>Building Event-Driven Architectures with AWS SNS/SQS and TypeScript</a>
<span class=post-date>May 21, 2023</span></li></ul></div><div class=sidebar-widget><h3>Post Series</h3><ul class=recent-posts><li><a href=/posts/aws-sns-sqs-typescript/>AWS and Typescript: Building Event-Driven Architectures with AWS SNS/SQS and TypeScript</a>
<span class=post-date>May 21, 2023</span><div class=series-meta><a href=/series/aws-and-typescript/ class=series-link>View all 3 posts in series →</a></div></li><li><a href=/posts/real-time-processing-architectures/>Cloud Architecture Patterns: Real-time Processing Architectures</a>
<span class=post-date>Apr 11, 2021</span><div class=series-meta><a href=/series/cloud-architecture-patterns/ class=series-link>View all 7 posts in series →</a></div></li><li><a href=/posts/technical-debt-management-growing-codebases/>Modern Development Practices: Technical Debt Management in Growing Codebases: Strategies for Sustainable Development</a>
<span class=post-date>Dec 19, 2021</span><div class=series-meta><a href=/series/modern-development-practices/ class=series-link>View all 7 posts in series →</a></div></li><li><a href=/posts/threat-modeling-cloud-applications/>Security in Cloud-Native Applications: Threat Modeling for Cloud Applications: A Comprehensive Approach to Security Design</a>
<span class=post-date>Oct 19, 2019</span><div class=series-meta><a href=/series/security-in-cloud-native-applications/ class=series-link>View all 7 posts in series →</a></div></li></ul></div><div class=sidebar-widget><h3>Categories</h3><ul class=categories><li><a href=/categories/api-development>api development (1)</a></li><li><a href=/categories/architecture>architecture (2)</a></li><li><a href=/categories/architecture-and-design>architecture and design (8)</a></li><li><a href=/categories/artificial-intelligence>artificial intelligence (1)</a></li><li><a href=/categories/cloud-computing>cloud computing (16)</a></li><li><a href=/categories/code-quality>code quality (1)</a></li><li><a href=/categories/compliance>compliance (1)</a></li><li><a href=/categories/cost-optimization>cost optimization (1)</a></li><li><a href=/categories/data-engineering>data engineering (3)</a></li><li><a href=/categories/database>database (1)</a></li><li><a href=/categories/debugging-and-troubleshooting>debugging and troubleshooting (1)</a></li><li><a href=/categories/developer-experience>developer experience (1)</a></li><li><a href=/categories/development-tools>development tools (3)</a></li><li><a href=/categories/development-tutorials>development tutorials (1)</a></li><li><a href=/categories/microservices>microservices (1)</a></li><li><a href=/categories/performance>performance (1)</a></li><li><a href=/categories/quality-assurance>quality assurance (1)</a></li><li><a href=/categories/security>security (8)</a></li><li><a href=/categories/serverless>serverless (2)</a></li><li><a href=/categories/software-development>software development (8)</a></li><li><a href=/categories/technical-debt>technical debt (1)</a></li><li><a href=/categories/testing>testing (2)</a></li><li><a href=/categories/version-control>version control (2)</a></li></ul></div><div class=sidebar-widget><h3>Tags</h3><div class=tag-cloud><a href=/tags/ai class=tag-cloud-item style=font-size:1rem>ai
</a><a href=/tags/api-design class=tag-cloud-item style=font-size:1rem>api design
</a><a href=/tags/api-security class=tag-cloud-item style=font-size:1rem>api security
</a><a href=/tags/architecture class=tag-cloud-item style=font-size:2rem>architecture
</a><a href=/tags/athena class=tag-cloud-item style=font-size:1rem>athena
</a><a href=/tags/authentication class=tag-cloud-item style=font-size:1rem>authentication
</a><a href=/tags/authorization class=tag-cloud-item style=font-size:1rem>authorization
</a><a href=/tags/automation class=tag-cloud-item style=font-size:1rem>automation
</a><a href=/tags/aws class=tag-cloud-item style=font-size:3rem>aws
</a><a href=/tags/aws-lambda class=tag-cloud-item style=font-size:1rem>aws lambda
</a><a href=/tags/best-practices class=tag-cloud-item style=font-size:1rem>best practices
</a><a href=/tags/chaos-engineering class=tag-cloud-item style=font-size:1rem>chaos engineering
</a><a href=/tags/ci/cd class=tag-cloud-item style=font-size:1rem>ci/cd
</a><a href=/tags/cloud-native class=tag-cloud-item style=font-size:1rem>cloud native
</a><a href=/tags/cloudnative class=tag-cloud-item style=font-size:1rem>cloudnative
</a><a href=/tags/code-quality class=tag-cloud-item style=font-size:1rem>code quality
</a><a href=/tags/communication-patterns class=tag-cloud-item style=font-size:1rem>communication patterns
</a><a href=/tags/compliance class=tag-cloud-item style=font-size:1rem>compliance
</a><a href=/tags/containers class=tag-cloud-item style=font-size:1rem>containers
</a><a href=/tags/cost-optimization class=tag-cloud-item style=font-size:1rem>cost optimization
</a><a href=/tags/cqrs class=tag-cloud-item style=font-size:1rem>cqrs
</a><a href=/tags/data-architecture class=tag-cloud-item style=font-size:1rem>data architecture
</a><a href=/tags/data-lake class=tag-cloud-item style=font-size:1rem>data lake
</a><a href=/tags/data-modeling class=tag-cloud-item style=font-size:1rem>data modeling
</a><a href=/tags/database-design class=tag-cloud-item style=font-size:1rem>database design
</a><a href=/tags/debugging class=tag-cloud-item style=font-size:1rem>debugging
</a><a href=/tags/debugging-and-troubleshooting class=tag-cloud-item style=font-size:1rem>debugging and troubleshooting
</a><a href=/tags/developer-tips class=tag-cloud-item style=font-size:1rem>developer tips
</a><a href=/tags/development class=tag-cloud-item style=font-size:2rem>development
</a><a href=/tags/devops class=tag-cloud-item style=font-size:1rem>devops
</a><a href=/tags/devsecops class=tag-cloud-item style=font-size:1rem>devsecops
</a><a href=/tags/distributed-systems class=tag-cloud-item style=font-size:1rem>distributed systems
</a><a href=/tags/docker class=tag-cloud-item style=font-size:1rem>docker
</a><a href=/tags/dynamodb class=tag-cloud-item style=font-size:1rem>dynamodb
</a><a href=/tags/encryption class=tag-cloud-item style=font-size:1rem>encryption
</a><a href=/tags/enterprise-architecture class=tag-cloud-item style=font-size:1rem>enterprise architecture
</a><a href=/tags/event-sourcing class=tag-cloud-item style=font-size:1rem>event sourcing
</a><a href=/tags/event-driven-architecture class=tag-cloud-item style=font-size:1rem>event-driven architecture
</a><a href=/tags/eventbridge class=tag-cloud-item style=font-size:1rem>eventbridge
</a><a href=/tags/fault-tolerance class=tag-cloud-item style=font-size:1rem>fault tolerance
</a><a href=/tags/gdpr class=tag-cloud-item style=font-size:1rem>gdpr
</a><a href=/tags/git class=tag-cloud-item style=font-size:1rem>git
</a><a href=/tags/glue class=tag-cloud-item style=font-size:1rem>glue
</a><a href=/tags/governance class=tag-cloud-item style=font-size:1rem>governance
</a><a href=/tags/graphql class=tag-cloud-item style=font-size:1rem>graphql
</a><a href=/tags/hipaa class=tag-cloud-item style=font-size:1rem>hipaa
</a><a href=/tags/iam class=tag-cloud-item style=font-size:1rem>iam
</a><a href=/tags/identity-management class=tag-cloud-item style=font-size:1rem>identity management
</a><a href=/tags/jwt class=tag-cloud-item style=font-size:1rem>jwt
</a><a href=/tags/kinesis class=tag-cloud-item style=font-size:1rem>kinesis
</a><a href=/tags/kubernetes class=tag-cloud-item style=font-size:1rem>kubernetes
</a><a href=/tags/lambda class=tag-cloud-item style=font-size:1rem>lambda
</a><a href=/tags/load-testing class=tag-cloud-item style=font-size:1rem>load testing
</a><a href=/tags/metrics class=tag-cloud-item style=font-size:1rem>metrics
</a><a href=/tags/microservices class=tag-cloud-item style=font-size:1rem>microservices
</a><a href=/tags/monitoring class=tag-cloud-item style=font-size:1rem>monitoring
</a><a href=/tags/multi-account class=tag-cloud-item style=font-size:1rem>multi-account
</a><a href=/tags/nosql class=tag-cloud-item style=font-size:1rem>nosql
</a><a href=/tags/oauth class=tag-cloud-item style=font-size:1rem>oauth
</a><a href=/tags/octave class=tag-cloud-item style=font-size:1rem>octave
</a><a href=/tags/opensearch class=tag-cloud-item style=font-size:1rem>opensearch
</a><a href=/tags/pasta class=tag-cloud-item style=font-size:1rem>pasta
</a><a href=/tags/patterns class=tag-cloud-item style=font-size:1rem>patterns
</a><a href=/tags/pci-dss class=tag-cloud-item style=font-size:1rem>pci-dss
</a><a href=/tags/performance-testing class=tag-cloud-item style=font-size:1rem>performance testing
</a><a href=/tags/productivity class=tag-cloud-item style=font-size:1rem>productivity
</a><a href=/tags/rate-limiting class=tag-cloud-item style=font-size:1rem>rate limiting
</a><a href=/tags/real-time class=tag-cloud-item style=font-size:1rem>real-time
</a><a href=/tags/refactoring class=tag-cloud-item style=font-size:1rem>refactoring
</a><a href=/tags/reliability class=tag-cloud-item style=font-size:1rem>reliability
</a><a href=/tags/resilience class=tag-cloud-item style=font-size:1rem>resilience
</a><a href=/tags/rest class=tag-cloud-item style=font-size:1rem>rest
</a><a href=/tags/riskassessment class=tag-cloud-item style=font-size:1rem>riskassessment
</a><a href=/tags/s3 class=tag-cloud-item style=font-size:1rem>s3
</a><a href=/tags/search class=tag-cloud-item style=font-size:1rem>search
</a><a href=/tags/secrets-management class=tag-cloud-item style=font-size:1rem>secrets management
</a><a href=/tags/security class=tag-cloud-item style=font-size:2rem>security
</a><a href=/tags/securitydesign class=tag-cloud-item style=font-size:1rem>securitydesign
</a><a href=/tags/serverless class=tag-cloud-item style=font-size:2rem>serverless
</a><a href=/tags/soc2 class=tag-cloud-item style=font-size:1rem>soc2
</a><a href=/tags/software-engineering class=tag-cloud-item style=font-size:1rem>software engineering
</a><a href=/tags/standards class=tag-cloud-item style=font-size:1rem>standards
</a><a href=/tags/stream-processing class=tag-cloud-item style=font-size:1rem>stream processing
</a><a href=/tags/streams class=tag-cloud-item style=font-size:1rem>streams
</a><a href=/tags/stride class=tag-cloud-item style=font-size:1rem>stride
</a><a href=/tags/tdd class=tag-cloud-item style=font-size:1rem>tdd
</a><a href=/tags/technical-debt class=tag-cloud-item style=font-size:1rem>technical debt
</a><a href=/tags/testing class=tag-cloud-item style=font-size:1rem>testing
</a><a href=/tags/threatmodeling class=tag-cloud-item style=font-size:1rem>threatmodeling
</a><a href=/tags/typescript class=tag-cloud-item style=font-size:2rem>typescript
</a><a href=/tags/version-control class=tag-cloud-item style=font-size:1rem>version control
</a><a href=/tags/zero-trust class=tag-cloud-item style=font-size:1rem>zero trust</a></div></div><div class=sidebar-widget><h3>Subscribe</h3><div class=subscribe-links><a href=/index.xml class=rss-link><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg>
RSS Feed</a></div></div><div class="sidebar-widget npm-packages"><h3>My NPM Packages</h3><div id=npm-list></div></div></aside></div></div><footer class=site-footer><div class=container><p>&copy; 2025 Scott Obert</p></div></footer></body></html>
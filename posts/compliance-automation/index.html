<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Scott Obert</title><meta name=description content="The traditional approach to compliance, characterized by annual audits and point-in-time assessments, is fundamentally incompatible with the velocity and …"><link rel=canonical href=https://scottobert.com/posts/compliance-automation/><meta property="og:title" content="Compliance Automation: Implementing Continuous Compliance in Cloud-Native Environments"><meta property="og:description" content="The traditional approach to compliance, characterized by annual audits and point-in-time assessments, is fundamentally incompatible with the velocity and …"><meta property="og:type" content="article"><meta property="og:url" content="https://scottobert.com/posts/compliance-automation/"><meta property="og:site_name" content="Scott Obert"><meta name=twitter:card content="summary"><meta name=twitter:title content="Compliance Automation: Implementing Continuous Compliance in Cloud-Native Environments"><meta name=twitter:description content="The traditional approach to compliance, characterized by annual audits and point-in-time assessments, is fundamentally incompatible with the velocity and …"><link rel=stylesheet href=/css/style.css><script src=/js/npm-packages.js defer></script><script defer src=https://cloud.umami.is/script.js data-website-id=e2461896-021d-422a-b83f-624a8819309b></script></head><body><header class=site-header><div class=container><div class=header-content><div class=header-left><h1><a href=/>Scott Obert</a></h1><nav><a href=/posts/>Blog</a>
<a href=/album/>Photo Album</a></nav></div><div class=social-links><a href=https://www.linkedin.com/in/scott-obert-3a7338b/ target=_blank rel="noopener noreferrer" title="LinkedIn Profile"><svg viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
<span>LinkedIn</span>
</a><a href=https://github.com/scottobert target=_blank rel="noopener noreferrer" title="GitHub Profile"><svg viewBox="0 0 24 24"><path d="M12 0C5.37.0.0 5.37.0 12c0 5.3 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61-.546-1.385-1.335-1.755-1.335-1.755-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.605-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 21.795 24 17.295 24 12c0-6.63-5.37-12-12-12"/></svg>
<span>GitHub</span></a></div></div></div></header><div class=container><div class=content-layout><main class=main-content><article class=post><h1>Compliance Automation: Implementing Continuous Compliance in Cloud-Native Environments</h1><div class=post-meta><div class=post-meta-left><span>Sep 28, 2019</span>
<span>| Tags: Compliance, Automation, DevSecOps, CloudNative, Governance, GDPR, SOC2, HIPAA, PCI-DSS</span></div><div class=post-meta-right><div class=quick-social-share><button type=button class=quick-share-toggle id=quick-share-toggle title="Share this post">
<svg viewBox="0 0 24 24"><path d="M18 16.08c-.76.0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66.0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66.0-3 1.34-3 3s1.34 3 3 3c.79.0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65.0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"/></svg>
<span>Share</span></button><div class=quick-share-buttons id=quick-share-buttons><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F&text=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments" target=_blank rel="noopener noreferrer" class="quick-share-button twitter" title="Share on Twitter"><svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
</a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F" target=_blank rel="noopener noreferrer" class="quick-share-button linkedin" title="Share on LinkedIn"><svg viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
</a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F" target=_blank rel="noopener noreferrer" class="quick-share-button facebook" title="Share on Facebook"><svg viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312.0 2.686.235 2.686.235v2.953H15.83c-1.491.0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
</a><a href="https://reddit.com/submit?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F&title=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments" target=_blank rel="noopener noreferrer" class="quick-share-button reddit" title="Share on Reddit"><svg viewBox="0 0 24 24"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg>
</a><a href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F&t=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments" target=_blank rel="noopener noreferrer" class="quick-share-button hackernews" title="Share on Hacker News"><svg viewBox="0 0 24 24"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
</a><a href="https://wa.me/?text=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments+https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F" target=_blank rel="noopener noreferrer" class="quick-share-button whatsapp" title="Share on WhatsApp"><svg viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893A11.821 11.821.0 0020.465 3.488"/></svg>
</a><a href="mailto:?subject=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments&body=Check+out+this+article%3A+Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments+-+https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F" class="quick-share-button email" title="Share via Email"><svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1.0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"/></svg>
</a><button type=button class="quick-share-button copy-link" data-url=https://scottobert.com/posts/compliance-automation/ title="Copy link to clipboard">
<svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1.0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1.0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1.0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg></button></div></div><script>(function(){const i=document.querySelector(".quick-social-share"),e=document.getElementById("quick-share-toggle"),t=document.getElementById("quick-share-buttons");if(!i||!e||!t)return;let n=!1;e.addEventListener("click",function(){n=!n,n?(t.classList.add("visible"),e.classList.add("active")):(t.classList.remove("visible"),e.classList.remove("active"))});const a=document.querySelectorAll(".quick-share-button.copy-link");a.forEach(e=>{e.addEventListener("click",function(){const e=this.getAttribute("data-url");navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(e).then(()=>{o(this)}).catch(()=>{s(e,this)}):s(e,this)})});function s(e,t){const n=document.createElement("textarea");n.value=e,n.style.position="fixed",n.style.left="-999999px",n.style.top="-999999px",document.body.appendChild(n),n.focus(),n.select();try{document.execCommand("copy"),o(t)}catch(e){console.error("Fallback: Unable to copy",e),r(t)}document.body.removeChild(n)}function o(e){const n=e.getAttribute("title");e.setAttribute("title","Copied!"),e.classList.add("copied");const t=document.createElement("div");t.textContent="Copied!",t.style.position="absolute",t.style.bottom="100%",t.style.left="50%",t.style.transform="translateX(-50%)",t.style.background="#28a745",t.style.color="white",t.style.padding="4px 8px",t.style.borderRadius="4px",t.style.fontSize="0.75rem",t.style.whiteSpace="nowrap",t.style.zIndex="1000",t.style.marginBottom="5px",e.style.position="relative",e.appendChild(t),setTimeout(()=>{e.setAttribute("title",n),e.classList.remove("copied"),t.parentNode&&e.removeChild(t)},2e3)}function r(e){const t=e.getAttribute("title");e.setAttribute("title","Copy failed"),e.classList.add("error"),setTimeout(()=>{e.setAttribute("title",t),e.classList.remove("error")},2e3)}})()</script></div></div><div class=post-content><p>The traditional approach to compliance, characterized by annual audits and point-in-time assessments, is fundamentally incompatible with the velocity and dynamic nature of cloud-native development practices. Modern applications deploy multiple times per day, infrastructure components scale automatically based on demand, and data flows through complex distributed systems that may span multiple cloud providers and geographic regions. This operational reality demands a new approach to compliance that can keep pace with continuous delivery while maintaining rigorous adherence to regulatory requirements.</p><p>Compliance automation transforms regulatory adherence from a periodic burden into a continuous process that is deeply integrated with development and deployment workflows. Rather than treating compliance as a gate that slows down delivery, automated compliance systems become enablers that provide real-time visibility into compliance posture while preventing non-compliant configurations from reaching production environments. This shift requires rethinking compliance processes to focus on preventive controls and continuous monitoring rather than detective controls and periodic assessments.</p><p>The complexity of modern cloud environments makes manual compliance monitoring practically impossible. A typical cloud-native application might involve dozens of microservices, multiple data stores, various networking components, and integration with numerous third-party services. Each component introduces potential compliance implications that must be understood, monitored, and managed throughout the application lifecycle. Automated compliance systems provide the scalability and consistency needed to manage this complexity effectively.</p><h2 id=regulatory-framework-implementation>Regulatory Framework Implementation</h2><p>Different regulatory frameworks impose varying requirements on how organizations must handle data, implement security controls, and demonstrate compliance. Cloud-native environments must accommodate multiple regulatory frameworks simultaneously, as applications often process data subject to different regulations based on user location, data type, or business context. This multi-regulatory reality requires compliance systems that can apply appropriate controls dynamically based on data classification and processing context.</p><p>The implementation of regulatory frameworks in cloud environments requires careful mapping of regulatory requirements to technical controls and operational processes. This mapping must account for the shared responsibility model of cloud computing, where certain compliance obligations remain with the organization while others are managed by cloud service providers. Understanding these boundaries is crucial for implementing effective compliance automation that covers all necessary requirements without duplicating efforts or creating gaps in coverage.</p><p>Modern compliance frameworks increasingly recognize the value of automated controls and continuous monitoring approaches. Frameworks like SOC 2 explicitly acknowledge that automated controls can be more effective than manual processes for certain types of compliance requirements. This recognition creates opportunities for organizations to implement compliance automation strategies that not only meet regulatory requirements but also improve operational efficiency and reduce compliance-related risks.</p><p>Here&rsquo;s a comprehensive implementation of automated compliance framework management:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// compliance-automation-framework.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CloudFormationClient</span>, <span style=color:#a6e22e>DescribeStacksCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-cloudformation&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ConfigServiceClient</span>, <span style=color:#a6e22e>GetComplianceDetailsByConfigRuleCommand</span>, <span style=color:#a6e22e>PutConfigRuleCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-config-service&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>S3Client</span>, <span style=color:#a6e22e>GetBucketPolicyCommand</span>, <span style=color:#a6e22e>GetBucketEncryptionCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-s3&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>IAMClient</span>, <span style=color:#a6e22e>ListPoliciesCommand</span>, <span style=color:#a6e22e>GetPolicyVersionCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-iam&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>EC2Client</span>, <span style=color:#a6e22e>DescribeSecurityGroupsCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-ec2&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ComplianceFramework</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>version</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>controls</span>: <span style=color:#66d9ef>ComplianceControl</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>applicability</span>: <span style=color:#66d9ef>ApplicabilityRule</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>reportingRequirements</span>: <span style=color:#66d9ef>ReportingRequirement</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ComplianceControl</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>controlId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>title</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>category</span>: <span style=color:#66d9ef>ControlCategory</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>ComplianceSeverity</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>automationLevel</span>: <span style=color:#66d9ef>AutomationLevel</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>testProcedures</span>: <span style=color:#66d9ef>TestProcedure</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>remediationActions</span>: <span style=color:#66d9ef>RemediationAction</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>TestProcedure</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>procedureId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TestType</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>frequency</span>: <span style=color:#66d9ef>TestFrequency</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>implementation</span>: <span style=color:#66d9ef>TestImplementation</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expectedResult</span>: <span style=color:#66d9ef>ExpectedResult</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ComplianceAssessment</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>frameworkName</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>assessmentId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>Date</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AssessmentScope</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>findings</span>: <span style=color:#66d9ef>ComplianceFinding</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>overallStatus</span>: <span style=color:#66d9ef>ComplianceStatus</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>riskScore</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>nextAssessment</span>: <span style=color:#66d9ef>Date</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>ControlCategory</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ACCESS_CONTROL</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ACCESS_CONTROL&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>DATA_PROTECTION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;DATA_PROTECTION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>NETWORK_SECURITY</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;NETWORK_SECURITY&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>AUDIT_LOGGING</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AUDIT_LOGGING&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>INCIDENT_RESPONSE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;INCIDENT_RESPONSE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>BUSINESS_CONTINUITY</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;BUSINESS_CONTINUITY&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>RISK_MANAGEMENT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;RISK_MANAGEMENT&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>ComplianceSeverity</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CRITICAL</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CRITICAL&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MEDIUM</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LOW&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>AutomationLevel</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>FULLY_AUTOMATED</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;FULLY_AUTOMATED&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PARTIALLY_AUTOMATED</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;PARTIALLY_AUTOMATED&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MANUAL</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MANUAL&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>TestType</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CONFIGURATION_CHECK</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CONFIGURATION_CHECK&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>BEHAVIORAL_TEST</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;BEHAVIORAL_TEST&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>DOCUMENTATION_REVIEW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;DOCUMENTATION_REVIEW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>INTERVIEW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;INTERVIEW&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>TestFrequency</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CONTINUOUS</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CONTINUOUS&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>DAILY</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;DAILY&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>WEEKLY</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;WEEKLY&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MONTHLY</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MONTHLY&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>QUARTERLY</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;QUARTERLY&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ANNUALLY</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ANNUALLY&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>ComplianceStatus</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>COMPLIANT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;COMPLIANT&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>NON_COMPLIANT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;NON_COMPLIANT&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PARTIALLY_COMPLIANT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;PARTIALLY_COMPLIANT&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>NOT_APPLICABLE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;NOT_APPLICABLE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>UNKNOWN</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;UNKNOWN&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ComplianceAutomationFramework</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>cloudFormationClient</span>: <span style=color:#66d9ef>CloudFormationClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>configServiceClient</span>: <span style=color:#66d9ef>ConfigServiceClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>s3Client</span>: <span style=color:#66d9ef>S3Client</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>iamClient</span>: <span style=color:#66d9ef>IAMClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>ec2Client</span>: <span style=color:#66d9ef>EC2Client</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>frameworks</span>: <span style=color:#66d9ef>Map</span>&lt;<span style=color:#f92672>string</span>, <span style=color:#a6e22e>ComplianceFramework</span>&gt;;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cloudFormationClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CloudFormationClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>configServiceClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ConfigServiceClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>s3Client</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>S3Client</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>iamClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>IAMClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>ec2Client</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>EC2Client</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>frameworks</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Map</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initializeFrameworks</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>initializeFrameworks</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Initialize SOC 2 Type II framework
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>frameworks</span>.<span style=color:#66d9ef>set</span>(<span style=color:#e6db74>&#39;SOC2&#39;</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>createSOC2Framework</span>());
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Initialize GDPR framework
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>frameworks</span>.<span style=color:#66d9ef>set</span>(<span style=color:#e6db74>&#39;GDPR&#39;</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>createGDPRFramework</span>());
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Initialize HIPAA framework
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>frameworks</span>.<span style=color:#66d9ef>set</span>(<span style=color:#e6db74>&#39;HIPAA&#39;</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>createHIPAAFramework</span>());
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Initialize PCI DSS framework
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>frameworks</span>.<span style=color:#66d9ef>set</span>(<span style=color:#e6db74>&#39;PCI-DSS&#39;</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>createPCIDSSFramework</span>());
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>runComplianceAssessment</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>frameworkName</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AssessmentScope</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>ComplianceAssessment</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>framework</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>frameworks</span>.<span style=color:#66d9ef>get</span>(<span style=color:#a6e22e>frameworkName</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>framework</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>`Unknown compliance framework: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>frameworkName</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>assessmentId</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateAssessmentId</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>findings</span>: <span style=color:#66d9ef>ComplianceFinding</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Execute automated tests for each control
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>control</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>framework</span>.<span style=color:#a6e22e>controls</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isControlApplicable</span>(<span style=color:#a6e22e>control</span>, <span style=color:#a6e22e>scope</span>)) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>controlFindings</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>assessControl</span>(<span style=color:#a6e22e>control</span>, <span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>controlFindings</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Calculate overall compliance status and risk score
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>overallStatus</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateOverallStatus</span>(<span style=color:#a6e22e>findings</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>riskScore</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateRiskScore</span>(<span style=color:#a6e22e>findings</span>, <span style=color:#a6e22e>framework</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>assessment</span>: <span style=color:#66d9ef>ComplianceAssessment</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>frameworkName</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>assessmentId</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>new</span> Date(),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>scope</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>findings</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>overallStatus</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>riskScore</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>nextAssessment</span>: <span style=color:#66d9ef>this.calculateNextAssessmentDate</span>(<span style=color:#a6e22e>framework</span>, <span style=color:#a6e22e>overallStatus</span>)
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Store assessment results
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>storeAssessmentResults</span>(<span style=color:#a6e22e>assessment</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Trigger remediation for non-compliant findings
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>triggerRemediation</span>(<span style=color:#a6e22e>assessment</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>assessment</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>assessControl</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>control</span>: <span style=color:#66d9ef>ComplianceControl</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AssessmentScope</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>ComplianceFinding</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>findings</span>: <span style=color:#66d9ef>ComplianceFinding</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>testProcedure</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>control</span>.<span style=color:#a6e22e>testProcedures</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>testProcedure</span>.<span style=color:#66d9ef>type</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>TestType</span>.<span style=color:#a6e22e>CONFIGURATION_CHECK</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>procedureFindings</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>executeConfigurationCheck</span>(<span style=color:#a6e22e>testProcedure</span>, <span style=color:#a6e22e>control</span>, <span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>procedureFindings</span>);
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>testProcedure</span>.<span style=color:#66d9ef>type</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>TestType</span>.<span style=color:#a6e22e>BEHAVIORAL_TEST</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>procedureFindings</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>executeBehavioralTest</span>(<span style=color:#a6e22e>testProcedure</span>, <span style=color:#a6e22e>control</span>, <span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>procedureFindings</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>findings</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>executeConfigurationCheck</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>testProcedure</span>: <span style=color:#66d9ef>TestProcedure</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>control</span>: <span style=color:#66d9ef>ComplianceControl</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AssessmentScope</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>ComplianceFinding</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>findings</span>: <span style=color:#66d9ef>ComplianceFinding</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> (<span style=color:#a6e22e>control</span>.<span style=color:#a6e22e>controlId</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;SOC2-CC6.1&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Logical and physical access controls
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>checkAccessControls</span>(<span style=color:#a6e22e>scope</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;SOC2-CC6.7&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Data transmission and disposal
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>checkDataTransmission</span>(<span style=color:#a6e22e>scope</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;GDPR-ART32&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Security of processing
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>checkSecurityOfProcessing</span>(<span style=color:#a6e22e>scope</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;HIPAA-164.312&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Technical safeguards
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>checkTechnicalSafeguards</span>(<span style=color:#a6e22e>scope</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;PCI-DSS-4&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Encrypt transmission of cardholder data
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>checkCardholderDataEncryption</span>(<span style=color:#a6e22e>scope</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>warn</span>(<span style=color:#e6db74>`No implementation for control </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>control</span>.<span style=color:#a6e22e>controlId</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>findings</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>checkAccessControls</span>(<span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AssessmentScope</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>ComplianceFinding</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>findings</span>: <span style=color:#66d9ef>ComplianceFinding</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Check IAM policies for overly permissive access
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>policies</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>iamClient</span>.<span style=color:#a6e22e>send</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ListPoliciesCommand</span>({ <span style=color:#a6e22e>Scope</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Local&#39;</span> }));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>policy</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>policies</span>.<span style=color:#a6e22e>Policies</span> <span style=color:#f92672>||</span> []) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>policy</span>.<span style=color:#a6e22e>Arn</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>policy</span>.<span style=color:#a6e22e>DefaultVersionId</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>policyVersion</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>iamClient</span>.<span style=color:#a6e22e>send</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GetPolicyVersionCommand</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>PolicyArn</span>: <span style=color:#66d9ef>policy.Arn</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>VersionId</span>: <span style=color:#66d9ef>policy.DefaultVersionId</span>
</span></span><span style=display:flex><span>        }));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>policyVersion</span>.<span style=color:#a6e22e>PolicyVersion</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>Document</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>policyDoc</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(decodeURIComponent(<span style=color:#a6e22e>policyVersion</span>.<span style=color:#a6e22e>PolicyVersion</span>.<span style=color:#a6e22e>Document</span>));
</span></span><span style=display:flex><span>          
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>hasOverlyPermissiveActions</span>(<span style=color:#a6e22e>policyDoc</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>controlId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;SOC2-CC6.1&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>findingId</span>: <span style=color:#66d9ef>this.generateFindingId</span>(),
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>status</span>: <span style=color:#66d9ef>ComplianceStatus.NON_COMPLIANT</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>ComplianceSeverity.HIGH</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Overly Permissive IAM Policy&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`IAM policy </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>policy</span>.<span style=color:#a6e22e>PolicyName</span><span style=color:#e6db74>}</span><span style=color:#e6db74> contains overly permissive actions`</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>evidence</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>policyArn</span>: <span style=color:#66d9ef>policy.Arn</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>policyDocument</span>: <span style=color:#66d9ef>policyDoc</span>
</span></span><span style=display:flex><span>              },
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>remediation</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Review and restrict IAM policy permissions to follow principle of least privilege&#39;</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>automatedAction</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;REVIEW_REQUIRED&#39;</span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Check security groups for overly open access
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>securityGroups</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>ec2Client</span>.<span style=color:#a6e22e>send</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>DescribeSecurityGroupsCommand</span>({}));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sg</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>securityGroups</span>.<span style=color:#a6e22e>SecurityGroups</span> <span style=color:#f92672>||</span> []) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>rule</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>sg</span>.<span style=color:#a6e22e>IpPermissions</span> <span style=color:#f92672>||</span> []) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isOverlyPermissiveRule</span>(<span style=color:#a6e22e>rule</span>)) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>controlId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;SOC2-CC6.1&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>findingId</span>: <span style=color:#66d9ef>this.generateFindingId</span>(),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>status</span>: <span style=color:#66d9ef>ComplianceStatus.NON_COMPLIANT</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>ComplianceSeverity.MEDIUM</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Overly Permissive Security Group Rule&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`Security group </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>sg</span>.<span style=color:#a6e22e>GroupName</span><span style=color:#e6db74>}</span><span style=color:#e6db74> has overly permissive inbound rules`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>evidence</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>securityGroupId</span>: <span style=color:#66d9ef>sg.GroupId</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>rule</span>: <span style=color:#66d9ef>rule</span>
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>remediation</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Restrict security group rules to specific IP ranges and ports&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>automatedAction</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AUTO_REMEDIATE&#39;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>findings</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>checkDataTransmission</span>(<span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AssessmentScope</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>ComplianceFinding</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>findings</span>: <span style=color:#66d9ef>ComplianceFinding</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Check S3 buckets for encryption in transit
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// This would typically involve checking CloudFront distributions, load balancers, etc.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>buckets</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>scope</span>.<span style=color:#a6e22e>resources</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>s3Buckets</span> <span style=color:#f92672>||</span> [];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>bucketName</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>buckets</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>bucketPolicy</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>s3Client</span>.<span style=color:#a6e22e>send</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GetBucketPolicyCommand</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Bucket</span>: <span style=color:#66d9ef>bucketName</span>
</span></span><span style=display:flex><span>        }));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>bucketPolicy</span>.<span style=color:#a6e22e>Policy</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>policy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>bucketPolicy</span>.<span style=color:#a6e22e>Policy</span>);
</span></span><span style=display:flex><span>          
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>enforcesTLSOnly</span>(<span style=color:#a6e22e>policy</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>controlId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;SOC2-CC6.7&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>findingId</span>: <span style=color:#66d9ef>this.generateFindingId</span>(),
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>status</span>: <span style=color:#66d9ef>ComplianceStatus.NON_COMPLIANT</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>ComplianceSeverity.HIGH</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;S3 Bucket Does Not Enforce TLS&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`S3 bucket </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>bucketName</span><span style=color:#e6db74>}</span><span style=color:#e6db74> does not enforce TLS-only access`</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>evidence</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>bucketName</span>: <span style=color:#66d9ef>bucketName</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>policy</span>: <span style=color:#66d9ef>policy</span>
</span></span><span style=display:flex><span>              },
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>remediation</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Add bucket policy to deny non-TLS requests&#39;</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>automatedAction</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AUTO_REMEDIATE&#39;</span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// No bucket policy - this itself might be a finding
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>controlId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;SOC2-CC6.7&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>findingId</span>: <span style=color:#66d9ef>this.generateFindingId</span>(),
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>status</span>: <span style=color:#66d9ef>ComplianceStatus.NON_COMPLIANT</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>ComplianceSeverity.MEDIUM</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Missing S3 Bucket Policy&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`S3 bucket </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>bucketName</span><span style=color:#e6db74>}</span><span style=color:#e6db74> has no bucket policy to enforce security requirements`</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>evidence</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>bucketName</span>: <span style=color:#66d9ef>bucketName</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>error</span>: <span style=color:#66d9ef>error.message</span>
</span></span><span style=display:flex><span>          },
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>remediation</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Create bucket policy to enforce TLS and access controls&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>automatedAction</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AUTO_REMEDIATE&#39;</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>findings</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>checkSecurityOfProcessing</span>(<span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>AssessmentScope</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>ComplianceFinding</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>findings</span>: <span style=color:#66d9ef>ComplianceFinding</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// GDPR Article 32 - Security of processing
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// Check for encryption at rest
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>buckets</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>scope</span>.<span style=color:#a6e22e>resources</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>s3Buckets</span> <span style=color:#f92672>||</span> [];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>bucketName</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>buckets</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>encryption</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>s3Client</span>.<span style=color:#a6e22e>send</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GetBucketEncryptionCommand</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Bucket</span>: <span style=color:#66d9ef>bucketName</span>
</span></span><span style=display:flex><span>        }));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>encryption</span>.<span style=color:#a6e22e>ServerSideEncryptionConfiguration</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>Rules</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>length</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>controlId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;GDPR-ART32&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>findingId</span>: <span style=color:#66d9ef>this.generateFindingId</span>(),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>status</span>: <span style=color:#66d9ef>ComplianceStatus.NON_COMPLIANT</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>ComplianceSeverity.HIGH</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;S3 Bucket Not Encrypted&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`S3 bucket </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>bucketName</span><span style=color:#e6db74>}</span><span style=color:#e6db74> does not have encryption at rest enabled`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>evidence</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>bucketName</span>: <span style=color:#66d9ef>bucketName</span>
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>remediation</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Enable default encryption for S3 bucket&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>automatedAction</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AUTO_REMEDIATE&#39;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>controlId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;GDPR-ART32&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>findingId</span>: <span style=color:#66d9ef>this.generateFindingId</span>(),
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>status</span>: <span style=color:#66d9ef>ComplianceStatus.NON_COMPLIANT</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>ComplianceSeverity.HIGH</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;S3 Bucket Encryption Status Unknown&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`Unable to determine encryption status for S3 bucket </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>bucketName</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>evidence</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>bucketName</span>: <span style=color:#66d9ef>bucketName</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>error</span>: <span style=color:#66d9ef>error.message</span>
</span></span><span style=display:flex><span>          },
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>remediation</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Verify and enable encryption for S3 bucket&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>automatedAction</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;REVIEW_REQUIRED&#39;</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>findings</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>createSOC2Framework</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>ComplianceFramework</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;SOC 2 Type II&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>version</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;2017&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>controls</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>controlId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;SOC2-CC6.1&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Logical and Physical Access Controls&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;The entity implements logical and physical access controls to restrict access to system resources&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>category</span>: <span style=color:#66d9ef>ControlCategory.ACCESS_CONTROL</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>ComplianceSeverity.HIGH</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>automationLevel</span>: <span style=color:#66d9ef>AutomationLevel.FULLY_AUTOMATED</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>testProcedures</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>procedureId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;SOC2-CC6.1-001&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TestType</span>.<span style=color:#a6e22e>CONFIGURATION_CHECK</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>frequency</span>: <span style=color:#66d9ef>TestFrequency.CONTINUOUS</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>implementation</span>: <span style=color:#66d9ef>TestImplementation.AUTOMATED_SCAN</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>expectedResult</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;All access controls follow principle of least privilege&#39;</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>criteria</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;No overly permissive IAM policies or security groups&#39;</span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          ],
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>remediationActions</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>actionId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;SOC2-CC6.1-REM-001&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Automatically restrict overly permissive access&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>automationLevel</span>: <span style=color:#66d9ef>AutomationLevel.FULLY_AUTOMATED</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>estimatedEffort</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;LOW&#39;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          ]
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>controlId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;SOC2-CC6.7&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Data Transmission and Disposal&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;The entity restricts the transmission and disposal of confidential information&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>category</span>: <span style=color:#66d9ef>ControlCategory.DATA_PROTECTION</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>ComplianceSeverity.HIGH</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>automationLevel</span>: <span style=color:#66d9ef>AutomationLevel.FULLY_AUTOMATED</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>testProcedures</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>procedureId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;SOC2-CC6.7-001&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TestType</span>.<span style=color:#a6e22e>CONFIGURATION_CHECK</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>frequency</span>: <span style=color:#66d9ef>TestFrequency.CONTINUOUS</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>implementation</span>: <span style=color:#66d9ef>TestImplementation.AUTOMATED_SCAN</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>expectedResult</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;All data transmission uses encryption in transit&#39;</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>criteria</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;TLS enforced for all data transmission endpoints&#39;</span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          ],
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>remediationActions</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>actionId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;SOC2-CC6.7-REM-001&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Automatically enforce TLS for data transmission&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>automationLevel</span>: <span style=color:#66d9ef>AutomationLevel.FULLY_AUTOMATED</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>estimatedEffort</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          ]
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      ],
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>applicability</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>condition</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;organization processes customer data&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>required</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      ],
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>reportingRequirements</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>reportType</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;SOC 2 Type II Report&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>frequency</span>: <span style=color:#66d9ef>TestFrequency.ANNUALLY</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>recipients</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;customers&#39;</span>, <span style=color:#e6db74>&#39;auditors&#39;</span>, <span style=color:#e6db74>&#39;management&#39;</span>]
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      ]
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>createGDPRFramework</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>ComplianceFramework</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;General Data Protection Regulation&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>version</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;2018&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>controls</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>controlId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;GDPR-ART32&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Security of Processing&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Implement appropriate technical and organizational measures to ensure security of processing&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>category</span>: <span style=color:#66d9ef>ControlCategory.DATA_PROTECTION</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>ComplianceSeverity.CRITICAL</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>automationLevel</span>: <span style=color:#66d9ef>AutomationLevel.PARTIALLY_AUTOMATED</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>testProcedures</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>procedureId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;GDPR-ART32-001&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TestType</span>.<span style=color:#a6e22e>CONFIGURATION_CHECK</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>frequency</span>: <span style=color:#66d9ef>TestFrequency.CONTINUOUS</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>implementation</span>: <span style=color:#66d9ef>TestImplementation.AUTOMATED_SCAN</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>expectedResult</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Personal data is encrypted at rest and in transit&#39;</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>criteria</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;All storage and transmission of personal data uses appropriate encryption&#39;</span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          ],
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>remediationActions</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>actionId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;GDPR-ART32-REM-001&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Enable encryption for all personal data storage and transmission&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>automationLevel</span>: <span style=color:#66d9ef>AutomationLevel.PARTIALLY_AUTOMATED</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>estimatedEffort</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          ]
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      ],
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>applicability</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>condition</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;processes personal data of EU residents&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>required</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      ],
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>reportingRequirements</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>reportType</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Data Protection Impact Assessment&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>frequency</span>: <span style=color:#66d9ef>TestFrequency.ANNUALLY</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>recipients</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;data_protection_officer&#39;</span>, <span style=color:#e6db74>&#39;management&#39;</span>]
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      ]
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Helper methods
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>hasOverlyPermissiveActions</span>(<span style=color:#a6e22e>policyDoc</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>policyDoc</span>.<span style=color:#a6e22e>Statement</span>) <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>statements</span> <span style=color:#f92672>=</span> Array.<span style=color:#a6e22e>isArray</span>(<span style=color:#a6e22e>policyDoc</span>.<span style=color:#a6e22e>Statement</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>policyDoc</span>.<span style=color:#a6e22e>Statement</span> <span style=color:#f92672>:</span> [<span style=color:#a6e22e>policyDoc</span>.<span style=color:#a6e22e>Statement</span>];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>statements</span>.<span style=color:#a6e22e>some</span>(<span style=color:#a6e22e>statement</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>statement</span>.<span style=color:#a6e22e>Effect</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;Allow&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>actions</span> <span style=color:#f92672>=</span> Array.<span style=color:#a6e22e>isArray</span>(<span style=color:#a6e22e>statement</span>.<span style=color:#a6e22e>Action</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>statement</span>.<span style=color:#a6e22e>Action</span> <span style=color:#f92672>:</span> [<span style=color:#a6e22e>statement</span>.<span style=color:#a6e22e>Action</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>actions</span>.<span style=color:#a6e22e>some</span>(<span style=color:#a6e22e>action</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>action</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;*&#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>action</span>.<span style=color:#a6e22e>endsWith</span>(<span style=color:#e6db74>&#39;:*&#39;</span>));
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>isOverlyPermissiveRule</span>(<span style=color:#a6e22e>rule</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Check if rule allows access from anywhere (0.0.0.0/0) on sensitive ports
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sensitivePorts</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>22</span>, <span style=color:#ae81ff>3389</span>, <span style=color:#ae81ff>1433</span>, <span style=color:#ae81ff>3306</span>, <span style=color:#ae81ff>5432</span>, <span style=color:#ae81ff>6379</span>, <span style=color:#ae81ff>27017</span>];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>rule</span>.<span style=color:#a6e22e>IpRanges</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>some</span>((<span style=color:#a6e22e>range</span>: <span style=color:#66d9ef>any</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>range</span>.<span style=color:#a6e22e>CidrIp</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;0.0.0.0/0&#39;</span>)) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>rule</span>.<span style=color:#a6e22e>FromPort</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>sensitivePorts</span>.<span style=color:#a6e22e>includes</span>(<span style=color:#a6e22e>rule</span>.<span style=color:#a6e22e>FromPort</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>enforcesTLSOnly</span>(<span style=color:#a6e22e>policy</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>policy</span>.<span style=color:#a6e22e>Statement</span>) <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>statements</span> <span style=color:#f92672>=</span> Array.<span style=color:#a6e22e>isArray</span>(<span style=color:#a6e22e>policy</span>.<span style=color:#a6e22e>Statement</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>policy</span>.<span style=color:#a6e22e>Statement</span> <span style=color:#f92672>:</span> [<span style=color:#a6e22e>policy</span>.<span style=color:#a6e22e>Statement</span>];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>statements</span>.<span style=color:#a6e22e>some</span>(<span style=color:#a6e22e>statement</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>statement</span>.<span style=color:#a6e22e>Effect</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;Deny&#39;</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>             <span style=color:#a6e22e>statement</span>.<span style=color:#a6e22e>Condition</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>Bool</span><span style=color:#f92672>?</span>.[<span style=color:#e6db74>&#39;aws:SecureTransport&#39;</span>] <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;false&#39;</span>;
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>calculateOverallStatus</span>(<span style=color:#a6e22e>findings</span>: <span style=color:#66d9ef>ComplianceFinding</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>ComplianceStatus</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>criticalFindings</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>filter</span>(<span style=color:#a6e22e>f</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>severity</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>ComplianceSeverity</span>.<span style=color:#a6e22e>CRITICAL</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>nonCompliantFindings</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>filter</span>(<span style=color:#a6e22e>f</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>f</span>.<span style=color:#a6e22e>status</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>ComplianceStatus</span>.<span style=color:#a6e22e>NON_COMPLIANT</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>criticalFindings</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>nonCompliantFindings</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.2</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ComplianceStatus</span>.<span style=color:#a6e22e>NON_COMPLIANT</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>nonCompliantFindings</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ComplianceStatus</span>.<span style=color:#a6e22e>PARTIALLY_COMPLIANT</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ComplianceStatus</span>.<span style=color:#a6e22e>COMPLIANT</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>calculateRiskScore</span>(<span style=color:#a6e22e>findings</span>: <span style=color:#66d9ef>ComplianceFinding</span>[], <span style=color:#a6e22e>framework</span>: <span style=color:#66d9ef>ComplianceFramework</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>severityWeights</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ComplianceSeverity</span>.<span style=color:#a6e22e>CRITICAL</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>25</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ComplianceSeverity</span>.<span style=color:#a6e22e>HIGH</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>15</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ComplianceSeverity</span>.<span style=color:#a6e22e>MEDIUM</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>8</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ComplianceSeverity</span>.<span style=color:#a6e22e>LOW</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>totalRisk</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>total</span>, <span style=color:#a6e22e>finding</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>total</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>severityWeights</span>[<span style=color:#a6e22e>finding</span>.<span style=color:#a6e22e>severity</span>] <span style=color:#f92672>||</span> <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    }, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> Math.<span style=color:#a6e22e>min</span>(<span style=color:#ae81ff>100</span>, <span style=color:#a6e22e>totalRisk</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>generateAssessmentId</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>`COMP-</span><span style=color:#e6db74>${</span>Date.<span style=color:#a6e22e>now</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span>Math.<span style=color:#a6e22e>random</span>().<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>36</span>).<span style=color:#a6e22e>substr</span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>9</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>generateFindingId</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>`FIND-</span><span style=color:#e6db74>${</span>Date.<span style=color:#a6e22e>now</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span>Math.<span style=color:#a6e22e>random</span>().<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>36</span>).<span style=color:#a6e22e>substr</span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>9</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Additional helper methods and type definitions would continue...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Supporting types and interfaces
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ApplicabilityRule</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>condition</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>required</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ReportingRequirement</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>reportType</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>frequency</span>: <span style=color:#66d9ef>TestFrequency</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>recipients</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>TestImplementation</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>AUTOMATED_SCAN</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AUTOMATED_SCAN&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MANUAL_REVIEW</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;MANUAL_REVIEW&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>HYBRID</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;HYBRID&#39;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ExpectedResult</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>criteria</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>RemediationAction</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>actionId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>automationLevel</span>: <span style=color:#66d9ef>AutomationLevel</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>estimatedEffort</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;LOW&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AssessmentScope</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>environment</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>regions</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resources</span><span style=color:#f92672>?:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>s3Buckets?</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lambdaFunctions?</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>databases?</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>networks?</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dataClassifications</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ComplianceFinding</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>controlId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>findingId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>status</span>: <span style=color:#66d9ef>ComplianceStatus</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>ComplianceSeverity</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>title</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>evidence</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>string</span>, <span style=color:#a6e22e>any</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>remediation</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>automatedAction</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AUTO_REMEDIATE&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;REVIEW_REQUIRED&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;MANUAL_ACTION&#39;</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>TestImplementation</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>AUTOMATED_SCAN</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AUTOMATED_SCAN&#39;</span> <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>const</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MANUAL_REVIEW</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;MANUAL_REVIEW&#39;</span> <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>const</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>HYBRID</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;HYBRID&#39;</span> <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>const</span>
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><div class=plantuml-container><img id=plantuml- class=plantuml-diagram>
<a id=plantuml-link- href=# target=_blank class=plantuml-link title="Open diagram in new window"><span class=plantuml-link-icon>🔍</span></a></div><script src=/js/rawdeflate.js></script><script>function encode64(e){r="";for(i=0;i<e.length;i+=3)i+2==e.length?r+=append3bytes(e.charCodeAt(i),e.charCodeAt(i+1),0):i+1==e.length?r+=append3bytes(e.charCodeAt(i),0,0):r+=append3bytes(e.charCodeAt(i),e.charCodeAt(i+1),e.charCodeAt(i+2));return r}function append3bytes(e,t,n){return c1=e>>2,c2=(e&3)<<4|t>>4,c3=(t&15)<<2|n>>6,c4=n&63,r="",r+=encode6bit(c1&63),r+=encode6bit(c2&63),r+=encode6bit(c3&63),r+=encode6bit(c4&63),r}function encode6bit(e){return e<10?String.fromCharCode(48+e):(e-=10,e<26?String.fromCharCode(65+e):(e-=26,e<26?String.fromCharCode(97+e):(e-=26,e==0?"-":e==1?"_":"?")))}var deflater=window.SharedWorker&&new SharedWorker("/js/rawdeflate.js");deflater?(deflater.port.addEventListener("message",done_deflating,!1),deflater.port.start()):window.Worker&&(deflater=new Worker("/js/rawdeflate.js"),deflater.onmessage=done_deflating);function done_deflating(e){const s=document.getElementById("plantuml-"),t="https://www.plantuml.com/plantuml/img/"+encode64(e.data);s.src=t;const n=document.getElementById("plantuml-link-");n&&(n.href=t)}function compress(e){e=unescape(encodeURIComponent(e)),deflater?deflater.port&&deflater.port.postMessage?deflater.port.postMessage(e):deflater.postMessage(e):setTimeout(function(){done_deflating({data:deflate(e)})},100)}compress(`
@startuml
!define ICONURL https://raw.githubusercontent.com/tupadr3/plantuml-icon-font-sprites/v2.4.0
!includeurl ICONURL/common.puml
!includeurl ICONURL/font-awesome-5/check-circle.puml
!includeurl ICONURL/font-awesome-5/exclamation-triangle.puml
!includeurl ICONURL/aws/ManagementAndGovernance/aws-config.puml

title Continuous Compliance Architecture

participant "Development Team" as dev
participant "CI/CD Pipeline" as pipeline
participant "Compliance Scanner" as scanner
participant "Policy Engine" as policy
participant "Remediation Service" as remediation
participant "Audit Dashboard" as dashboard

dev -> pipeline: Deploy Application
activate pipeline

pipeline -> scanner: Trigger Compliance Check
activate scanner

scanner -> policy: Evaluate Against Frameworks
activate policy

policy -> policy: Apply SOC2 Controls
policy -> policy: Apply GDPR Controls  
policy -> policy: Apply HIPAA Controls
policy -> policy: Apply PCI-DSS Controls

policy -> scanner: Compliance Results
deactivate policy

alt Non-Compliant Findings
    scanner -> remediation: Auto-Remediate
    activate remediation
    remediation -> remediation: Apply Fixes
    remediation -> scanner: Remediation Complete
    deactivate remediation
    
    scanner -> pipeline: Re-scan After Remediation
else Compliant
    scanner -> pipeline: Compliance Passed
end

scanner -> dashboard: Update Compliance Status
pipeline -> dev: Deployment Result

deactivate scanner
deactivate pipeline

@enduml
`)</script><h2 id=automated-evidence-collection>Automated Evidence Collection</h2><p>The traditional approach to compliance evidence collection involves manual documentation processes that are time-consuming, error-prone, and difficult to maintain at scale. In cloud-native environments where infrastructure and configurations change frequently, manual evidence collection becomes practically impossible while still maintaining accuracy and completeness. Automated evidence collection systems must capture the right information at the right time while ensuring that evidence integrity is maintained throughout the collection and storage process.</p><p>Effective automated evidence collection requires understanding the specific evidence requirements for each compliance framework and control. Different regulations require different types of evidence, ranging from configuration snapshots and log files to procedural documentation and management attestations. The automation system must be capable of collecting diverse evidence types while maintaining appropriate metadata and chain of custody information that auditors require to assess the validity and reliability of the evidence.</p><p>The challenge of evidence collection in dynamic environments extends beyond simply capturing snapshots of current configurations. Compliance frameworks often require evidence of controls operating effectively over time, which means the automation system must capture historical data, track changes, and maintain audit trails that demonstrate continuous compliance rather than point-in-time compliance. This temporal aspect of evidence collection requires sophisticated data management and correlation capabilities.</p><p>Here&rsquo;s an implementation of comprehensive automated evidence collection:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// evidence-collection-service.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>S3Client</span>, <span style=color:#a6e22e>PutObjectCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-s3&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CloudTrailClient</span>, <span style=color:#a6e22e>LookupEventsCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-cloudtrail&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>EC2Client</span>, <span style=color:#a6e22e>DescribeInstancesCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-ec2&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>RDSClient</span>, <span style=color:#a6e22e>DescribeDBInstancesCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-rds&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CloudWatchLogsClient</span>, <span style=color:#a6e22e>DescribeLogGroupsCommand</span>, <span style=color:#a6e22e>FilterLogEventsCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-cloudwatch-logs&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>crypto</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;crypto&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>EvidencePackage</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>packageId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>complianceFramework</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>controlId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>collectionTimestamp</span>: <span style=color:#66d9ef>Date</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>validityPeriod</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>startDate</span>: <span style=color:#66d9ef>Date</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>endDate</span>: <span style=color:#66d9ef>Date</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>evidenceItems</span>: <span style=color:#66d9ef>EvidenceItem</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>integrity</span>: <span style=color:#66d9ef>EvidenceIntegrity</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>metadata</span>: <span style=color:#66d9ef>EvidenceMetadata</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>EvidenceItem</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>itemId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>itemType</span>: <span style=color:#66d9ef>EvidenceType</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>title</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>source</span>: <span style=color:#66d9ef>EvidenceSource</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>collectionMethod</span>: <span style=color:#66d9ef>CollectionMethod</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>content</span>: <span style=color:#66d9ef>EvidenceContent</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>digitalSignature</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>Date</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>EvidenceContent</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>data</span>: <span style=color:#66d9ef>any</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>format</span>: <span style=color:#66d9ef>ContentFormat</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>encoding</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>checksum</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>size</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>EvidenceIntegrity</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>packageHash</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>digitalSignature</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>witnessedBy</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>tamperEvident</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>verificationResults</span>: <span style=color:#66d9ef>VerificationResult</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>EvidenceType</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CONFIGURATION_SNAPSHOT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CONFIGURATION_SNAPSHOT&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LOG_EXTRACT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LOG_EXTRACT&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>AUDIT_TRAIL</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AUDIT_TRAIL&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>POLICY_DOCUMENT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;POLICY_DOCUMENT&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>SCREENSHOT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;SCREENSHOT&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>TEST_RESULT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;TEST_RESULT&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PROCEDURAL_DOCUMENTATION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;PROCEDURAL_DOCUMENTATION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MANAGEMENT_ATTESTATION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MANAGEMENT_ATTESTATION&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>CollectionMethod</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>AUTOMATED_API</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AUTOMATED_API&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>AUTOMATED_SCAN</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AUTOMATED_SCAN&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MANUAL_COLLECTION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MANUAL_COLLECTION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CONTINUOUS_MONITORING</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CONTINUOUS_MONITORING&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>ContentFormat</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>JSON</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;JSON&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>XML</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;XML&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PDF</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;PDF&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CSV</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CSV&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PNG</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;PNG&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>TXT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;TXT&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>EvidenceCollectionService</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>s3Client</span>: <span style=color:#66d9ef>S3Client</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>cloudTrailClient</span>: <span style=color:#66d9ef>CloudTrailClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>ec2Client</span>: <span style=color:#66d9ef>EC2Client</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>rdsClient</span>: <span style=color:#66d9ef>RDSClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>cloudWatchClient</span>: <span style=color:#66d9ef>CloudWatchLogsClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>evidenceBucket</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>(<span style=color:#a6e22e>evidenceBucket</span>: <span style=color:#66d9ef>string</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>s3Client</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>S3Client</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cloudTrailClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CloudTrailClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>ec2Client</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>EC2Client</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rdsClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>RDSClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cloudWatchClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CloudWatchLogsClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>evidenceBucket</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>evidenceBucket</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>collectEvidenceForControl</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>complianceFramework</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>controlId</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>EvidenceScope</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>EvidencePackage</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>packageId</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generatePackageId</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>evidenceItems</span>: <span style=color:#66d9ef>EvidenceItem</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Collect configuration evidence
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>configurationEvidence</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>collectConfigurationEvidence</span>(<span style=color:#a6e22e>controlId</span>, <span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>configurationEvidence</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Collect audit trail evidence
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>auditTrailEvidence</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>collectAuditTrailEvidence</span>(<span style=color:#a6e22e>controlId</span>, <span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>auditTrailEvidence</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Collect operational evidence
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>operationalEvidence</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>collectOperationalEvidence</span>(<span style=color:#a6e22e>controlId</span>, <span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>operationalEvidence</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Collect policy evidence
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>policyEvidence</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>collectPolicyEvidence</span>(<span style=color:#a6e22e>controlId</span>, <span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>policyEvidence</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Create evidence package
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>evidencePackage</span>: <span style=color:#66d9ef>EvidencePackage</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>packageId</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>complianceFramework</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>controlId</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>collectionTimestamp</span>: <span style=color:#66d9ef>new</span> Date(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>validityPeriod</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>startDate</span>: <span style=color:#66d9ef>scope.startDate</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>endDate</span>: <span style=color:#66d9ef>scope.endDate</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>evidenceItems</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>integrity</span>: <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateIntegrityData</span>(<span style=color:#a6e22e>evidenceItems</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>metadata</span>: <span style=color:#66d9ef>this.generateMetadata</span>(<span style=color:#a6e22e>controlId</span>, <span style=color:#a6e22e>scope</span>)
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Store evidence package
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>storeEvidencePackage</span>(<span style=color:#a6e22e>evidencePackage</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Verify evidence integrity
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>verifyEvidenceIntegrity</span>(<span style=color:#a6e22e>evidencePackage</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>evidencePackage</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>`Failed to collect evidence for control </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>controlId</span><span style=color:#e6db74>}</span><span style=color:#e6db74>:`</span>, <span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>collectConfigurationEvidence</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>controlId</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>EvidenceScope</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>EvidenceItem</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>evidenceItems</span>: <span style=color:#66d9ef>EvidenceItem</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> (<span style=color:#a6e22e>controlId</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;SOC2-CC6.1&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Collect IAM configuration evidence
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>collectIAMEvidence</span>(<span style=color:#a6e22e>scope</span>));
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>collectNetworkEvidence</span>(<span style=color:#a6e22e>scope</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;SOC2-CC6.7&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Collect encryption configuration evidence
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>collectEncryptionEvidence</span>(<span style=color:#a6e22e>scope</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;GDPR-ART32&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Collect data protection evidence
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>collectDataProtectionEvidence</span>(<span style=color:#a6e22e>scope</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;HIPAA-164.312&#39;</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Collect technical safeguards evidence
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>collectTechnicalSafeguardsEvidence</span>(<span style=color:#a6e22e>scope</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>evidenceItems</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>collectIAMEvidence</span>(<span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>EvidenceScope</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>EvidenceItem</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>evidenceItems</span>: <span style=color:#66d9ef>EvidenceItem</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Collect IAM user configurations
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>iamUsers</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getIAMUsers</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>itemId</span>: <span style=color:#66d9ef>this.generateItemId</span>(),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>itemType</span>: <span style=color:#66d9ef>EvidenceType.CONFIGURATION_SNAPSHOT</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;IAM Users Configuration&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Snapshot of all IAM users and their configurations&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>source</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>system</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AWS IAM&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>account</span>: <span style=color:#66d9ef>scope.awsAccountId</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>region</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;global&#39;</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>collectionMethod</span>: <span style=color:#66d9ef>CollectionMethod.AUTOMATED_API</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>content</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>data</span>: <span style=color:#66d9ef>iamUsers</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>format</span>: <span style=color:#66d9ef>ContentFormat.JSON</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>encoding</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;utf-8&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>checksum</span>: <span style=color:#66d9ef>this.calculateChecksum</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>iamUsers</span>)),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>size</span>: <span style=color:#66d9ef>JSON.stringify</span>(<span style=color:#a6e22e>iamUsers</span>).<span style=color:#a6e22e>length</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>digitalSignature</span>: <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>signContent</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>iamUsers</span>)),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>new</span> Date()
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Collect IAM policies
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>iamPolicies</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getIAMPolicies</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>itemId</span>: <span style=color:#66d9ef>this.generateItemId</span>(),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>itemType</span>: <span style=color:#66d9ef>EvidenceType.CONFIGURATION_SNAPSHOT</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;IAM Policies Configuration&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Snapshot of all custom IAM policies&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>source</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>system</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AWS IAM&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>account</span>: <span style=color:#66d9ef>scope.awsAccountId</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>region</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;global&#39;</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>collectionMethod</span>: <span style=color:#66d9ef>CollectionMethod.AUTOMATED_API</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>content</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>data</span>: <span style=color:#66d9ef>iamPolicies</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>format</span>: <span style=color:#66d9ef>ContentFormat.JSON</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>encoding</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;utf-8&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>checksum</span>: <span style=color:#66d9ef>this.calculateChecksum</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>iamPolicies</span>)),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>size</span>: <span style=color:#66d9ef>JSON.stringify</span>(<span style=color:#a6e22e>iamPolicies</span>).<span style=color:#a6e22e>length</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>digitalSignature</span>: <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>signContent</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>iamPolicies</span>)),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>new</span> Date()
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>evidenceItems</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>collectAuditTrailEvidence</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>controlId</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>EvidenceScope</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>EvidenceItem</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>evidenceItems</span>: <span style=color:#66d9ef>EvidenceItem</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Collect CloudTrail events relevant to the control
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>cloudTrailEvents</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getCloudTrailEvents</span>(<span style=color:#a6e22e>controlId</span>, <span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>itemId</span>: <span style=color:#66d9ef>this.generateItemId</span>(),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>itemType</span>: <span style=color:#66d9ef>EvidenceType.AUDIT_TRAIL</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;CloudTrail Audit Events&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`CloudTrail events relevant to control </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>controlId</span><span style=color:#e6db74>}</span><span style=color:#e6db74> for the specified time period`</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>source</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>system</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AWS CloudTrail&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>account</span>: <span style=color:#66d9ef>scope.awsAccountId</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>region</span>: <span style=color:#66d9ef>scope.region</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>collectionMethod</span>: <span style=color:#66d9ef>CollectionMethod.AUTOMATED_API</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>content</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>data</span>: <span style=color:#66d9ef>cloudTrailEvents</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>format</span>: <span style=color:#66d9ef>ContentFormat.JSON</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>encoding</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;utf-8&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>checksum</span>: <span style=color:#66d9ef>this.calculateChecksum</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>cloudTrailEvents</span>)),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>size</span>: <span style=color:#66d9ef>JSON.stringify</span>(<span style=color:#a6e22e>cloudTrailEvents</span>).<span style=color:#a6e22e>length</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>digitalSignature</span>: <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>signContent</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>cloudTrailEvents</span>)),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>new</span> Date()
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>evidenceItems</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>collectOperationalEvidence</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>controlId</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>EvidenceScope</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>EvidenceItem</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>evidenceItems</span>: <span style=color:#66d9ef>EvidenceItem</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Collect relevant log data
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>logEvents</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getRelevantLogEvents</span>(<span style=color:#a6e22e>controlId</span>, <span style=color:#a6e22e>scope</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>logEvents</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>itemId</span>: <span style=color:#66d9ef>this.generateItemId</span>(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>itemType</span>: <span style=color:#66d9ef>EvidenceType.LOG_EXTRACT</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Operational Log Events&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`Log events demonstrating control operation for </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>controlId</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>source</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>system</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AWS CloudWatch Logs&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>account</span>: <span style=color:#66d9ef>scope.awsAccountId</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>region</span>: <span style=color:#66d9ef>scope.region</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>collectionMethod</span>: <span style=color:#66d9ef>CollectionMethod.AUTOMATED_SCAN</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>content</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>data</span>: <span style=color:#66d9ef>logEvents</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>format</span>: <span style=color:#66d9ef>ContentFormat.JSON</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>encoding</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;utf-8&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>checksum</span>: <span style=color:#66d9ef>this.calculateChecksum</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>logEvents</span>)),
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>size</span>: <span style=color:#66d9ef>JSON.stringify</span>(<span style=color:#a6e22e>logEvents</span>).<span style=color:#a6e22e>length</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>digitalSignature</span>: <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>signContent</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>logEvents</span>)),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>new</span> Date()
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>evidenceItems</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>collectPolicyEvidence</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>controlId</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>EvidenceScope</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>EvidenceItem</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>evidenceItems</span>: <span style=color:#66d9ef>EvidenceItem</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Collect organizational policies relevant to the control
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>organizationalPolicies</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getOrganizationalPolicies</span>(<span style=color:#a6e22e>controlId</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>policy</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>organizationalPolicies</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>itemId</span>: <span style=color:#66d9ef>this.generateItemId</span>(),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>itemType</span>: <span style=color:#66d9ef>EvidenceType.POLICY_DOCUMENT</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span>: <span style=color:#66d9ef>policy.title</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`Organizational policy supporting control </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>controlId</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>source</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>system</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Policy Management System&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>account</span>: <span style=color:#66d9ef>scope.awsAccountId</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>region</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;global&#39;</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>collectionMethod</span>: <span style=color:#66d9ef>CollectionMethod.MANUAL_COLLECTION</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>content</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>data</span>: <span style=color:#66d9ef>policy</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>format</span>: <span style=color:#66d9ef>ContentFormat.PDF</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>encoding</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;base64&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>checksum</span>: <span style=color:#66d9ef>this.calculateChecksum</span>(<span style=color:#a6e22e>policy</span>.<span style=color:#a6e22e>content</span>),
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>size</span>: <span style=color:#66d9ef>policy.content.length</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>digitalSignature</span>: <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>signContent</span>(<span style=color:#a6e22e>policy</span>.<span style=color:#a6e22e>content</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>new</span> Date()
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>evidenceItems</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>storeEvidencePackage</span>(<span style=color:#a6e22e>evidencePackage</span>: <span style=color:#66d9ef>EvidencePackage</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>key</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`evidence-packages/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>evidencePackage</span>.<span style=color:#a6e22e>complianceFramework</span><span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>evidencePackage</span>.<span style=color:#a6e22e>controlId</span><span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>evidencePackage</span>.<span style=color:#a6e22e>packageId</span><span style=color:#e6db74>}</span><span style=color:#e6db74>.json`</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>command</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PutObjectCommand</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Bucket</span>: <span style=color:#66d9ef>this.evidenceBucket</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Key</span>: <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Body</span>: <span style=color:#66d9ef>JSON.stringify</span>(<span style=color:#a6e22e>evidencePackage</span>, <span style=color:#66d9ef>null</span>, <span style=color:#ae81ff>2</span>),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>ContentType</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;application/json&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Metadata</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;compliance-framework&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>evidencePackage</span>.<span style=color:#a6e22e>complianceFramework</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;control-id&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>evidencePackage</span>.<span style=color:#a6e22e>controlId</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;package-id&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>evidencePackage</span>.<span style=color:#a6e22e>packageId</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;collection-timestamp&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>evidencePackage</span>.<span style=color:#a6e22e>collectionTimestamp</span>.<span style=color:#a6e22e>toISOString</span>()
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>ServerSideEncryption</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;aws:kms&#39;</span>
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>s3Client</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>command</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Store individual evidence items
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>item</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>evidencePackage</span>.<span style=color:#a6e22e>evidenceItems</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>storeEvidenceItem</span>(<span style=color:#a6e22e>evidencePackage</span>, <span style=color:#a6e22e>item</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>storeEvidenceItem</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>evidencePackage</span>: <span style=color:#66d9ef>EvidencePackage</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>item</span>: <span style=color:#66d9ef>EvidenceItem</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>key</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`evidence-items/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>evidencePackage</span>.<span style=color:#a6e22e>packageId</span><span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>itemId</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>command</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PutObjectCommand</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Bucket</span>: <span style=color:#66d9ef>this.evidenceBucket</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Key</span>: <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Body</span>: <span style=color:#66d9ef>JSON.stringify</span>(<span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>content</span>.<span style=color:#a6e22e>data</span>),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>ContentType</span>: <span style=color:#66d9ef>this.getContentType</span>(<span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>content</span>.<span style=color:#a6e22e>format</span>),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Metadata</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;item-id&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>itemId</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;item-type&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>itemType</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;package-id&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>evidencePackage</span>.<span style=color:#a6e22e>packageId</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;digital-signature&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>digitalSignature</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;checksum&#39;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>content</span>.<span style=color:#a6e22e>checksum</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>ServerSideEncryption</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;aws:kms&#39;</span>
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>s3Client</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>command</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>generateIntegrityData</span>(<span style=color:#a6e22e>evidenceItems</span>: <span style=color:#66d9ef>EvidenceItem</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>EvidenceIntegrity</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>packageContent</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>evidenceItems</span>.<span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>item</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>content</span>.<span style=color:#a6e22e>checksum</span>).<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;|&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>packageHash</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateChecksum</span>(<span style=color:#a6e22e>packageContent</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>digitalSignature</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>signContent</span>(<span style=color:#a6e22e>packageContent</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>packageHash</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>digitalSignature</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>witnessedBy</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;evidence-collection-service&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>tamperEvident</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>verificationResults</span><span style=color:#f92672>:</span> []
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>generateMetadata</span>(<span style=color:#a6e22e>controlId</span>: <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>EvidenceScope</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>EvidenceMetadata</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>collector</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;automated-evidence-service&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>collectionVersion</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;1.0.0&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>controlId</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>scope</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>retentionPeriod</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;7years&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>accessControls</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>viewPermissions</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;auditor&#39;</span>, <span style=color:#e6db74>&#39;compliance-officer&#39;</span>],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>modifyPermissions</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;system-admin&#39;</span>],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>deletePermissions</span><span style=color:#f92672>:</span> []
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Helper methods
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>getCloudTrailEvents</span>(<span style=color:#a6e22e>controlId</span>: <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>EvidenceScope</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>any</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>eventNames</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getRelevantEventNames</span>(<span style=color:#a6e22e>controlId</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>events</span>: <span style=color:#66d9ef>any</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>eventName</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>eventNames</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>command</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>LookupEventsCommand</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>LookupAttributes</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>AttributeKey</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;EventName&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>AttributeValue</span>: <span style=color:#66d9ef>eventName</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>StartTime</span>: <span style=color:#66d9ef>scope.startDate</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>EndTime</span>: <span style=color:#66d9ef>scope.endDate</span>
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cloudTrailClient</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>command</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>Events</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>events</span>.<span style=color:#a6e22e>push</span>(...<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>Events</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>events</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>getRelevantEventNames</span>(<span style=color:#a6e22e>controlId</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>[] {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>eventMappings</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;SOC2-CC6.1&#39;</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;CreateUser&#39;</span>, <span style=color:#e6db74>&#39;DeleteUser&#39;</span>, <span style=color:#e6db74>&#39;AttachUserPolicy&#39;</span>, <span style=color:#e6db74>&#39;DetachUserPolicy&#39;</span>],
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;SOC2-CC6.7&#39;</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;PutBucketEncryption&#39;</span>, <span style=color:#e6db74>&#39;PutBucketPolicy&#39;</span>, <span style=color:#e6db74>&#39;CreateBucket&#39;</span>],
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;GDPR-ART32&#39;</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;PutBucketEncryption&#39;</span>, <span style=color:#e6db74>&#39;PutBucketPolicy&#39;</span>, <span style=color:#e6db74>&#39;CreateDBInstance&#39;</span>],
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;HIPAA-164.312&#39;</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;PutBucketEncryption&#39;</span>, <span style=color:#e6db74>&#39;ModifyDBInstance&#39;</span>, <span style=color:#e6db74>&#39;CreateSecurityGroup&#39;</span>]
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>eventMappings</span>[<span style=color:#a6e22e>controlId</span>] <span style=color:#f92672>||</span> [];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>calculateChecksum</span>(<span style=color:#a6e22e>content</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>crypto</span>.<span style=color:#a6e22e>createHash</span>(<span style=color:#e6db74>&#39;sha256&#39;</span>).<span style=color:#a6e22e>update</span>(<span style=color:#a6e22e>content</span>).<span style=color:#a6e22e>digest</span>(<span style=color:#e6db74>&#39;hex&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>signContent</span>(<span style=color:#a6e22e>content</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>string</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// In a real implementation, this would use a proper digital signature
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// with a private key managed by AWS KMS or HSM
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>crypto</span>.<span style=color:#a6e22e>createHmac</span>(<span style=color:#e6db74>&#39;sha256&#39;</span>, <span style=color:#e6db74>&#39;evidence-signing-key&#39;</span>).<span style=color:#a6e22e>update</span>(<span style=color:#a6e22e>content</span>).<span style=color:#a6e22e>digest</span>(<span style=color:#e6db74>&#39;hex&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>generatePackageId</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>`EVP-</span><span style=color:#e6db74>${</span>Date.<span style=color:#a6e22e>now</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>crypto</span>.<span style=color:#a6e22e>randomUUID</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>generateItemId</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>`EVI-</span><span style=color:#e6db74>${</span>Date.<span style=color:#a6e22e>now</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>crypto</span>.<span style=color:#a6e22e>randomUUID</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>getContentType</span>(<span style=color:#a6e22e>format</span>: <span style=color:#66d9ef>ContentFormat</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>contentTypes</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ContentFormat</span>.<span style=color:#a6e22e>JSON</span>]<span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;application/json&#39;</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ContentFormat</span>.<span style=color:#a6e22e>XML</span>]<span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;application/xml&#39;</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ContentFormat</span>.<span style=color:#a6e22e>PDF</span>]<span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;application/pdf&#39;</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ContentFormat</span>.<span style=color:#a6e22e>CSV</span>]<span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;text/csv&#39;</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ContentFormat</span>.<span style=color:#a6e22e>PNG</span>]<span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;image/png&#39;</span>,
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>ContentFormat</span>.<span style=color:#a6e22e>TXT</span>]<span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;text/plain&#39;</span>
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>contentTypes</span>[<span style=color:#a6e22e>format</span>] <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;application/octet-stream&#39;</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Placeholder methods for data collection - would be implemented based on specific requirements
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>getIAMUsers</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>any</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>getIAMPolicies</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>any</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>getRelevantLogEvents</span>(<span style=color:#a6e22e>controlId</span>: <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>EvidenceScope</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>any</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>getOrganizationalPolicies</span>(<span style=color:#a6e22e>controlId</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>any</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; { <span style=color:#66d9ef>return</span> []; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>verifyEvidenceIntegrity</span>(<span style=color:#a6e22e>evidencePackage</span>: <span style=color:#66d9ef>EvidencePackage</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Supporting interfaces
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>EvidenceScope</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>awsAccountId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>region</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>startDate</span>: <span style=color:#66d9ef>Date</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>endDate</span>: <span style=color:#66d9ef>Date</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resourceTypes</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dataClassifications</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>EvidenceSource</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>system</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>account</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>region</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>EvidenceMetadata</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>collector</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>collectionVersion</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>controlId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>scope</span>: <span style=color:#66d9ef>EvidenceScope</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>retentionPeriod</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>accessControls</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>viewPermissions</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>modifyPermissions</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>deletePermissions</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>VerificationResult</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>verificationId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>verificationTime</span>: <span style=color:#66d9ef>Date</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>verifier</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>result</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;PASSED&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;FAILED&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>details</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=compliance-reporting-and-analytics>Compliance Reporting and Analytics</h2><p>Modern compliance reporting must transition from static, point-in-time reports to dynamic, real-time dashboards that provide continuous visibility into compliance posture while supporting both internal management needs and external audit requirements. The challenge lies in creating reporting systems that can aggregate compliance data from multiple sources, frameworks, and time periods while maintaining the detail and traceability that auditors require for their assessments.</p><p>Effective compliance analytics goes beyond simple pass/fail reporting to provide insights into compliance trends, risk patterns, and operational effectiveness. These analytics capabilities enable organizations to identify potential compliance issues before they become violations and to optimize their compliance processes based on data-driven insights. The goal is to transform compliance from a reactive function into a proactive capability that supports business objectives while maintaining regulatory adherence.</p><p>The integration of compliance reporting with broader business intelligence and risk management systems creates opportunities for more sophisticated analysis and decision-making. When compliance data is viewed in context with operational metrics, security events, and business performance indicators, organizations can better understand the relationship between compliance investments and business outcomes, enabling more informed strategic decisions about compliance priorities and resource allocation.</p><div class=plantuml-container><img id=plantuml- class=plantuml-diagram>
<a id=plantuml-link- href=# target=_blank class=plantuml-link title="Open diagram in new window"><span class=plantuml-link-icon>🔍</span></a></div><script src=/js/rawdeflate.js></script><script>function encode64(e){r="";for(i=0;i<e.length;i+=3)i+2==e.length?r+=append3bytes(e.charCodeAt(i),e.charCodeAt(i+1),0):i+1==e.length?r+=append3bytes(e.charCodeAt(i),0,0):r+=append3bytes(e.charCodeAt(i),e.charCodeAt(i+1),e.charCodeAt(i+2));return r}function append3bytes(e,t,n){return c1=e>>2,c2=(e&3)<<4|t>>4,c3=(t&15)<<2|n>>6,c4=n&63,r="",r+=encode6bit(c1&63),r+=encode6bit(c2&63),r+=encode6bit(c3&63),r+=encode6bit(c4&63),r}function encode6bit(e){return e<10?String.fromCharCode(48+e):(e-=10,e<26?String.fromCharCode(65+e):(e-=26,e<26?String.fromCharCode(97+e):(e-=26,e==0?"-":e==1?"_":"?")))}var deflater=window.SharedWorker&&new SharedWorker("/js/rawdeflate.js");deflater?(deflater.port.addEventListener("message",done_deflating,!1),deflater.port.start()):window.Worker&&(deflater=new Worker("/js/rawdeflate.js"),deflater.onmessage=done_deflating);function done_deflating(e){const s=document.getElementById("plantuml-"),t="https://www.plantuml.com/plantuml/img/"+encode64(e.data);s.src=t;const n=document.getElementById("plantuml-link-");n&&(n.href=t)}function compress(e){e=unescape(encodeURIComponent(e)),deflater?deflater.port&&deflater.port.postMessage?deflater.port.postMessage(e):deflater.postMessage(e):setTimeout(function(){done_deflating({data:deflate(e)})},100)}compress(`
@startuml
!define ICONURL https://raw.githubusercontent.com/tupadr3/plantuml-icon-font-sprites/v2.4.0
!includeurl ICONURL/common.puml
!includeurl ICONURL/font-awesome-5/chart-bar.puml
!includeurl ICONURL/font-awesome-5/file-alt.puml
!includeurl ICONURL/aws/Analytics/amazon-quicksight.puml

title Compliance Reporting and Analytics Architecture

package "Data Sources" {
  [Evidence Collection] as evidence
  [Compliance Scans] as scans
  [Audit Trails] as trails
  [Manual Assessments] as manual
}

package "Data Processing" {
  [Data Lake] as lake
  [ETL Pipeline] as etl
  [Analytics Engine] as analytics
}

package "Reporting Layer" {
  [Real-time Dashboard] as dashboard
  [Scheduled Reports] as reports
  [Audit Packages] as packages
  [Trend Analysis] as trends
}

package "Consumers" {
  [Management] as mgmt
  [Auditors] as auditors
  [Compliance Team] as compliance
  [Security Team] as security
}

evidence -> lake : Evidence Data
scans -> lake : Scan Results
trails -> lake : Audit Events
manual -> lake : Assessment Data

lake -> etl : Raw Data
etl -> analytics : Processed Data

analytics -> dashboard : Real-time Metrics
analytics -> reports : Report Data
analytics -> packages : Audit Evidence
analytics -> trends : Trend Data

dashboard -> mgmt : Executive View
dashboard -> compliance : Operational View
reports -> auditors : Compliance Reports
packages -> auditors : Evidence Packages
trends -> security : Risk Insights

@enduml
`)</script><p>Compliance automation in cloud-native environments represents a fundamental shift from reactive compliance management to proactive, continuous compliance that is integrated into every aspect of the development and operations lifecycle. The success of these automation initiatives depends on comprehensive framework implementation, robust evidence collection, and sophisticated reporting capabilities that can keep pace with the velocity of modern software delivery while maintaining the rigor that regulatory compliance demands.</p><p>The investment in compliance automation pays dividends beyond regulatory adherence by creating organizational capabilities that improve security posture, operational efficiency, and risk management. Organizations that successfully implement comprehensive compliance automation are better positioned to respond to evolving regulatory requirements, expand into new markets with different compliance obligations, and maintain customer trust through demonstrable commitment to data protection and security best practices.</p><p>The future of compliance automation will likely see increased integration with artificial intelligence and machine learning capabilities that can provide more sophisticated risk assessment, predictive compliance analytics, and automated adaptation to changing regulatory requirements. Organizations that establish strong foundations in compliance automation today will be well-positioned to take advantage of these advances while maintaining robust protection against compliance risks in increasingly complex regulatory environments.</p></div><div class=social-share><h3 class=social-share-title>Share this post</h3><div class=social-share-buttons><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F&text=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments+-+%3Cp%3EThe+traditional+approach+to+compliance%2C+characterized+by+annual+audits+and+point-in-time+assessments%2C+is+fundamentally+incompatible+with+the+velocity+and+%E2%80%A6%3C%2Fp%3E" target=_blank rel="noopener noreferrer" class="social-share-button twitter" title="Share on Twitter"><svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
<span>Twitter</span>
</a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F" target=_blank rel="noopener noreferrer" class="social-share-button linkedin" title="Share on LinkedIn"><svg viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
<span>LinkedIn</span>
</a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F" target=_blank rel="noopener noreferrer" class="social-share-button facebook" title="Share on Facebook"><svg viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312.0 2.686.235 2.686.235v2.953H15.83c-1.491.0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
<span>Facebook</span>
</a><a href="https://reddit.com/submit?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F&title=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments" target=_blank rel="noopener noreferrer" class="social-share-button reddit" title="Share on Reddit"><svg viewBox="0 0 24 24"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg>
<span>Reddit</span>
</a><a href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F&t=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments" target=_blank rel="noopener noreferrer" class="social-share-button hackernews" title="Share on Hacker News"><svg viewBox="0 0 24 24"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
<span>Hacker News</span>
</a><a href="https://wa.me/?text=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments+https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F" target=_blank rel="noopener noreferrer" class="social-share-button whatsapp" title="Share on WhatsApp"><svg viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893A11.821 11.821.0 0020.465 3.488"/></svg>
<span>WhatsApp</span>
</a><a href="mailto:?subject=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments&body=Check+out+this+article%3A+Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments+-+https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F" class="social-share-button email" title="Share via Email"><svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1.0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"/></svg>
<span>Email</span>
</a><button type=button class="social-share-button copy-link" data-url=https://scottobert.com/posts/compliance-automation/ title="Copy link to clipboard">
<svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1.0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1.0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1.0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
<span>Copy Link</span></button></div></div><script>(function(){const n=document.querySelectorAll(".copy-link");n.forEach(n=>{n.addEventListener("click",function(){const n=this.getAttribute("data-url");navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(n).then(()=>{t(this)}).catch(()=>{e(n,this)}):e(n,this)})});function e(e,n){const o=document.createElement("textarea");o.value=e,o.style.position="fixed",o.style.left="-999999px",o.style.top="-999999px",document.body.appendChild(o),o.focus(),o.select();try{document.execCommand("copy"),t(n)}catch(e){console.error("Fallback: Unable to copy",e),s(n)}document.body.removeChild(o)}function t(e){const t=e.querySelector("span").textContent;e.querySelector("span").textContent="Copied!",e.classList.add("copied"),setTimeout(()=>{e.querySelector("span").textContent=t,e.classList.remove("copied")},2e3)}function s(e){const t=e.querySelector("span").textContent;e.querySelector("span").textContent="Error",e.classList.add("error"),setTimeout(()=>{e.querySelector("span").textContent=t,e.classList.remove("error")},2e3)}})()</script><div id=comments-section style="margin-top:2rem;padding-top:2rem;border-top:1px solid #e1e5e9"><h3 style=margin-bottom:1rem;color:#586069>Comments</h3><script src=https://giscus.app/client.js data-repo=scottobert/scottobert.github.io data-repo-id=R_kgDOHRSG6A data-category=General data-category-id=DIC_kwDOHRSG6M4CrQaA data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=light data-lang=en data-loading=lazy crossorigin=anonymous async></script></div></article><div class=floating-social-share id=floating-share><div class=floating-share-toggle id=share-toggle title="Share this post"><svg viewBox="0 0 24 24"><path d="M18 16.08c-.76.0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66.0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66.0-3 1.34-3 3s1.34 3 3 3c.79.0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65.0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"/></svg></div><div class=floating-share-buttons id=share-buttons><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F&text=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments" target=_blank rel="noopener noreferrer" class="floating-share-button twitter" title="Share on Twitter"><svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
</a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F" target=_blank rel="noopener noreferrer" class="floating-share-button linkedin" title="Share on LinkedIn"><svg viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
</a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F" target=_blank rel="noopener noreferrer" class="floating-share-button facebook" title="Share on Facebook"><svg viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312.0 2.686.235 2.686.235v2.953H15.83c-1.491.0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
</a><a href="https://reddit.com/submit?url=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F&title=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments" target=_blank rel="noopener noreferrer" class="floating-share-button reddit" title="Share on Reddit"><svg viewBox="0 0 24 24"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg>
</a><a href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F&t=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments" target=_blank rel="noopener noreferrer" class="floating-share-button hackernews" title="Share on Hacker News"><svg viewBox="0 0 24 24"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
</a><a href="https://wa.me/?text=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments+https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F" target=_blank rel="noopener noreferrer" class="floating-share-button whatsapp" title="Share on WhatsApp"><svg viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893A11.821 11.821.0 0020.465 3.488"/></svg>
</a><a href="mailto:?subject=Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments&body=Check+out+this+article%3A+Compliance+Automation%3A+Implementing+Continuous+Compliance+in+Cloud-Native+Environments+-+https%3A%2F%2Fscottobert.com%2Fposts%2Fcompliance-automation%2F" class="floating-share-button email" title="Share via Email"><svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1.0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"/></svg>
</a><button type=button class="floating-share-button copy-link" data-url=https://scottobert.com/posts/compliance-automation/ title="Copy link">
<svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1.0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1.0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1.0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg></button></div></div><script>(function(){const s=document.getElementById("floating-share"),t=document.getElementById("share-toggle"),n=document.getElementById("share-buttons");if(!s||!t||!n)return;let e=!1,o;t.addEventListener("click",function(){e=!e,e?(n.classList.add("visible"),t.classList.add("active"),clearTimeout(o)):(n.classList.remove("visible"),t.classList.remove("active"))});function i(){clearTimeout(o),o=setTimeout(()=>{e&&(n.classList.remove("visible"),t.classList.remove("active"),e=!1)},5e3)}s.addEventListener("mouseenter",()=>{clearTimeout(o)}),s.addEventListener("mouseleave",()=>{e&&i()}),t.addEventListener("click",()=>{e&&i()});let l=0;const d=300;window.addEventListener("scroll",function(){const o=window.pageYOffset||document.documentElement.scrollTop;o>d?s.classList.add("visible"):(s.classList.remove("visible"),e&&(n.classList.remove("visible"),t.classList.remove("active"),e=!1)),l=o});const a=n.querySelector(".copy-link");a&&a.addEventListener("click",function(){const e=this.getAttribute("data-url");navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(e).then(()=>{c(this)}).catch(()=>{r(e,this)}):r(e,this)});function r(e,t){const n=document.createElement("textarea");n.value=e,n.style.position="fixed",n.style.left="-999999px",n.style.top="-999999px",document.body.appendChild(n),n.focus(),n.select();try{document.execCommand("copy"),c(t)}catch(e){console.error("Fallback: Unable to copy",e)}document.body.removeChild(n)}function c(e){e.classList.add("copied"),setTimeout(()=>{e.classList.remove("copied")},2e3)}})()</script></main><aside class=blog-sidebar><div class=sidebar-widget><h3>Recent Posts</h3><ul class=recent-posts><li><a href=/posts/reverting-git-commits-safely/>Reverting Git Commits Safely: Undoing Changes Without Losing History</a>
<span class=post-date>Jun 11, 2025</span></li><li><a href=/posts/dynamodb-streams-opensearch-sync/>Real-time Data Synchronization: Using DynamoDB Streams and Lambda to Keep OpenSearch Indexes Current</a>
<span class=post-date>Jun 6, 2025</span></li><li><a href=/posts/using-ai-in-software-engineering/>Harnessing AI in Software Engineering: Opportunities and Challenges</a>
<span class=post-date>May 29, 2025</span></li><li><a href=/posts/aws-serverless-cost-optimization/>Cost Optimization Strategies for AWS Serverless Applications</a>
<span class=post-date>Jun 17, 2023</span></li><li><a href=/posts/aws-sns-sqs-typescript/>Building Event-Driven Architectures with AWS SNS/SQS and TypeScript</a>
<span class=post-date>May 21, 2023</span></li></ul></div><div class=sidebar-widget><h3>Post Series</h3><ul class=recent-posts><li><a href=/posts/aws-sns-sqs-typescript/>AWS and Typescript: Building Event-Driven Architectures with AWS SNS/SQS and TypeScript</a>
<span class=post-date>May 21, 2023</span><div class=series-meta><a href=/series/aws-and-typescript/ class=series-link>View all 3 posts in series →</a></div></li><li><a href=/posts/real-time-processing-architectures/>Cloud Architecture Patterns: Real-time Processing Architectures</a>
<span class=post-date>Apr 11, 2021</span><div class=series-meta><a href=/series/cloud-architecture-patterns/ class=series-link>View all 7 posts in series →</a></div></li><li><a href=/posts/technical-debt-management-growing-codebases/>Modern Development Practices: Technical Debt Management in Growing Codebases: Strategies for Sustainable Development</a>
<span class=post-date>Dec 19, 2021</span><div class=series-meta><a href=/series/modern-development-practices/ class=series-link>View all 7 posts in series →</a></div></li><li><a href=/posts/threat-modeling-cloud-applications/>Security in Cloud-Native Applications: Threat Modeling for Cloud Applications: A Comprehensive Approach to Security Design</a>
<span class=post-date>Oct 19, 2019</span><div class=series-meta><a href=/series/security-in-cloud-native-applications/ class=series-link>View all 7 posts in series →</a></div></li></ul></div><div class=sidebar-widget><h3>Categories</h3><ul class=categories><li><a href=/categories/api-development>api development (1)</a></li><li><a href=/categories/architecture>architecture (2)</a></li><li><a href=/categories/architecture-and-design>architecture and design (8)</a></li><li><a href=/categories/artificial-intelligence>artificial intelligence (1)</a></li><li><a href=/categories/cloud-computing>cloud computing (16)</a></li><li><a href=/categories/code-quality>code quality (1)</a></li><li><a href=/categories/compliance>compliance (1)</a></li><li><a href=/categories/cost-optimization>cost optimization (1)</a></li><li><a href=/categories/data-engineering>data engineering (3)</a></li><li><a href=/categories/database>database (1)</a></li><li><a href=/categories/debugging-and-troubleshooting>debugging and troubleshooting (1)</a></li><li><a href=/categories/developer-experience>developer experience (1)</a></li><li><a href=/categories/development-tools>development tools (3)</a></li><li><a href=/categories/development-tutorials>development tutorials (1)</a></li><li><a href=/categories/microservices>microservices (1)</a></li><li><a href=/categories/performance>performance (1)</a></li><li><a href=/categories/quality-assurance>quality assurance (1)</a></li><li><a href=/categories/security>security (8)</a></li><li><a href=/categories/serverless>serverless (2)</a></li><li><a href=/categories/software-development>software development (8)</a></li><li><a href=/categories/technical-debt>technical debt (1)</a></li><li><a href=/categories/testing>testing (2)</a></li><li><a href=/categories/version-control>version control (2)</a></li></ul></div><div class=sidebar-widget><h3>Tags</h3><div class=tag-cloud><a href=/tags/ai class=tag-cloud-item style=font-size:1rem>ai
</a><a href=/tags/api-design class=tag-cloud-item style=font-size:1rem>api design
</a><a href=/tags/api-security class=tag-cloud-item style=font-size:1rem>api security
</a><a href=/tags/architecture class=tag-cloud-item style=font-size:2rem>architecture
</a><a href=/tags/athena class=tag-cloud-item style=font-size:1rem>athena
</a><a href=/tags/authentication class=tag-cloud-item style=font-size:1rem>authentication
</a><a href=/tags/authorization class=tag-cloud-item style=font-size:1rem>authorization
</a><a href=/tags/automation class=tag-cloud-item style=font-size:1rem>automation
</a><a href=/tags/aws class=tag-cloud-item style=font-size:3rem>aws
</a><a href=/tags/aws-lambda class=tag-cloud-item style=font-size:1rem>aws lambda
</a><a href=/tags/best-practices class=tag-cloud-item style=font-size:1rem>best practices
</a><a href=/tags/chaos-engineering class=tag-cloud-item style=font-size:1rem>chaos engineering
</a><a href=/tags/ci/cd class=tag-cloud-item style=font-size:1rem>ci/cd
</a><a href=/tags/cloud-native class=tag-cloud-item style=font-size:1rem>cloud native
</a><a href=/tags/cloudnative class=tag-cloud-item style=font-size:1rem>cloudnative
</a><a href=/tags/code-quality class=tag-cloud-item style=font-size:1rem>code quality
</a><a href=/tags/communication-patterns class=tag-cloud-item style=font-size:1rem>communication patterns
</a><a href=/tags/compliance class=tag-cloud-item style=font-size:1rem>compliance
</a><a href=/tags/containers class=tag-cloud-item style=font-size:1rem>containers
</a><a href=/tags/cost-optimization class=tag-cloud-item style=font-size:1rem>cost optimization
</a><a href=/tags/cqrs class=tag-cloud-item style=font-size:1rem>cqrs
</a><a href=/tags/data-architecture class=tag-cloud-item style=font-size:1rem>data architecture
</a><a href=/tags/data-lake class=tag-cloud-item style=font-size:1rem>data lake
</a><a href=/tags/data-modeling class=tag-cloud-item style=font-size:1rem>data modeling
</a><a href=/tags/database-design class=tag-cloud-item style=font-size:1rem>database design
</a><a href=/tags/debugging class=tag-cloud-item style=font-size:1rem>debugging
</a><a href=/tags/debugging-and-troubleshooting class=tag-cloud-item style=font-size:1rem>debugging and troubleshooting
</a><a href=/tags/developer-tips class=tag-cloud-item style=font-size:1rem>developer tips
</a><a href=/tags/development class=tag-cloud-item style=font-size:2rem>development
</a><a href=/tags/devops class=tag-cloud-item style=font-size:1rem>devops
</a><a href=/tags/devsecops class=tag-cloud-item style=font-size:1rem>devsecops
</a><a href=/tags/distributed-systems class=tag-cloud-item style=font-size:1rem>distributed systems
</a><a href=/tags/docker class=tag-cloud-item style=font-size:1rem>docker
</a><a href=/tags/dynamodb class=tag-cloud-item style=font-size:1rem>dynamodb
</a><a href=/tags/encryption class=tag-cloud-item style=font-size:1rem>encryption
</a><a href=/tags/enterprise-architecture class=tag-cloud-item style=font-size:1rem>enterprise architecture
</a><a href=/tags/event-sourcing class=tag-cloud-item style=font-size:1rem>event sourcing
</a><a href=/tags/event-driven-architecture class=tag-cloud-item style=font-size:1rem>event-driven architecture
</a><a href=/tags/eventbridge class=tag-cloud-item style=font-size:1rem>eventbridge
</a><a href=/tags/fault-tolerance class=tag-cloud-item style=font-size:1rem>fault tolerance
</a><a href=/tags/gdpr class=tag-cloud-item style=font-size:1rem>gdpr
</a><a href=/tags/git class=tag-cloud-item style=font-size:1rem>git
</a><a href=/tags/glue class=tag-cloud-item style=font-size:1rem>glue
</a><a href=/tags/governance class=tag-cloud-item style=font-size:1rem>governance
</a><a href=/tags/graphql class=tag-cloud-item style=font-size:1rem>graphql
</a><a href=/tags/hipaa class=tag-cloud-item style=font-size:1rem>hipaa
</a><a href=/tags/iam class=tag-cloud-item style=font-size:1rem>iam
</a><a href=/tags/identity-management class=tag-cloud-item style=font-size:1rem>identity management
</a><a href=/tags/jwt class=tag-cloud-item style=font-size:1rem>jwt
</a><a href=/tags/kinesis class=tag-cloud-item style=font-size:1rem>kinesis
</a><a href=/tags/kubernetes class=tag-cloud-item style=font-size:1rem>kubernetes
</a><a href=/tags/lambda class=tag-cloud-item style=font-size:1rem>lambda
</a><a href=/tags/load-testing class=tag-cloud-item style=font-size:1rem>load testing
</a><a href=/tags/metrics class=tag-cloud-item style=font-size:1rem>metrics
</a><a href=/tags/microservices class=tag-cloud-item style=font-size:1rem>microservices
</a><a href=/tags/monitoring class=tag-cloud-item style=font-size:1rem>monitoring
</a><a href=/tags/multi-account class=tag-cloud-item style=font-size:1rem>multi-account
</a><a href=/tags/nosql class=tag-cloud-item style=font-size:1rem>nosql
</a><a href=/tags/oauth class=tag-cloud-item style=font-size:1rem>oauth
</a><a href=/tags/octave class=tag-cloud-item style=font-size:1rem>octave
</a><a href=/tags/opensearch class=tag-cloud-item style=font-size:1rem>opensearch
</a><a href=/tags/pasta class=tag-cloud-item style=font-size:1rem>pasta
</a><a href=/tags/patterns class=tag-cloud-item style=font-size:1rem>patterns
</a><a href=/tags/pci-dss class=tag-cloud-item style=font-size:1rem>pci-dss
</a><a href=/tags/performance-testing class=tag-cloud-item style=font-size:1rem>performance testing
</a><a href=/tags/productivity class=tag-cloud-item style=font-size:1rem>productivity
</a><a href=/tags/rate-limiting class=tag-cloud-item style=font-size:1rem>rate limiting
</a><a href=/tags/real-time class=tag-cloud-item style=font-size:1rem>real-time
</a><a href=/tags/refactoring class=tag-cloud-item style=font-size:1rem>refactoring
</a><a href=/tags/reliability class=tag-cloud-item style=font-size:1rem>reliability
</a><a href=/tags/resilience class=tag-cloud-item style=font-size:1rem>resilience
</a><a href=/tags/rest class=tag-cloud-item style=font-size:1rem>rest
</a><a href=/tags/riskassessment class=tag-cloud-item style=font-size:1rem>riskassessment
</a><a href=/tags/s3 class=tag-cloud-item style=font-size:1rem>s3
</a><a href=/tags/search class=tag-cloud-item style=font-size:1rem>search
</a><a href=/tags/secrets-management class=tag-cloud-item style=font-size:1rem>secrets management
</a><a href=/tags/security class=tag-cloud-item style=font-size:2rem>security
</a><a href=/tags/securitydesign class=tag-cloud-item style=font-size:1rem>securitydesign
</a><a href=/tags/serverless class=tag-cloud-item style=font-size:2rem>serverless
</a><a href=/tags/soc2 class=tag-cloud-item style=font-size:1rem>soc2
</a><a href=/tags/software-engineering class=tag-cloud-item style=font-size:1rem>software engineering
</a><a href=/tags/standards class=tag-cloud-item style=font-size:1rem>standards
</a><a href=/tags/stream-processing class=tag-cloud-item style=font-size:1rem>stream processing
</a><a href=/tags/streams class=tag-cloud-item style=font-size:1rem>streams
</a><a href=/tags/stride class=tag-cloud-item style=font-size:1rem>stride
</a><a href=/tags/tdd class=tag-cloud-item style=font-size:1rem>tdd
</a><a href=/tags/technical-debt class=tag-cloud-item style=font-size:1rem>technical debt
</a><a href=/tags/testing class=tag-cloud-item style=font-size:1rem>testing
</a><a href=/tags/threatmodeling class=tag-cloud-item style=font-size:1rem>threatmodeling
</a><a href=/tags/typescript class=tag-cloud-item style=font-size:2rem>typescript
</a><a href=/tags/version-control class=tag-cloud-item style=font-size:1rem>version control
</a><a href=/tags/zero-trust class=tag-cloud-item style=font-size:1rem>zero trust</a></div></div><div class=sidebar-widget><h3>Subscribe</h3><div class=subscribe-links><a href=/index.xml class=rss-link><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg>
RSS Feed</a></div></div><div class="sidebar-widget npm-packages"><h3>My NPM Packages</h3><div id=npm-list></div></div></aside></div></div><footer class=site-footer><div class=container><p>&copy; 2025 Scott Obert</p></div></footer></body></html>
<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Scott Obert</title><meta name=description content="The ephemeral nature of containers and serverless functions introduces unique security challenges that traditional application security models weren&rsquo;t …"><link rel=canonical href=https://scottobert.com/posts/container-serverless-security/><meta property="og:title" content="Container and Serverless Security: Protecting Ephemeral Workloads"><meta property="og:description" content="The ephemeral nature of containers and serverless functions introduces unique security challenges that traditional application security models weren&rsquo;t …"><meta property="og:type" content="article"><meta property="og:url" content="https://scottobert.com/posts/container-serverless-security/"><meta property="og:site_name" content="Scott Obert"><meta name=twitter:card content="summary"><meta name=twitter:title content="Container and Serverless Security: Protecting Ephemeral Workloads"><meta name=twitter:description content="The ephemeral nature of containers and serverless functions introduces unique security challenges that traditional application security models weren&rsquo;t …"><link rel=stylesheet href=/css/style.css><script src=/js/npm-packages.js defer></script><script defer src=https://cloud.umami.is/script.js data-website-id=e2461896-021d-422a-b83f-624a8819309b></script></head><body><header class=site-header><div class=container><div class=header-content><div class=header-left><h1><a href=/>Scott Obert</a></h1><nav><a href=/posts/>Blog</a></nav></div><div class=social-links><a href=https://www.linkedin.com/in/scott-obert-3a7338b/ target=_blank rel="noopener noreferrer" title="LinkedIn Profile"><svg viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
<span>LinkedIn</span>
</a><a href=https://github.com/scottobert target=_blank rel="noopener noreferrer" title="GitHub Profile"><svg viewBox="0 0 24 24"><path d="M12 0C5.37.0.0 5.37.0 12c0 5.3 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61-.546-1.385-1.335-1.755-1.335-1.755-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.605-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 21.795 24 17.295 24 12c0-6.63-5.37-12-12-12"/></svg>
<span>GitHub</span></a></div></div></div></header><div class=container><div class=content-layout><main class=main-content><article class=post><h1>Container and Serverless Security: Protecting Ephemeral Workloads</h1><div class=post-meta><span>Sep 7, 2019</span>
<span>| Tags: Security, Containers, Serverless, Docker, Kubernetes, AWS Lambda, DevSecOps, CloudNative</span></div><div class=post-content><p>The ephemeral nature of containers and serverless functions introduces unique security challenges that traditional application security models weren&rsquo;t designed to address. Unlike long-running virtual machines or physical servers, these workloads exist for minutes, hours, or even seconds, making traditional security monitoring and patching strategies ineffective. This fundamental shift requires a new approach to security that embraces the transient nature of these workloads while maintaining robust protection against evolving threats.</p><p>Container and serverless security operates on the principle that protection must be built into the deployment pipeline rather than applied after deployment. This shift-left approach ensures that security controls are embedded throughout the development lifecycle, from image creation to runtime execution. The challenge lies in balancing security rigor with the speed and agility that containerized and serverless architectures promise to deliver.</p><h2 id=container-security-fundamentals>Container Security Fundamentals</h2><p>Container security begins with understanding the shared kernel model that makes containerization possible. Unlike virtual machines, containers share the host operating system kernel, creating potential attack vectors that don&rsquo;t exist in traditional virtualized environments. This architectural difference means that a compromise in one container could potentially affect other containers or the host system itself, making container isolation and security controls critical components of any container strategy.</p><p>The container lifecycle presents multiple attack surfaces that must be secured. During the build phase, vulnerabilities can be introduced through base images, application dependencies, or configuration errors. The image storage phase creates opportunities for tampering or unauthorized access, while the runtime phase introduces new vectors through container orchestration, network communications, and resource access patterns. Each phase requires specific security controls and monitoring strategies to maintain comprehensive protection.</p><p>Modern container security strategies focus on immutable infrastructure principles, where containers are treated as disposable artifacts rather than systems to be maintained over time. This approach eliminates the traditional patching cycle in favor of rebuilding and redeploying containers with updated components. While this strategy provides significant security benefits, it requires sophisticated automation and pipeline management to execute effectively at scale.</p><p>Let&rsquo;s examine a comprehensive container security implementation that addresses these challenges:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// container-security-scanner.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ECRClient</span>, <span style=color:#a6e22e>DescribeImageScanFindingsCommand</span>, <span style=color:#a6e22e>StartImageScanCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-ecr&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>LambdaClient</span>, <span style=color:#a6e22e>InvokeCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-lambda&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>SSMClient</span>, <span style=color:#a6e22e>GetParameterCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-ssm&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SecurityScanResult</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>imageUri</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vulnerabilities</span>: <span style=color:#66d9ef>VulnerabilityFinding</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>complianceStatus</span>: <span style=color:#66d9ef>ComplianceStatus</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>riskScore</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>scanTimestamp</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>VulnerabilityFinding</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>severity</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;CRITICAL&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;HIGH&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;LOW&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;INFORMATIONAL&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>packageName</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>packageVersion</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fixAvailable</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cvssScore?</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>ComplianceStatus</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>COMPLIANT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;COMPLIANT&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>NON_COMPLIANT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;NON_COMPLIANT&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>UNKNOWN</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;UNKNOWN&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ContainerSecurityScanner</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>ecrClient</span>: <span style=color:#66d9ef>ECRClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>lambdaClient</span>: <span style=color:#66d9ef>LambdaClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>ssmClient</span>: <span style=color:#66d9ef>SSMClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>vulnerabilityThresholds</span>: <span style=color:#66d9ef>Map</span>&lt;<span style=color:#f92672>string</span>, <span style=color:#a6e22e>number</span>&gt;;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>ecrClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ECRClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lambdaClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>LambdaClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>ssmClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>SSMClient</span>({});
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>vulnerabilityThresholds</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Map</span>([
</span></span><span style=display:flex><span>      [<span style=color:#e6db74>&#39;CRITICAL&#39;</span>, <span style=color:#ae81ff>0</span>],
</span></span><span style=display:flex><span>      [<span style=color:#e6db74>&#39;HIGH&#39;</span>, <span style=color:#ae81ff>5</span>],
</span></span><span style=display:flex><span>      [<span style=color:#e6db74>&#39;MEDIUM&#39;</span>, <span style=color:#ae81ff>20</span>],
</span></span><span style=display:flex><span>      [<span style=color:#e6db74>&#39;LOW&#39;</span>, <span style=color:#ae81ff>50</span>]
</span></span><span style=display:flex><span>    ]);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>scanContainerImage</span>(<span style=color:#a6e22e>repositoryName</span>: <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>imageTag</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>SecurityScanResult</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>imageUri</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>repositoryName</span><span style=color:#e6db74>}</span><span style=color:#e6db74>:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>imageTag</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Initiate ECR vulnerability scan
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initiateECRScan</span>(<span style=color:#a6e22e>repositoryName</span>, <span style=color:#a6e22e>imageTag</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Wait for scan completion and retrieve results
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>scanFindings</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>waitForScanCompletion</span>(<span style=color:#a6e22e>repositoryName</span>, <span style=color:#a6e22e>imageTag</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Perform additional security checks
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>customFindings</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>performCustomSecurityChecks</span>(<span style=color:#a6e22e>imageUri</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Combine and analyze findings
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>allVulnerabilities</span> <span style=color:#f92672>=</span> [...<span style=color:#a6e22e>scanFindings</span>, ...<span style=color:#a6e22e>customFindings</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>riskScore</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateRiskScore</span>(<span style=color:#a6e22e>allVulnerabilities</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>complianceStatus</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>assessCompliance</span>(<span style=color:#a6e22e>allVulnerabilities</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>result</span>: <span style=color:#66d9ef>SecurityScanResult</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>imageUri</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>vulnerabilities</span>: <span style=color:#66d9ef>allVulnerabilities</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>complianceStatus</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>riskScore</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>scanTimestamp</span>: <span style=color:#66d9ef>new</span> Date().<span style=color:#a6e22e>toISOString</span>()
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Store scan results for audit and tracking
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>storeScanResults</span>(<span style=color:#a6e22e>result</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Trigger automated remediation if configured
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>complianceStatus</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>ComplianceStatus</span>.<span style=color:#a6e22e>NON_COMPLIANT</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>triggerRemediationWorkflow</span>(<span style=color:#a6e22e>result</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>initiateECRScan</span>(<span style=color:#a6e22e>repositoryName</span>: <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>imageTag</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>command</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>StartImageScanCommand</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>repositoryName</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>imageId</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>imageTag</span> }
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>ecrClient</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>command</span>);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>: <span style=color:#66d9ef>any</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;ScanInProgressException&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Scan already in progress, continue
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>waitForScanCompletion</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>repositoryName</span>: <span style=color:#66d9ef>string</span>, 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>imageTag</span>: <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>VulnerabilityFinding</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>maxAttempts</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>30</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>delayMs</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10000</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>attempt</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>attempt</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>maxAttempts</span>; <span style=color:#a6e22e>attempt</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>command</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>DescribeImageScanFindingsCommand</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>repositoryName</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>imageId</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>imageTag</span> }
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>ecrClient</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>command</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>imageScanStatus</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>status</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;COMPLETE&#39;</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>parseECRFindings</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>imageScanFindings</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>findings</span> <span style=color:#f92672>||</span> []);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>imageScanStatus</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>status</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;FAILED&#39;</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>`ECR scan failed: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>imageScanStatus</span>.<span style=color:#a6e22e>description</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>delay</span>(<span style=color:#a6e22e>delayMs</span>);
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>attempt</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>maxAttempts</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>delay</span>(<span style=color:#a6e22e>delayMs</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>&#39;Scan timeout: ECR scan did not complete within expected timeframe&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>parseECRFindings</span>(<span style=color:#a6e22e>ecrFindings</span>: <span style=color:#66d9ef>any</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>VulnerabilityFinding</span>[] {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ecrFindings</span>.<span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>finding</span> <span style=color:#f92672>=&gt;</span> ({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>finding.name</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>finding.severity</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>finding.description</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>packageName</span>: <span style=color:#66d9ef>finding.attributes?.find</span>((<span style=color:#a6e22e>attr</span>: <span style=color:#66d9ef>any</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>attr</span>.<span style=color:#a6e22e>key</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;package_name&#39;</span>)<span style=color:#f92672>?</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;unknown&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>packageVersion</span>: <span style=color:#66d9ef>finding.attributes?.find</span>((<span style=color:#a6e22e>attr</span>: <span style=color:#66d9ef>any</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>attr</span>.<span style=color:#a6e22e>key</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;package_version&#39;</span>)<span style=color:#f92672>?</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;unknown&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>fixAvailable</span>: <span style=color:#66d9ef>finding.attributes?.some</span>((<span style=color:#a6e22e>attr</span>: <span style=color:#66d9ef>any</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>attr</span>.<span style=color:#a6e22e>key</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;fixed_in_version&#39;</span>),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>cvssScore</span>: <span style=color:#66d9ef>finding.attributes?.find</span>((<span style=color:#a6e22e>attr</span>: <span style=color:#66d9ef>any</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>attr</span>.<span style=color:#a6e22e>key</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;CVSS2_SCORE&#39;</span>)<span style=color:#f92672>?</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>?</span> 
</span></span><span style=display:flex><span>                 parseFloat(<span style=color:#a6e22e>finding</span>.<span style=color:#a6e22e>attributes</span>.<span style=color:#a6e22e>find</span>((<span style=color:#a6e22e>attr</span>: <span style=color:#66d9ef>any</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>attr</span>.<span style=color:#a6e22e>key</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;CVSS2_SCORE&#39;</span>).<span style=color:#a6e22e>value</span>) <span style=color:#f92672>:</span> <span style=color:#66d9ef>undefined</span>
</span></span><span style=display:flex><span>    }));
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>performCustomSecurityChecks</span>(<span style=color:#a6e22e>imageUri</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>VulnerabilityFinding</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Invoke custom security scanning Lambda
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>command</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>InvokeCommand</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>FunctionName</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;container-security-scanner&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Payload</span>: <span style=color:#66d9ef>JSON.stringify</span>({ <span style=color:#a6e22e>imageUri</span> }),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>InvocationType</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;RequestResponse&#39;</span>
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lambdaClient</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>command</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>payload</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>TextDecoder</span>().<span style=color:#a6e22e>decode</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>Payload</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>payload</span>.<span style=color:#a6e22e>findings</span> <span style=color:#f92672>||</span> [];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>calculateRiskScore</span>(<span style=color:#a6e22e>vulnerabilities</span>: <span style=color:#66d9ef>VulnerabilityFinding</span>[])<span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>severityWeights</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;CRITICAL&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;HIGH&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>7</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;MEDIUM&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;LOW&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;INFORMATIONAL&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>totalScore</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vulnerabilities</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>score</span>, <span style=color:#a6e22e>vuln</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>baseWeight</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>severityWeights</span>[<span style=color:#a6e22e>vuln</span>.<span style=color:#a6e22e>severity</span>] <span style=color:#f92672>||</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>cvssMultiplier</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vuln</span>.<span style=color:#a6e22e>cvssScore</span> <span style=color:#f92672>?</span> (<span style=color:#a6e22e>vuln</span>.<span style=color:#a6e22e>cvssScore</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>10</span>) <span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>score</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>baseWeight</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>cvssMultiplier</span>);
</span></span><span style=display:flex><span>    }, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Normalize score to 0-100 range
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> Math.<span style=color:#a6e22e>min</span>(<span style=color:#ae81ff>100</span>, Math.<span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>totalScore</span>));
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>assessCompliance</span>(<span style=color:#a6e22e>vulnerabilities</span>: <span style=color:#66d9ef>VulnerabilityFinding</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>ComplianceStatus</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>severityCounts</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vulnerabilities</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>counts</span>, <span style=color:#a6e22e>vuln</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>counts</span>[<span style=color:#a6e22e>vuln</span>.<span style=color:#a6e22e>severity</span>] <span style=color:#f92672>=</span> (<span style=color:#a6e22e>counts</span>[<span style=color:#a6e22e>vuln</span>.<span style=color:#a6e22e>severity</span>] <span style=color:#f92672>||</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>counts</span>;
</span></span><span style=display:flex><span>    }, {} <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>Record</span>&lt;<span style=color:#f92672>string</span>, <span style=color:#a6e22e>number</span>&gt;);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>severity</span>, <span style=color:#a6e22e>threshold</span>] <span style=color:#66d9ef>of</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>vulnerabilityThresholds</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>count</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>severityCounts</span>[<span style=color:#a6e22e>severity</span>] <span style=color:#f92672>||</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>count</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>threshold</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ComplianceStatus</span>.<span style=color:#a6e22e>NON_COMPLIANT</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ComplianceStatus</span>.<span style=color:#a6e22e>COMPLIANT</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>storeScanResults</span>(<span style=color:#a6e22e>result</span>: <span style=color:#66d9ef>SecurityScanResult</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Implementation would store results in DynamoDB or other persistent storage
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// for audit trails and historical analysis
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`Storing scan results for </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>imageUri</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>triggerRemediationWorkflow</span>(<span style=color:#a6e22e>result</span>: <span style=color:#66d9ef>SecurityScanResult</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Implementation would trigger automated remediation workflows
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// such as rebuilding images with updated base layers or dependencies
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`Triggering remediation for non-compliant image: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>imageUri</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>delay</span>(<span style=color:#a6e22e>ms</span>: <span style=color:#66d9ef>number</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Promise</span>(<span style=color:#a6e22e>resolve</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>setTimeout</span>(<span style=color:#a6e22e>resolve</span>, <span style=color:#a6e22e>ms</span>));
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=plantuml-container><img id=plantuml- class=plantuml-diagram>
<a id=plantuml-link- href=# target=_blank class=plantuml-link title="Open diagram in new window"><span class=plantuml-link-icon>🔍</span></a></div><script src=/js/rawdeflate.js></script><script>function encode64(e){r="";for(i=0;i<e.length;i+=3)i+2==e.length?r+=append3bytes(e.charCodeAt(i),e.charCodeAt(i+1),0):i+1==e.length?r+=append3bytes(e.charCodeAt(i),0,0):r+=append3bytes(e.charCodeAt(i),e.charCodeAt(i+1),e.charCodeAt(i+2));return r}function append3bytes(e,t,n){return c1=e>>2,c2=(e&3)<<4|t>>4,c3=(t&15)<<2|n>>6,c4=n&63,r="",r+=encode6bit(c1&63),r+=encode6bit(c2&63),r+=encode6bit(c3&63),r+=encode6bit(c4&63),r}function encode6bit(e){return e<10?String.fromCharCode(48+e):(e-=10,e<26?String.fromCharCode(65+e):(e-=26,e<26?String.fromCharCode(97+e):(e-=26,e==0?"-":e==1?"_":"?")))}var deflater=window.SharedWorker&&new SharedWorker("/js/rawdeflate.js");deflater?(deflater.port.addEventListener("message",done_deflating,!1),deflater.port.start()):window.Worker&&(deflater=new Worker("/js/rawdeflate.js"),deflater.onmessage=done_deflating);function done_deflating(e){const s=document.getElementById("plantuml-"),t="https://www.plantuml.com/plantuml/img/"+encode64(e.data);s.src=t;const n=document.getElementById("plantuml-link-");n&&(n.href=t)}function compress(e){e=unescape(encodeURIComponent(e)),deflater?deflater.port&&deflater.port.postMessage?deflater.port.postMessage(e):deflater.postMessage(e):setTimeout(function(){done_deflating({data:deflate(e)})},100)}compress(`
@startuml
!define ICONURL https://raw.githubusercontent.com/tupadr3/plantuml-icon-font-sprites/v2.4.0
!includeurl ICONURL/common.puml
!includeurl ICONURL/devicons2/docker.puml
!includeurl ICONURL/font-awesome-5/shield-alt.puml
!includeurl ICONURL/aws/SecurityIdentityCompliance/aws-identity-and-access-management.puml

title Container Security Pipeline

participant Developer as dev
participant "CI/CD Pipeline" as pipeline
participant "Image Registry" as registry
participant "Security Scanner" as scanner
participant "Runtime Environment" as runtime

dev -> pipeline: Push Code
activate pipeline

pipeline -> pipeline: Build Container Image
pipeline -> scanner: Initiate Security Scan
activate scanner

scanner -> scanner: Vulnerability Analysis
scanner -> scanner: Compliance Check
scanner -> scanner: Risk Assessment

alt Scan Passes
    scanner -> pipeline: Security Approved
    pipeline -> registry: Push Secure Image
    pipeline -> runtime: Deploy Container
    runtime -> runtime: Runtime Security Monitoring
else Scan Fails
    scanner -> pipeline: Security Violation
    pipeline -> dev: Block Deployment
    pipeline -> pipeline: Trigger Remediation
end

deactivate scanner
deactivate pipeline
@enduml
`)</script><h2 id=serverless-security-architecture>Serverless Security Architecture</h2><p>Serverless security requires a fundamentally different approach than traditional application security because the underlying infrastructure is completely abstracted away from developers. This abstraction eliminates many traditional security concerns like OS patching and network configuration but introduces new challenges around function boundaries, execution context, and event-driven security models. The serverless execution model creates unique attack vectors that must be addressed through function-level security controls and comprehensive monitoring.</p><p>The shared responsibility model in serverless computing places the burden of application-level security squarely on the development team while the cloud provider handles infrastructure security. This division requires developers to understand which security controls they&rsquo;re responsible for implementing and which are provided by the platform. The challenge lies in creating comprehensive security coverage without the traditional tools and techniques that rely on persistent infrastructure components.</p><p>Serverless functions often process sensitive data from multiple sources, making data flow security a critical consideration. Each function invocation creates a new execution context, which can be both a security advantage and a challenge. While this isolation prevents certain types of attacks, it also makes traditional security monitoring and incident response more complex because the infrastructure that processes the request may no longer exist by the time a security event is detected.</p><p>Here&rsquo;s a comprehensive serverless security implementation that addresses these unique challenges:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// serverless-security-framework.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>APIGatewayProxyEvent</span>, <span style=color:#a6e22e>APIGatewayProxyResult</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;aws-lambda&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>KMSClient</span>, <span style=color:#a6e22e>DecryptCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-kms&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CloudWatchLogsClient</span>, <span style=color:#a6e22e>PutLogEventsCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-cloudwatch-logs&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>SecretsManagerClient</span>, <span style=color:#a6e22e>GetSecretValueCommand</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@aws-sdk/client-secrets-manager&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>crypto</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;crypto&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SecurityContext</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>requestId</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>userId?</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sessionId?</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sourceIp</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>userAgent</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>Date</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>functionName</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>functionVersion</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SecurityEvent</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>eventType</span>: <span style=color:#66d9ef>SecurityEventType</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>SecuritySeverity</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>SecurityContext</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>details</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>string</span>, <span style=color:#a6e22e>any</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>remediation?</span>: <span style=color:#66d9ef>SecurityRemediation</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>SecurityEventType</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>AUTHENTICATION_FAILURE</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AUTHENTICATION_FAILURE&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>AUTHORIZATION_VIOLATION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AUTHORIZATION_VIOLATION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>SUSPICIOUS_ACTIVITY</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;SUSPICIOUS_ACTIVITY&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>DATA_ACCESS_VIOLATION</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;DATA_ACCESS_VIOLATION&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>INJECTION_ATTEMPT</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;INJECTION_ATTEMPT&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>RATE_LIMIT_EXCEEDED</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;RATE_LIMIT_EXCEEDED&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>SecuritySeverity</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CRITICAL</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CRITICAL&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>HIGH</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>MEDIUM</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>LOW</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;LOW&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>INFO</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;INFO&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SecurityRemediation</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>action</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;BLOCK&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;THROTTLE&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;ALERT&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;LOG&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>duration?</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>notificationChannels?</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ServerlessSecurityFramework</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>kmsClient</span>: <span style=color:#66d9ef>KMSClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>cloudWatchClient</span>: <span style=color:#66d9ef>CloudWatchLogsClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>secretsClient</span>: <span style=color:#66d9ef>SecretsManagerClient</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>securityEvents</span>: <span style=color:#66d9ef>SecurityEvent</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>kmsClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>KMSClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cloudWatchClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CloudWatchLogsClient</span>({});
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>secretsClient</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>SecretsManagerClient</span>({});
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createSecurityWrapper</span>&lt;<span style=color:#f92672>T</span> <span style=color:#a6e22e>extends</span> <span style=color:#a6e22e>any</span><span style=color:#960050;background-color:#1e0010>[]</span>, <span style=color:#a6e22e>R</span>&gt;(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>handler</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>event</span>: <span style=color:#66d9ef>APIGatewayProxyEvent</span>, <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>Context</span>, ...<span style=color:#a6e22e>args</span>: <span style=color:#66d9ef>T</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>R</span>&gt;,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>securityConfig</span>: <span style=color:#66d9ef>SecurityConfiguration</span>
</span></span><span style=display:flex><span>  ) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>event</span>: <span style=color:#66d9ef>APIGatewayProxyEvent</span>, <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>Context</span>, ...<span style=color:#a6e22e>args</span>: <span style=color:#66d9ef>T</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>R</span> <span style=color:#960050;background-color:#1e0010>|</span> <span style=color:#a6e22e>APIGatewayProxyResult</span>&gt; <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>securityContext</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>createSecurityContext</span>(<span style=color:#a6e22e>event</span>, <span style=color:#a6e22e>context</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Pre-execution security checks
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>performPreExecutionChecks</span>(<span style=color:#a6e22e>event</span>, <span style=color:#a6e22e>securityContext</span>, <span style=color:#a6e22e>securityConfig</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Execute the wrapped function with monitoring
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>startTime</span> <span style=color:#f92672>=</span> Date.<span style=color:#a6e22e>now</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>executeWithMonitoring</span>(<span style=color:#a6e22e>handler</span>, <span style=color:#a6e22e>event</span>, <span style=color:#a6e22e>context</span>, <span style=color:#a6e22e>args</span>, <span style=color:#a6e22e>securityContext</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>executionTime</span> <span style=color:#f92672>=</span> Date.<span style=color:#a6e22e>now</span>() <span style=color:#f92672>-</span> <span style=color:#a6e22e>startTime</span>;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Post-execution security validation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>performPostExecutionChecks</span>(<span style=color:#a6e22e>result</span>, <span style=color:#a6e22e>securityContext</span>, <span style=color:#a6e22e>executionTime</span>, <span style=color:#a6e22e>securityConfig</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>;
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>handleSecurityException</span>(<span style=color:#a6e22e>error</span>, <span style=color:#a6e22e>securityContext</span>, <span style=color:#a6e22e>securityConfig</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>finally</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Always log security events
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>flushSecurityEvents</span>();
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>createSecurityContext</span>(<span style=color:#a6e22e>event</span>: <span style=color:#66d9ef>APIGatewayProxyEvent</span>, <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>Context</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>SecurityContext</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>requestId</span>: <span style=color:#66d9ef>context.awsRequestId</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>userId</span>: <span style=color:#66d9ef>this.extractUserId</span>(<span style=color:#a6e22e>event</span>),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sessionId</span>: <span style=color:#66d9ef>this.extractSessionId</span>(<span style=color:#a6e22e>event</span>),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sourceIp</span>: <span style=color:#66d9ef>event.requestContext.identity.sourceIp</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>userAgent</span>: <span style=color:#66d9ef>event.headers</span>[<span style=color:#e6db74>&#39;User-Agent&#39;</span>] <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;unknown&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>new</span> Date(),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>functionName</span>: <span style=color:#66d9ef>context.functionName</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>functionVersion</span>: <span style=color:#66d9ef>context.functionVersion</span>
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>performPreExecutionChecks</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>event</span>: <span style=color:#66d9ef>APIGatewayProxyEvent</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>securityContext</span>: <span style=color:#66d9ef>SecurityContext</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>config</span>: <span style=color:#66d9ef>SecurityConfiguration</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Rate limiting check
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>rateLimiting</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>enabled</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>checkRateLimit</span>(<span style=color:#a6e22e>securityContext</span>, <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>rateLimiting</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Input validation and sanitization
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>inputValidation</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>enabled</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>validateAndSanitizeInput</span>(<span style=color:#a6e22e>event</span>, <span style=color:#a6e22e>securityContext</span>, <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>inputValidation</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Authentication validation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>authentication</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>required</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>validateAuthentication</span>(<span style=color:#a6e22e>event</span>, <span style=color:#a6e22e>securityContext</span>, <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>authentication</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Authorization check
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>authorization</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>enabled</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>checkAuthorization</span>(<span style=color:#a6e22e>event</span>, <span style=color:#a6e22e>securityContext</span>, <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>authorization</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Threat detection
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>threatDetection</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>enabled</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>performThreatDetection</span>(<span style=color:#a6e22e>event</span>, <span style=color:#a6e22e>securityContext</span>, <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>threatDetection</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>checkRateLimit</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>securityContext</span>: <span style=color:#66d9ef>SecurityContext</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rateLimitConfig</span>: <span style=color:#66d9ef>RateLimitConfiguration</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>key</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>securityContext</span>.<span style=color:#a6e22e>sourceIp</span><span style=color:#e6db74>}</span><span style=color:#e6db74>:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>securityContext</span>.<span style=color:#a6e22e>functionName</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>currentTime</span> <span style=color:#f92672>=</span> Date.<span style=color:#a6e22e>now</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>windowStart</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>currentTime</span> <span style=color:#f92672>-</span> (<span style=color:#a6e22e>rateLimitConfig</span>.<span style=color:#a6e22e>windowMs</span> <span style=color:#f92672>||</span> <span style=color:#ae81ff>60000</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Implementation would check against a distributed cache like ElastiCache
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// For this example, we&#39;ll simulate the rate limiting logic
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>requestCount</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getRequestCount</span>(<span style=color:#a6e22e>key</span>, <span style=color:#a6e22e>windowStart</span>, <span style=color:#a6e22e>currentTime</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>requestCount</span> <span style=color:#f92672>&gt;</span> (<span style=color:#a6e22e>rateLimitConfig</span>.<span style=color:#a6e22e>maxRequests</span> <span style=color:#f92672>||</span> <span style=color:#ae81ff>100</span>)) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>securityEvent</span>: <span style=color:#66d9ef>SecurityEvent</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>eventType</span>: <span style=color:#66d9ef>SecurityEventType.RATE_LIMIT_EXCEEDED</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>SecuritySeverity.MEDIUM</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>securityContext</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>details</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>requestCount</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>limit</span>: <span style=color:#66d9ef>rateLimitConfig.maxRequests</span>,
</span></span><span style=display:flex><span>          window<span style=color:#f92672>:</span> <span style=color:#a6e22e>rateLimitConfig</span>.<span style=color:#a6e22e>windowMs</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>remediation</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>action</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;THROTTLE&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>duration</span>: <span style=color:#66d9ef>rateLimitConfig.blockDurationMs</span> <span style=color:#f92672>||</span> <span style=color:#ae81ff>300000</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>securityEvents</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>securityEvent</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>&#39;Rate limit exceeded&#39;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>validateAndSanitizeInput</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>event</span>: <span style=color:#66d9ef>APIGatewayProxyEvent</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>securityContext</span>: <span style=color:#66d9ef>SecurityContext</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>inputConfig</span>: <span style=color:#66d9ef>InputValidationConfiguration</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>potentialThreats</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>scanForThreats</span>(<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>body</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;&#39;</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>potentialThreats</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>securityEvent</span>: <span style=color:#66d9ef>SecurityEvent</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>eventType</span>: <span style=color:#66d9ef>SecurityEventType.INJECTION_ATTEMPT</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>SecuritySeverity.HIGH</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>securityContext</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>details</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>threats</span>: <span style=color:#66d9ef>potentialThreats</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>payload</span>: <span style=color:#66d9ef>this.sanitizeForLogging</span>(<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>body</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>remediation</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>action</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;BLOCK&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>notificationChannels</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;security-alerts&#39;</span>]
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>securityEvents</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>securityEvent</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>inputConfig</span>.<span style=color:#a6e22e>blockOnThreat</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>&#39;Malicious input detected&#39;</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>scanForThreats</span>(<span style=color:#a6e22e>input</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>[] {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>threats</span>: <span style=color:#66d9ef>string</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// SQL injection patterns
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sqlPatterns</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>      <span style=color:#e6db74>/(\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER)\b)/i</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>/(UNION\s+SELECT)/i</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>/(OR\s+1\s*=\s*1)/i</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>/(&#39;;\s*--)/i</span>
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// XSS patterns
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>xssPatterns</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>      <span style=color:#e6db74>/&lt;script[^&gt;]*&gt;.*?&lt;\/script&gt;/gi</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>/(javascript:|vbscript:|onload=|onerror=)/i</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>/&lt;iframe[^&gt;]*&gt;.*?&lt;\/iframe&gt;/gi</span>
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Command injection patterns
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>commandPatterns</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>      <span style=color:#e6db74>/(;\s*rm\s+-rf)/i</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>/(&amp;&amp;\s*cat\s+\/etc\/passwd)/i</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>/(\|\s*nc\s+)/i</span>
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    [...<span style=color:#a6e22e>sqlPatterns</span>, ...<span style=color:#a6e22e>xssPatterns</span>, ...<span style=color:#a6e22e>commandPatterns</span>].<span style=color:#a6e22e>forEach</span>(<span style=color:#a6e22e>pattern</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>pattern</span>.<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>input</span>)) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>threats</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>pattern</span>.<span style=color:#a6e22e>source</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>threats</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>validateAuthentication</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>event</span>: <span style=color:#66d9ef>APIGatewayProxyEvent</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>securityContext</span>: <span style=color:#66d9ef>SecurityContext</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>authConfig</span>: <span style=color:#66d9ef>AuthenticationConfiguration</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>authHeader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>headers</span>.<span style=color:#a6e22e>Authorization</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>headers</span>.<span style=color:#a6e22e>authorization</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>authHeader</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>securityEvent</span>: <span style=color:#66d9ef>SecurityEvent</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>eventType</span>: <span style=color:#66d9ef>SecurityEventType.AUTHENTICATION_FAILURE</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>SecuritySeverity.MEDIUM</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>securityContext</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>details</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>reason</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Missing authorization header&#39;</span> }
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>securityEvents</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>securityEvent</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>&#39;Authentication required&#39;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>token</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>authHeader</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>&#39;Bearer &#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isValid</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>verifyJWTToken</span>(<span style=color:#a6e22e>token</span>, <span style=color:#a6e22e>authConfig</span>.<span style=color:#a6e22e>jwtConfig</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>isValid</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>securityEvent</span>: <span style=color:#66d9ef>SecurityEvent</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>eventType</span>: <span style=color:#66d9ef>SecurityEventType.AUTHENTICATION_FAILURE</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>SecuritySeverity.HIGH</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>securityContext</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>details</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>reason</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Invalid JWT token&#39;</span> }
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>securityEvents</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>securityEvent</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>&#39;Invalid authentication token&#39;</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>securityEvent</span>: <span style=color:#66d9ef>SecurityEvent</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>eventType</span>: <span style=color:#66d9ef>SecurityEventType.AUTHENTICATION_FAILURE</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>SecuritySeverity.HIGH</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>securityContext</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>details</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>reason</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Token verification failed&#39;</span>, <span style=color:#a6e22e>error</span>: <span style=color:#66d9ef>error.message</span> }
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>securityEvents</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>securityEvent</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>executeWithMonitoring</span>&lt;<span style=color:#f92672>T</span> <span style=color:#a6e22e>extends</span> <span style=color:#a6e22e>any</span><span style=color:#960050;background-color:#1e0010>[]</span>, <span style=color:#a6e22e>R</span>&gt;(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>handler</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>event</span>: <span style=color:#66d9ef>APIGatewayProxyEvent</span>, <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>Context</span>, ...<span style=color:#a6e22e>args</span>: <span style=color:#66d9ef>T</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>R</span>&gt;,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>event</span>: <span style=color:#66d9ef>APIGatewayProxyEvent</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>Context</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>args</span>: <span style=color:#66d9ef>T</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>securityContext</span>: <span style=color:#66d9ef>SecurityContext</span>
</span></span><span style=display:flex><span>  )<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>R</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>monitoringWrapper</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>createExecutionMonitor</span>(<span style=color:#a6e22e>securityContext</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>monitoringWrapper</span>(() <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>handler</span>(<span style=color:#a6e22e>event</span>, <span style=color:#a6e22e>context</span>, ...<span style=color:#a6e22e>args</span>));
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Log execution errors for security analysis
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>securityEvent</span>: <span style=color:#66d9ef>SecurityEvent</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>eventType</span>: <span style=color:#66d9ef>SecurityEventType.SUSPICIOUS_ACTIVITY</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>SecuritySeverity.MEDIUM</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>securityContext</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>details</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>errorType</span>: <span style=color:#66d9ef>error.constructor.name</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>errorMessage</span>: <span style=color:#66d9ef>error.message</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>stackTrace</span>: <span style=color:#66d9ef>this.sanitizeStackTrace</span>(<span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>stack</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>securityEvents</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>securityEvent</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>createExecutionMonitor</span>(<span style=color:#a6e22e>securityContext</span>: <span style=color:#66d9ef>SecurityContext</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>async</span> &lt;<span style=color:#f92672>T</span>&gt;(<span style=color:#a6e22e>operation</span><span style=color:#f92672>:</span> () <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>T</span>&gt;)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>T</span>&gt; <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>startTime</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>hrtime</span>.<span style=color:#66d9ef>bigint</span>();
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>startMemory</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>memoryUsage</span>();
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>operation</span>();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>endTime</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>hrtime</span>.<span style=color:#66d9ef>bigint</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>endMemory</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>memoryUsage</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>executionTime</span> <span style=color:#f92672>=</span> Number(<span style=color:#a6e22e>endTime</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>startTime</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>1000000</span>; <span style=color:#75715e>// Convert to milliseconds
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Monitor for suspicious execution patterns
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>executionTime</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>30000</span>) { <span style=color:#75715e>// 30 seconds
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>securityEvent</span>: <span style=color:#66d9ef>SecurityEvent</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>eventType</span>: <span style=color:#66d9ef>SecurityEventType.SUSPICIOUS_ACTIVITY</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>severity</span>: <span style=color:#66d9ef>SecuritySeverity.MEDIUM</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>securityContext</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>details</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>reason</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Unusually long execution time&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>executionTimeMs</span>: <span style=color:#66d9ef>executionTime</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>memoryUsage</span>: <span style=color:#66d9ef>endMemory</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          };
</span></span><span style=display:flex><span>          
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>securityEvents</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>securityEvent</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>;
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>flushSecurityEvents</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>securityEvents</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>logEntries</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>securityEvents</span>.<span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>event</span> <span style=color:#f92672>=&gt;</span> ({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>event.context.timestamp.getTime</span>(),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>message</span>: <span style=color:#66d9ef>JSON.stringify</span>(<span style=color:#a6e22e>event</span>)
</span></span><span style=display:flex><span>    }));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>command</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PutLogEventsCommand</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>logGroupName</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/aws/lambda/security-events&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>logStreamName</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>Date.<span style=color:#a6e22e>now</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>crypto</span>.<span style=color:#a6e22e>randomUUID</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>logEvents</span>: <span style=color:#66d9ef>logEntries</span>
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cloudWatchClient</span>.<span style=color:#a6e22e>send</span>(<span style=color:#a6e22e>command</span>);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;Failed to flush security events:&#39;</span>, <span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Clear events after logging
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>securityEvents</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Helper methods
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>extractUserId</span>(<span style=color:#a6e22e>event</span>: <span style=color:#66d9ef>APIGatewayProxyEvent</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>undefined</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>requestContext</span>.<span style=color:#a6e22e>authorizer</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>claims</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>sub</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>extractSessionId</span>(<span style=color:#a6e22e>event</span>: <span style=color:#66d9ef>APIGatewayProxyEvent</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>undefined</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;X-Session-ID&#39;</span>] <span style=color:#f92672>||</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;x-session-id&#39;</span>];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>getRequestCount</span>(<span style=color:#a6e22e>key</span>: <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>windowStart</span>: <span style=color:#66d9ef>number</span>, <span style=color:#a6e22e>currentTime</span>: <span style=color:#66d9ef>number</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>number</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Implementation would query distributed cache
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#ae81ff>150</span>); <span style=color:#75715e>// Simulated for example
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>sanitizeForLogging</span>(<span style=color:#a6e22e>input</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>input</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/[&lt;&gt;\&#34;&#39;&amp;]/g</span>, <span style=color:#e6db74>&#39;*&#39;</span>).<span style=color:#a6e22e>substring</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>200</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>sanitizeStackTrace</span>(<span style=color:#a6e22e>stackTrace?</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>stackTrace</span>) <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;No stack trace available&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>stackTrace</span>.<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#39;\n&#39;</span>).<span style=color:#a6e22e>slice</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>).<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;\n&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>verifyJWTToken</span>(<span style=color:#a6e22e>token</span>: <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>jwtConfig</span>: <span style=color:#66d9ef>any</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>boolean</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Implementation would verify JWT token with appropriate library
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>token</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// Simplified for example
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Configuration interfaces
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SecurityConfiguration</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rateLimiting?</span>: <span style=color:#66d9ef>RateLimitConfiguration</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>inputValidation?</span>: <span style=color:#66d9ef>InputValidationConfiguration</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>authentication?</span>: <span style=color:#66d9ef>AuthenticationConfiguration</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>authorization?</span>: <span style=color:#66d9ef>AuthorizationConfiguration</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>threatDetection?</span>: <span style=color:#66d9ef>ThreatDetectionConfiguration</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>RateLimitConfiguration</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>enabled</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>maxRequests</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>windowMs</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>blockDurationMs?</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>InputValidationConfiguration</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>enabled</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>blockOnThreat</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sanitizeInput</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AuthenticationConfiguration</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>required</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>jwtConfig</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>issuer</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>audience</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>publicKeyUrl</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>AuthorizationConfiguration</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>enabled</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>roles</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>permissions</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ThreatDetectionConfiguration</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>enabled</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>anomalyDetection</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>behaviorAnalysis</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=runtime-security-monitoring>Runtime Security Monitoring</h2><p>Effective container and serverless security extends beyond deployment-time checks to include comprehensive runtime monitoring and threat detection. Traditional security monitoring approaches that rely on persistent agents and long-running processes don&rsquo;t translate well to ephemeral workloads, requiring new strategies that can capture and analyze security events in real-time without impacting application performance or reliability.</p><p>Runtime security monitoring for containers and serverless functions must account for the dynamic nature of these environments where workloads scale up and down rapidly based on demand. This elasticity means that security monitoring systems must be able to adapt to changing infrastructure patterns while maintaining consistent visibility across all running workloads. The challenge is creating monitoring solutions that provide comprehensive coverage without becoming performance bottlenecks.</p><p>Modern runtime security approaches leverage behavioral analysis and anomaly detection to identify potential threats that traditional signature-based systems might miss. By establishing baseline behavior patterns for applications and infrastructure components, security systems can identify deviations that might indicate compromised workloads or malicious activity. This approach is particularly effective in containerized and serverless environments where normal application behavior is typically well-defined and predictable.</p><p>The integration of security monitoring with observability platforms creates opportunities for correlation analysis that can identify complex attack patterns spanning multiple services and time periods. This holistic view is essential in distributed architectures where attacks might manifest as subtle changes across multiple components rather than obvious intrusions in a single system.</p><div class=plantuml-container><img id=plantuml- class=plantuml-diagram>
<a id=plantuml-link- href=# target=_blank class=plantuml-link title="Open diagram in new window"><span class=plantuml-link-icon>🔍</span></a></div><script src=/js/rawdeflate.js></script><script>function encode64(e){r="";for(i=0;i<e.length;i+=3)i+2==e.length?r+=append3bytes(e.charCodeAt(i),e.charCodeAt(i+1),0):i+1==e.length?r+=append3bytes(e.charCodeAt(i),0,0):r+=append3bytes(e.charCodeAt(i),e.charCodeAt(i+1),e.charCodeAt(i+2));return r}function append3bytes(e,t,n){return c1=e>>2,c2=(e&3)<<4|t>>4,c3=(t&15)<<2|n>>6,c4=n&63,r="",r+=encode6bit(c1&63),r+=encode6bit(c2&63),r+=encode6bit(c3&63),r+=encode6bit(c4&63),r}function encode6bit(e){return e<10?String.fromCharCode(48+e):(e-=10,e<26?String.fromCharCode(65+e):(e-=26,e<26?String.fromCharCode(97+e):(e-=26,e==0?"-":e==1?"_":"?")))}var deflater=window.SharedWorker&&new SharedWorker("/js/rawdeflate.js");deflater?(deflater.port.addEventListener("message",done_deflating,!1),deflater.port.start()):window.Worker&&(deflater=new Worker("/js/rawdeflate.js"),deflater.onmessage=done_deflating);function done_deflating(e){const s=document.getElementById("plantuml-"),t="https://www.plantuml.com/plantuml/img/"+encode64(e.data);s.src=t;const n=document.getElementById("plantuml-link-");n&&(n.href=t)}function compress(e){e=unescape(encodeURIComponent(e)),deflater?deflater.port&&deflater.port.postMessage?deflater.port.postMessage(e):deflater.postMessage(e):setTimeout(function(){done_deflating({data:deflate(e)})},100)}compress(`
@startuml
!define ICONURL https://raw.githubusercontent.com/tupadr3/plantuml-icon-font-sprites/v2.4.0
!includeurl ICONURL/common.puml
!includeurl ICONURL/font-awesome-5/shield-alt.puml
!includeurl ICONURL/font-awesome-5/eye.puml
!includeurl ICONURL/aws/Analytics/amazon-kinesis.puml

title Runtime Security Monitoring Architecture

package "Runtime Environment" {
  [Container 1] as c1
  [Container 2] as c2
  [Serverless Function 1] as sf1
  [Serverless Function 2] as sf2
}

package "Security Monitoring Layer" {
  [Security Agent] as agent
  [Behavioral Analysis] as behavior
  [Anomaly Detection] as anomaly
  [Threat Intelligence] as threat
}

package "Data Processing" {
  [Event Stream] as stream
  [Real-time Analytics] as analytics
  [Machine Learning] as ml
}

package "Response System" {
  [Alert Manager] as alerts
  [Automated Response] as response
  [Security Dashboard] as dashboard
}

c1 --> agent : Security Events
c2 --> agent : Security Events
sf1 --> agent : Security Events
sf2 --> agent : Security Events

agent --> stream : Event Data
stream --> analytics : Real-time Processing
analytics --> behavior : Behavioral Data
analytics --> anomaly : Anomaly Signals
analytics --> ml : Learning Data

behavior --> alerts : Behavior Violations
anomaly --> alerts : Anomaly Alerts
threat --> alerts : Threat Indicators

alerts --> response : Trigger Response
alerts --> dashboard : Security Alerts
response --> "Runtime Environment" : Remediation Actions

@enduml
`)</script><h2 id=container-orchestration-security>Container Orchestration Security</h2><p>Container orchestration platforms like Kubernetes introduce additional security layers that must be carefully configured and monitored to maintain the security posture of containerized applications. The complexity of orchestration systems creates numerous potential misconfiguration opportunities that can lead to security vulnerabilities, making platform-specific security controls essential components of any container security strategy.</p><p>Network security in orchestrated environments requires sophisticated policy management to control inter-service communication while maintaining the flexibility that makes microservices architectures valuable. Network policies must be designed to provide appropriate isolation between workloads while allowing necessary communication patterns. The challenge lies in creating policies that are both secure and maintainable as applications evolve over time.</p><p>Resource management and scheduling in orchestrated environments present unique security considerations because compromised workloads might attempt to consume excessive resources or interfere with other applications running on shared infrastructure. Security controls must prevent resource exhaustion attacks while ensuring that legitimate workloads receive adequate resources to function properly.</p><p>Here&rsquo;s an implementation of comprehensive orchestration security controls:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// kubernetes-security-controller.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CoreV1Api</span>, <span style=color:#a6e22e>NetworkingV1Api</span>, <span style=color:#a6e22e>RbacAuthorizationV1Api</span>, <span style=color:#a6e22e>KubeConfig</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@kubernetes/client-node&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>SecurityPolicy</span>, <span style=color:#a6e22e>ResourceQuota</span>, <span style=color:#a6e22e>NetworkPolicy</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./types/kubernetes-security&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>KubernetesSecurityConfiguration</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>namespaceIsolation</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>networkPolicies</span>: <span style=color:#66d9ef>NetworkPolicyRule</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resourceQuotas</span>: <span style=color:#66d9ef>ResourceQuotaRule</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>securityContexts</span>: <span style=color:#66d9ef>SecurityContextRule</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>imagePolicies</span>: <span style=color:#66d9ef>ImagePolicyRule</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rbacPolicies</span>: <span style=color:#66d9ef>RBACPolicyRule</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>NetworkPolicyRule</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>namespace</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>podSelector</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>string</span>, <span style=color:#a6e22e>string</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>policyTypes</span><span style=color:#f92672>:</span> (<span style=color:#e6db74>&#39;Ingress&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;Egress&#39;</span>)[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ingress?</span>: <span style=color:#66d9ef>IngressRule</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>egress?</span>: <span style=color:#66d9ef>EgressRule</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>IngressRule</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>from</span><span style=color:#f92672>?:</span> <span style=color:#a6e22e>NetworkPolicyPeer</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ports?</span>: <span style=color:#66d9ef>NetworkPolicyPort</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>EgressRule</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>to?</span>: <span style=color:#66d9ef>NetworkPolicyPeer</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ports?</span>: <span style=color:#66d9ef>NetworkPolicyPort</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>NetworkPolicyPeer</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>podSelector?</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>string</span>, <span style=color:#a6e22e>string</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>namespaceSelector?</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>string</span>, <span style=color:#a6e22e>string</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ipBlock</span><span style=color:#f92672>?:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cidr</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>except?</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>NetworkPolicyPort</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>protocol</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;TCP&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;UDP&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;SCTP&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>port</span>: <span style=color:#66d9ef>number</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>KubernetesSecurityController</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>coreApi</span>: <span style=color:#66d9ef>CoreV1Api</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>networkingApi</span>: <span style=color:#66d9ef>NetworkingV1Api</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>rbacApi</span>: <span style=color:#66d9ef>RbacAuthorizationV1Api</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#a6e22e>kubeConfig</span>: <span style=color:#66d9ef>KubeConfig</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>constructor</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>kubeConfig</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>KubeConfig</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>kubeConfig</span>.<span style=color:#a6e22e>loadFromDefault</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>coreApi</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>kubeConfig</span>.<span style=color:#a6e22e>makeApiClient</span>(<span style=color:#a6e22e>CoreV1Api</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>networkingApi</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>kubeConfig</span>.<span style=color:#a6e22e>makeApiClient</span>(<span style=color:#a6e22e>NetworkingV1Api</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rbacApi</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>kubeConfig</span>.<span style=color:#a6e22e>makeApiClient</span>(<span style=color:#a6e22e>RbacAuthorizationV1Api</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>applySecurityConfiguration</span>(<span style=color:#a6e22e>config</span>: <span style=color:#66d9ef>KubernetesSecurityConfiguration</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Apply network policies for network segmentation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>applyNetworkPolicies</span>(<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>networkPolicies</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Configure resource quotas to prevent resource exhaustion
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>applyResourceQuotas</span>(<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>resourceQuotas</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Apply RBAC policies for access control
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>applyRBACPolicies</span>(<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>rbacPolicies</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Validate security contexts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>validateSecurityContexts</span>(<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>securityContexts</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Enforce image policies
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>enforceImagePolicies</span>(<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>imagePolicies</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Security configuration applied successfully&#39;</span>);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;Failed to apply security configuration:&#39;</span>, <span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>applyNetworkPolicies</span>(<span style=color:#a6e22e>policies</span>: <span style=color:#66d9ef>NetworkPolicyRule</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>policyRule</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>policies</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>networkPolicy</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>apiVersion</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;networking.k8s.io/v1&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>kind</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;NetworkPolicy&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>metadata</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>policyRule.name</span>,
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>namespace</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>policyRule</span>.<span style=color:#66d9ef>namespace</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>spec</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>podSelector</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>matchLabels</span>: <span style=color:#66d9ef>policyRule.podSelector</span>
</span></span><span style=display:flex><span>          },
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>policyTypes</span>: <span style=color:#66d9ef>policyRule.policyTypes</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>ingress</span>: <span style=color:#66d9ef>policyRule.ingress?.map</span>(<span style=color:#a6e22e>rule</span> <span style=color:#f92672>=&gt;</span> ({
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>from</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>rule</span>.<span style=color:#66d9ef>from</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>peer</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>convertNetworkPolicyPeer</span>(<span style=color:#a6e22e>peer</span>)),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>ports</span>: <span style=color:#66d9ef>rule.ports?.map</span>(<span style=color:#a6e22e>port</span> <span style=color:#f92672>=&gt;</span> ({
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>protocol</span>: <span style=color:#66d9ef>port.protocol</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>port</span>: <span style=color:#66d9ef>port.port</span>
</span></span><span style=display:flex><span>            }))
</span></span><span style=display:flex><span>          })),
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>egress</span>: <span style=color:#66d9ef>policyRule.egress?.map</span>(<span style=color:#a6e22e>rule</span> <span style=color:#f92672>=&gt;</span> ({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>to</span>: <span style=color:#66d9ef>rule.to?.map</span>(<span style=color:#a6e22e>peer</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>convertNetworkPolicyPeer</span>(<span style=color:#a6e22e>peer</span>)),
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>ports</span>: <span style=color:#66d9ef>rule.ports?.map</span>(<span style=color:#a6e22e>port</span> <span style=color:#f92672>=&gt;</span> ({
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>protocol</span>: <span style=color:#66d9ef>port.protocol</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>port</span>: <span style=color:#66d9ef>port.port</span>
</span></span><span style=display:flex><span>            }))
</span></span><span style=display:flex><span>          }))
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>networkingApi</span>.<span style=color:#a6e22e>createNamespacedNetworkPolicy</span>(
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>policyRule</span>.<span style=color:#66d9ef>namespace</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>networkPolicy</span>
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`Network policy </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>policyRule</span>.<span style=color:#a6e22e>name</span><span style=color:#e6db74>}</span><span style=color:#e6db74> applied to namespace </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>policyRule</span>.<span style=color:#66d9ef>namespace</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>: <span style=color:#66d9ef>any</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>statusCode</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>409</span>) {
</span></span><span style=display:flex><span>          <span style=color:#75715e>// Policy already exists, update it
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>networkingApi</span>.<span style=color:#a6e22e>replaceNamespacedNetworkPolicy</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>policyRule</span>.<span style=color:#a6e22e>name</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>policyRule</span>.<span style=color:#66d9ef>namespace</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>networkPolicy</span>
</span></span><span style=display:flex><span>          );
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`Network policy </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>policyRule</span>.<span style=color:#a6e22e>name</span><span style=color:#e6db74>}</span><span style=color:#e6db74> updated in namespace </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>policyRule</span>.<span style=color:#66d9ef>namespace</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>convertNetworkPolicyPeer</span>(<span style=color:#a6e22e>peer</span>: <span style=color:#66d9ef>NetworkPolicyPeer</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>any</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>converted</span>: <span style=color:#66d9ef>any</span> <span style=color:#f92672>=</span> {};
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>peer</span>.<span style=color:#a6e22e>podSelector</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>converted</span>.<span style=color:#a6e22e>podSelector</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>matchLabels</span>: <span style=color:#66d9ef>peer.podSelector</span> };
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>peer</span>.<span style=color:#a6e22e>namespaceSelector</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>converted</span>.<span style=color:#a6e22e>namespaceSelector</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>matchLabels</span>: <span style=color:#66d9ef>peer.namespaceSelector</span> };
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>peer</span>.<span style=color:#a6e22e>ipBlock</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>converted</span>.<span style=color:#a6e22e>ipBlock</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>cidr</span>: <span style=color:#66d9ef>peer.ipBlock.cidr</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>except</span>: <span style=color:#66d9ef>peer.ipBlock.except</span>
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>converted</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>applyResourceQuotas</span>(<span style=color:#a6e22e>quotas</span>: <span style=color:#66d9ef>ResourceQuotaRule</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>quotaRule</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>quotas</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>resourceQuota</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>apiVersion</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;v1&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>kind</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;ResourceQuota&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>metadata</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>quotaRule.name</span>,
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>namespace</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>quotaRule</span>.<span style=color:#66d9ef>namespace</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>spec</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>hard</span>: <span style=color:#66d9ef>quotaRule.hard</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>coreApi</span>.<span style=color:#a6e22e>createNamespacedResourceQuota</span>(
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>quotaRule</span>.<span style=color:#66d9ef>namespace</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>resourceQuota</span>
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`Resource quota </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>quotaRule</span>.<span style=color:#a6e22e>name</span><span style=color:#e6db74>}</span><span style=color:#e6db74> applied to namespace </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>quotaRule</span>.<span style=color:#66d9ef>namespace</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>: <span style=color:#66d9ef>any</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>statusCode</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>409</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>coreApi</span>.<span style=color:#a6e22e>replaceNamespacedResourceQuota</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>quotaRule</span>.<span style=color:#a6e22e>name</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>quotaRule</span>.<span style=color:#66d9ef>namespace</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>resourceQuota</span>
</span></span><span style=display:flex><span>          );
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`Resource quota </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>quotaRule</span>.<span style=color:#a6e22e>name</span><span style=color:#e6db74>}</span><span style=color:#e6db74> updated in namespace </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>quotaRule</span>.<span style=color:#66d9ef>namespace</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>applyRBACPolicies</span>(<span style=color:#a6e22e>policies</span>: <span style=color:#66d9ef>RBACPolicyRule</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>policy</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>policies</span>) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Create Role
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>role</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>apiVersion</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;rbac.authorization.k8s.io/v1&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>kind</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Role&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>metadata</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>policy.roleName</span>,
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>namespace</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>policy</span>.<span style=color:#66d9ef>namespace</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>rules</span>: <span style=color:#66d9ef>policy.rules</span>
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rbacApi</span>.<span style=color:#a6e22e>createNamespacedRole</span>(<span style=color:#a6e22e>policy</span>.<span style=color:#66d9ef>namespace</span>, <span style=color:#a6e22e>role</span>);
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>: <span style=color:#66d9ef>any</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>statusCode</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>409</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rbacApi</span>.<span style=color:#a6e22e>replaceNamespacedRole</span>(
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>policy</span>.<span style=color:#a6e22e>roleName</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>policy</span>.<span style=color:#66d9ef>namespace</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>role</span>
</span></span><span style=display:flex><span>          );
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Create RoleBinding
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>roleBinding</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>apiVersion</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;rbac.authorization.k8s.io/v1&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>kind</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;RoleBinding&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>metadata</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>policy</span>.<span style=color:#a6e22e>roleName</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-binding`</span>,
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>namespace</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>policy</span>.<span style=color:#66d9ef>namespace</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>subjects</span>: <span style=color:#66d9ef>policy.subjects</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>roleRef</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>kind</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Role&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>policy.roleName</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>apiGroup</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;rbac.authorization.k8s.io&#39;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rbacApi</span>.<span style=color:#a6e22e>createNamespacedRoleBinding</span>(<span style=color:#a6e22e>policy</span>.<span style=color:#66d9ef>namespace</span>, <span style=color:#a6e22e>roleBinding</span>);
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>: <span style=color:#66d9ef>any</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>statusCode</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>409</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rbacApi</span>.<span style=color:#a6e22e>replaceNamespacedRoleBinding</span>(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>policy</span>.<span style=color:#a6e22e>roleName</span><span style=color:#e6db74>}</span><span style=color:#e6db74>-binding`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>policy</span>.<span style=color:#66d9ef>namespace</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>roleBinding</span>
</span></span><span style=display:flex><span>          );
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`RBAC policy </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>policy</span>.<span style=color:#a6e22e>roleName</span><span style=color:#e6db74>}</span><span style=color:#e6db74> applied to namespace </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>policy</span>.<span style=color:#66d9ef>namespace</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>scanClusterSecurity</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>SecurityScanResult</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>results</span>: <span style=color:#66d9ef>SecurityScanResult</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>new</span> Date().<span style=color:#a6e22e>toISOString</span>(),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>overallScore</span>: <span style=color:#66d9ef>0</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>findings</span><span style=color:#f92672>:</span> [],
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>recommendations</span><span style=color:#f92672>:</span> []
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Check for privileged containers
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>checkPrivilegedContainers</span>(<span style=color:#a6e22e>results</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Validate network policies
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>validateNetworkPolicies</span>(<span style=color:#a6e22e>results</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Check resource quotas
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>checkResourceQuotas</span>(<span style=color:#a6e22e>results</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Validate RBAC configuration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>validateRBACConfiguration</span>(<span style=color:#a6e22e>results</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Check for security contexts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>checkSecurityContexts</span>(<span style=color:#a6e22e>results</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Calculate overall security score
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>results</span>.<span style=color:#a6e22e>overallScore</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateSecurityScore</span>(<span style=color:#a6e22e>results</span>.<span style=color:#a6e22e>findings</span>);
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>results</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;Security scan failed:&#39;</span>, <span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>checkPrivilegedContainers</span>(<span style=color:#a6e22e>results</span>: <span style=color:#66d9ef>SecurityScanResult</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pods</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>coreApi</span>.<span style=color:#a6e22e>listPodForAllNamespaces</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pod</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>pods</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>items</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>pod</span>.<span style=color:#a6e22e>spec</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>containers</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>container</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>pod</span>.<span style=color:#a6e22e>spec</span>.<span style=color:#a6e22e>containers</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>container</span>.<span style=color:#a6e22e>securityContext</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>privileged</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>results</span>.<span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>severity</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;HIGH&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>category</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;CONTAINER_SECURITY&#39;</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`Privileged container found: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>container</span>.<span style=color:#a6e22e>name</span><span style=color:#e6db74>}</span><span style=color:#e6db74> in pod </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pod</span>.<span style=color:#a6e22e>metadata</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>name</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>namespace</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pod</span>.<span style=color:#a6e22e>metadata</span><span style=color:#f92672>?</span>.<span style=color:#66d9ef>namespace</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>resource</span>: <span style=color:#66d9ef>pod.metadata?.name</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>remediation</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Remove privileged flag unless absolutely necessary&#39;</span>
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>validateNetworkPolicies</span>(<span style=color:#a6e22e>results</span>: <span style=color:#66d9ef>SecurityScanResult</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span>&lt;<span style=color:#f92672>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>namespaces</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>coreApi</span>.<span style=color:#a6e22e>listNamespace</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>namespace</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>namespaces</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>items</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>namespaceName</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>namespace</span>.<span style=color:#a6e22e>metadata</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>name</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>namespaceName</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>namespaceName</span>.<span style=color:#a6e22e>startsWith</span>(<span style=color:#e6db74>&#39;kube-&#39;</span>)) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>networkPolicies</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>networkingApi</span>.<span style=color:#a6e22e>listNamespacedNetworkPolicy</span>(<span style=color:#a6e22e>namespaceName</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>networkPolicies</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>items</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>results</span>.<span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>severity</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>category</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;NETWORK_SECURITY&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`No network policies found in namespace: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>namespaceName</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>namespace</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>namespaceName</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>remediation</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Implement network policies to control pod-to-pod communication&#39;</span>
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>warn</span>(<span style=color:#e6db74>`Failed to check network policies for namespace </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>namespaceName</span><span style=color:#e6db74>}</span><span style=color:#e6db74>:`</span>, <span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>calculateSecurityScore</span>(<span style=color:#a6e22e>findings</span>: <span style=color:#66d9ef>SecurityFinding</span>[])<span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>severityWeights</span> <span style=color:#f92672>=</span> { <span style=color:#e6db74>&#39;CRITICAL&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>, <span style=color:#e6db74>&#39;HIGH&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>7</span>, <span style=color:#e6db74>&#39;MEDIUM&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>4</span>, <span style=color:#e6db74>&#39;LOW&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span> };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>totalDeductions</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>findings</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>total</span>, <span style=color:#a6e22e>finding</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>total</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>severityWeights</span>[<span style=color:#a6e22e>finding</span>.<span style=color:#a6e22e>severity</span>] <span style=color:#f92672>||</span> <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    }, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> Math.<span style=color:#a6e22e>max</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>totalDeductions</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Supporting types
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ResourceQuotaRule</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>namespace</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hard</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>string</span>, <span style=color:#a6e22e>string</span>&gt;;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SecurityContextRule</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>allowPrivileged</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>allowHostNetwork</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>allowHostPID</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>allowHostPorts</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>requiredSecurityContext</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>runAsNonRoot</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>readOnlyRootFilesystem</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>allowPrivilegeEscalation</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ImagePolicyRule</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>allowedRegistries</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>requiredLabels</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>string</span>, <span style=color:#a6e22e>string</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>scanRequired</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>maxAge</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>RBACPolicyRule</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>roleName</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>namespace</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rules</span>: <span style=color:#66d9ef>any</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>subjects</span>: <span style=color:#66d9ef>any</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SecurityScanResult</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>timestamp</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>overallScore</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>findings</span>: <span style=color:#66d9ef>SecurityFinding</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>recommendations</span>: <span style=color:#66d9ef>string</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SecurityFinding</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>severity</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;CRITICAL&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;HIGH&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;MEDIUM&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;LOW&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>category</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>namespace</span><span style=color:#f92672>?:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resource?</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>remediation</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Container and serverless security represents a significant evolution from traditional application security models, requiring new approaches that embrace the ephemeral and dynamic nature of cloud-native workloads. Success in this domain requires comprehensive security strategies that span the entire application lifecycle, from development and build processes through runtime monitoring and incident response. The key to effective container and serverless security lies in automation, integration with development workflows, and proactive threat detection that can operate effectively in highly dynamic environments.</p><p>As organizations continue to adopt containerized and serverless architectures, security teams must develop new skills and capabilities that complement traditional security expertise. This evolution includes understanding container orchestration security, implementing effective secrets management for ephemeral workloads, and designing monitoring systems that can provide visibility across distributed, short-lived applications. The investment in these capabilities pays dividends in improved security posture and the ability to realize the full benefits of cloud-native architectures without compromising on security requirements.</p><p>The future of container and serverless security will likely see increased integration with artificial intelligence and machine learning capabilities that can provide more sophisticated threat detection and automated response capabilities. Organizations that establish strong foundations in container and serverless security today will be well-positioned to take advantage of these advances while maintaining robust protection against evolving security threats in increasingly complex cloud environments.</p></div></article></main><aside class=blog-sidebar><div class=sidebar-widget><h3>Recent Posts</h3><ul class=recent-posts><li><a href=/posts/dynamodb-streams-opensearch-sync/>Real-time Data Synchronization: Using DynamoDB Streams and Lambda to Keep OpenSearch Indexes Current</a>
<span class=post-date>Jun 6, 2025</span></li><li><a href=/posts/using-ai-in-software-engineering/>Harnessing AI in Software Engineering: Opportunities and Challenges</a>
<span class=post-date>May 29, 2025</span></li><li><a href=/posts/aws-serverless-cost-optimization/>Cost Optimization Strategies for AWS Serverless Applications</a>
<span class=post-date>Jun 17, 2023</span></li><li><a href=/posts/aws-sns-sqs-typescript/>Building Event-Driven Architectures with AWS SNS/SQS and TypeScript</a>
<span class=post-date>May 21, 2023</span></li><li><a href=/posts/securing-aws-lambda/>Securing AWS Lambda Functions: Best Practices and Implementation Guide</a>
<span class=post-date>Apr 7, 2023</span></li></ul></div><div class=sidebar-widget><h3>Post Series</h3><ul class=recent-posts><li><a href=/posts/aws-sns-sqs-typescript/>AWS and Typescript: Building Event-Driven Architectures with AWS SNS/SQS and TypeScript</a>
<span class=post-date>May 21, 2023</span><div class=series-meta><a href=/series/aws-and-typescript/ class=series-link>View all 3 posts in series →</a></div></li><li><a href=/posts/real-time-processing-architectures/>Cloud Architecture Patterns: Real-time Processing Architectures</a>
<span class=post-date>Apr 11, 2021</span><div class=series-meta><a href=/series/cloud-architecture-patterns/ class=series-link>View all 7 posts in series →</a></div></li><li><a href=/posts/technical-debt-management-growing-codebases/>Modern Development Practices: Technical Debt Management in Growing Codebases: Strategies for Sustainable Development</a>
<span class=post-date>Dec 19, 2021</span><div class=series-meta><a href=/series/modern-development-practices/ class=series-link>View all 7 posts in series →</a></div></li><li><a href=/posts/threat-modeling-cloud-applications/>Security in Cloud-Native Applications: Threat Modeling for Cloud Applications: A Comprehensive Approach to Security Design</a>
<span class=post-date>Oct 19, 2019</span><div class=series-meta><a href=/series/security-in-cloud-native-applications/ class=series-link>View all 7 posts in series →</a></div></li></ul></div><div class=sidebar-widget><h3>Categories</h3><ul class=categories><li><a href=/categories/api-development>api development (1)</a></li><li><a href=/categories/architecture>architecture (2)</a></li><li><a href=/categories/architecture-and-design>architecture and design (8)</a></li><li><a href=/categories/artificial-intelligence>artificial intelligence (1)</a></li><li><a href=/categories/cloud-computing>cloud computing (16)</a></li><li><a href=/categories/code-quality>code quality (1)</a></li><li><a href=/categories/compliance>compliance (1)</a></li><li><a href=/categories/cost-optimization>cost optimization (1)</a></li><li><a href=/categories/data-engineering>data engineering (3)</a></li><li><a href=/categories/database>database (1)</a></li><li><a href=/categories/debugging-and-troubleshooting>debugging and troubleshooting (1)</a></li><li><a href=/categories/development-tools>development tools (2)</a></li><li><a href=/categories/development-tutorials>development tutorials (1)</a></li><li><a href=/categories/microservices>microservices (1)</a></li><li><a href=/categories/performance>performance (1)</a></li><li><a href=/categories/quality-assurance>quality assurance (1)</a></li><li><a href=/categories/security>security (8)</a></li><li><a href=/categories/serverless>serverless (2)</a></li><li><a href=/categories/software-development>software development (8)</a></li><li><a href=/categories/technical-debt>technical debt (1)</a></li><li><a href=/categories/testing>testing (2)</a></li><li><a href=/categories/version-control>version control (1)</a></li></ul></div><div class=sidebar-widget><h3>Tags</h3><div class=tag-cloud><a href=/tags/ai class=tag-cloud-item style=font-size:1rem>ai
</a><a href=/tags/api-design class=tag-cloud-item style=font-size:1rem>api design
</a><a href=/tags/api-security class=tag-cloud-item style=font-size:1rem>api security
</a><a href=/tags/architecture class=tag-cloud-item style=font-size:2rem>architecture
</a><a href=/tags/athena class=tag-cloud-item style=font-size:1rem>athena
</a><a href=/tags/authentication class=tag-cloud-item style=font-size:1rem>authentication
</a><a href=/tags/authorization class=tag-cloud-item style=font-size:1rem>authorization
</a><a href=/tags/automation class=tag-cloud-item style=font-size:1rem>automation
</a><a href=/tags/aws class=tag-cloud-item style=font-size:3rem>aws
</a><a href=/tags/aws-lambda class=tag-cloud-item style=font-size:1rem>aws lambda
</a><a href=/tags/best-practices class=tag-cloud-item style=font-size:1rem>best practices
</a><a href=/tags/chaos-engineering class=tag-cloud-item style=font-size:1rem>chaos engineering
</a><a href=/tags/ci/cd class=tag-cloud-item style=font-size:1rem>ci/cd
</a><a href=/tags/cloud-native class=tag-cloud-item style=font-size:1rem>cloud native
</a><a href=/tags/cloudnative class=tag-cloud-item style=font-size:1rem>cloudnative
</a><a href=/tags/code-quality class=tag-cloud-item style=font-size:1rem>code quality
</a><a href=/tags/communication-patterns class=tag-cloud-item style=font-size:1rem>communication patterns
</a><a href=/tags/compliance class=tag-cloud-item style=font-size:1rem>compliance
</a><a href=/tags/containers class=tag-cloud-item style=font-size:1rem>containers
</a><a href=/tags/cost-optimization class=tag-cloud-item style=font-size:1rem>cost optimization
</a><a href=/tags/cqrs class=tag-cloud-item style=font-size:1rem>cqrs
</a><a href=/tags/data-architecture class=tag-cloud-item style=font-size:1rem>data architecture
</a><a href=/tags/data-lake class=tag-cloud-item style=font-size:1rem>data lake
</a><a href=/tags/data-modeling class=tag-cloud-item style=font-size:1rem>data modeling
</a><a href=/tags/database-design class=tag-cloud-item style=font-size:1rem>database design
</a><a href=/tags/debugging class=tag-cloud-item style=font-size:1rem>debugging
</a><a href=/tags/developer-tips class=tag-cloud-item style=font-size:1rem>developer tips
</a><a href=/tags/development class=tag-cloud-item style=font-size:2rem>development
</a><a href=/tags/devops class=tag-cloud-item style=font-size:1rem>devops
</a><a href=/tags/devsecops class=tag-cloud-item style=font-size:1rem>devsecops
</a><a href=/tags/distributed-systems class=tag-cloud-item style=font-size:1rem>distributed systems
</a><a href=/tags/docker class=tag-cloud-item style=font-size:1rem>docker
</a><a href=/tags/dynamodb class=tag-cloud-item style=font-size:1rem>dynamodb
</a><a href=/tags/encryption class=tag-cloud-item style=font-size:1rem>encryption
</a><a href=/tags/enterprise-architecture class=tag-cloud-item style=font-size:1rem>enterprise architecture
</a><a href=/tags/event-sourcing class=tag-cloud-item style=font-size:1rem>event sourcing
</a><a href=/tags/event-driven-architecture class=tag-cloud-item style=font-size:1rem>event-driven architecture
</a><a href=/tags/eventbridge class=tag-cloud-item style=font-size:1rem>eventbridge
</a><a href=/tags/fault-tolerance class=tag-cloud-item style=font-size:1rem>fault tolerance
</a><a href=/tags/gdpr class=tag-cloud-item style=font-size:1rem>gdpr
</a><a href=/tags/glue class=tag-cloud-item style=font-size:1rem>glue
</a><a href=/tags/governance class=tag-cloud-item style=font-size:1rem>governance
</a><a href=/tags/graphql class=tag-cloud-item style=font-size:1rem>graphql
</a><a href=/tags/hipaa class=tag-cloud-item style=font-size:1rem>hipaa
</a><a href=/tags/iam class=tag-cloud-item style=font-size:1rem>iam
</a><a href=/tags/identity-management class=tag-cloud-item style=font-size:1rem>identity management
</a><a href=/tags/jwt class=tag-cloud-item style=font-size:1rem>jwt
</a><a href=/tags/kinesis class=tag-cloud-item style=font-size:1rem>kinesis
</a><a href=/tags/kubernetes class=tag-cloud-item style=font-size:1rem>kubernetes
</a><a href=/tags/lambda class=tag-cloud-item style=font-size:1rem>lambda
</a><a href=/tags/load-testing class=tag-cloud-item style=font-size:1rem>load testing
</a><a href=/tags/metrics class=tag-cloud-item style=font-size:1rem>metrics
</a><a href=/tags/microservices class=tag-cloud-item style=font-size:1rem>microservices
</a><a href=/tags/monitoring class=tag-cloud-item style=font-size:1rem>monitoring
</a><a href=/tags/multi-account class=tag-cloud-item style=font-size:1rem>multi-account
</a><a href=/tags/nosql class=tag-cloud-item style=font-size:1rem>nosql
</a><a href=/tags/oauth class=tag-cloud-item style=font-size:1rem>oauth
</a><a href=/tags/octave class=tag-cloud-item style=font-size:1rem>octave
</a><a href=/tags/opensearch class=tag-cloud-item style=font-size:1rem>opensearch
</a><a href=/tags/pasta class=tag-cloud-item style=font-size:1rem>pasta
</a><a href=/tags/patterns class=tag-cloud-item style=font-size:1rem>patterns
</a><a href=/tags/pci-dss class=tag-cloud-item style=font-size:1rem>pci-dss
</a><a href=/tags/performance-testing class=tag-cloud-item style=font-size:1rem>performance testing
</a><a href=/tags/productivity class=tag-cloud-item style=font-size:1rem>productivity
</a><a href=/tags/rate-limiting class=tag-cloud-item style=font-size:1rem>rate limiting
</a><a href=/tags/real-time class=tag-cloud-item style=font-size:1rem>real-time
</a><a href=/tags/refactoring class=tag-cloud-item style=font-size:1rem>refactoring
</a><a href=/tags/reliability class=tag-cloud-item style=font-size:1rem>reliability
</a><a href=/tags/resilience class=tag-cloud-item style=font-size:1rem>resilience
</a><a href=/tags/rest class=tag-cloud-item style=font-size:1rem>rest
</a><a href=/tags/riskassessment class=tag-cloud-item style=font-size:1rem>riskassessment
</a><a href=/tags/s3 class=tag-cloud-item style=font-size:1rem>s3
</a><a href=/tags/search class=tag-cloud-item style=font-size:1rem>search
</a><a href=/tags/secrets-management class=tag-cloud-item style=font-size:1rem>secrets management
</a><a href=/tags/security class=tag-cloud-item style=font-size:2rem>security
</a><a href=/tags/securitydesign class=tag-cloud-item style=font-size:1rem>securitydesign
</a><a href=/tags/serverless class=tag-cloud-item style=font-size:2rem>serverless
</a><a href=/tags/soc2 class=tag-cloud-item style=font-size:1rem>soc2
</a><a href=/tags/software-engineering class=tag-cloud-item style=font-size:1rem>software engineering
</a><a href=/tags/standards class=tag-cloud-item style=font-size:1rem>standards
</a><a href=/tags/stream-processing class=tag-cloud-item style=font-size:1rem>stream processing
</a><a href=/tags/streams class=tag-cloud-item style=font-size:1rem>streams
</a><a href=/tags/stride class=tag-cloud-item style=font-size:1rem>stride
</a><a href=/tags/tdd class=tag-cloud-item style=font-size:1rem>tdd
</a><a href=/tags/technical-debt class=tag-cloud-item style=font-size:1rem>technical debt
</a><a href=/tags/testing class=tag-cloud-item style=font-size:1rem>testing
</a><a href=/tags/threatmodeling class=tag-cloud-item style=font-size:1rem>threatmodeling
</a><a href=/tags/typescript class=tag-cloud-item style=font-size:2rem>typescript
</a><a href=/tags/zero-trust class=tag-cloud-item style=font-size:1rem>zero trust</a></div></div><div class=sidebar-widget><h3>Subscribe</h3><div class=subscribe-links><a href=/index.xml class=rss-link><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg>
RSS Feed</a></div></div><div class="sidebar-widget npm-packages"><h3>My NPM Packages</h3><div id=npm-list></div></div></aside></div></div><footer class=site-footer><div class=container><p>&copy; 2025 Scott Obert</p></div></footer></body></html>